{
  "id": "relationship.v1",
  "name": "发现联系差异",
  "category": "relationship",
  "version": 1,
  "description": "分析资源之间的关联与差异，识别协同与冲突点",
  "schema": {
    "type": "object",
    "properties": {
      "relationshipMap": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "sourceResourceId": { "type": "string" },
            "targetResourceId": { "type": "string" },
            "relationship": { "type": "string" },
            "evidence": { "type": "string" }
          },
          "required": ["sourceResourceId", "targetResourceId", "relationship"]
        }
      },
      "conflicts": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "description": { "type": "string" },
            "resourceIds": {
              "type": "array",
              "items": { "type": "string" }
            },
            "resolutionIdeas": { "type": "string" }
          },
          "required": ["description", "resourceIds"]
        }
      },
      "nextOpportunities": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "opportunity": { "type": "string" },
            "reason": { "type": "string" }
          },
          "required": ["opportunity"]
        }
      }
    },
    "required": ["relationshipMap"]
  },
  "promptConfig": {
    "extract": "为每个资源提取与其他资源可能有关联的要点。",
    "analysis": "识别资源之间的依赖、互补、冲突关系，并提出后续探索方向。",
    "generate": "严格返回符合 schema 的 JSON。",
    "validationHints": [
      "relationshipMap 至少包含两个关系",
      "conflicts、nextOpportunities 为空时返回空数组"
    ],
    "failureRecovery": [
      {
        "type": "json_error",
        "prompt": "输出不是有效 JSON，请重新生成符合 schema 的结构。"
      }
    ]
  }
}
