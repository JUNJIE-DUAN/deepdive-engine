# AI Office 2.0 äº§å“éœ€æ±‚æ–‡æ¡£ (PRD)

**æ–‡æ¡£ç‰ˆæœ¬**: 2.0
**åˆ›å»ºæ—¥æœŸ**: 2025-11-17
**äº§å“è´Ÿè´£äºº**: DeepDive Team
**ç›®æ ‡å‘å¸ƒ**: Q1 2026

---

## ç›®å½•

1. [äº§å“æ¦‚è¿°](#1-äº§å“æ¦‚è¿°)
2. [äº§å“å®šä½ä¸ä»·å€¼ä¸»å¼ ](#2-äº§å“å®šä½ä¸ä»·å€¼ä¸»å¼ )
3. [æ ¸å¿ƒåŠŸèƒ½è§„æ ¼](#3-æ ¸å¿ƒåŠŸèƒ½è§„æ ¼)
4. [æŠ€æœ¯æ¶æ„è®¾è®¡](#4-æŠ€æœ¯æ¶æ„è®¾è®¡)
5. [ç”¨æˆ·ä½“éªŒæµç¨‹](#5-ç”¨æˆ·ä½“éªŒæµç¨‹)
6. [æ•°æ®æ¨¡å‹è®¾è®¡](#6-æ•°æ®æ¨¡å‹è®¾è®¡)
7. [UI/UXè®¾è®¡è§„èŒƒ](#7-uiuxè®¾è®¡è§„èŒƒ)
8. [å®æ–½è·¯çº¿å›¾](#8-å®æ–½è·¯çº¿å›¾)
9. [æˆåŠŸæŒ‡æ ‡](#9-æˆåŠŸæŒ‡æ ‡)

---

## 1. äº§å“æ¦‚è¿°

### 1.1 äº§å“å®šä¹‰

**AI Office** æ˜¯ä¸€ä¸ªä¸“ä¸ºç§‘ç ”äººå‘˜å’ŒæŠ€æœ¯ä¸“å®¶è®¾è®¡çš„æ™ºèƒ½ç ”ç©¶åŠ©æ‰‹å¹³å°ï¼Œé€šè¿‡ Multi-Agent AI ç³»ç»Ÿæ”¯æŒåŸºäºæ·±åº¦èµ„æºçš„**æŒç»­è¿­ä»£å¼æŠ¥å‘Šç”Ÿæˆ**ï¼Œæä¾›å®Œæ•´çš„ç‰ˆæœ¬ç®¡ç†ã€æ¨¡æ¿ç³»ç»Ÿå’Œå¤šæ ¼å¼å¯¼å‡ºèƒ½åŠ›ã€‚

### 1.2 æ ¸å¿ƒé—®é¢˜

ç§‘ç ”å’ŒæŠ€æœ¯äººå‘˜åœ¨æ’°å†™è®ºæ–‡ã€æŠ€æœ¯æŠ¥å‘Šã€æ¼”è®²PPTæ—¶é¢ä¸´çš„ç—›ç‚¹ï¼š

1. **ä¿¡æ¯è¿‡è½½**ï¼šéœ€è¦é˜…è¯»å¤§é‡è®ºæ–‡ã€é¡¹ç›®æ–‡æ¡£ï¼Œéš¾ä»¥å¿«é€Ÿæç‚¼æ ¸å¿ƒè§‚ç‚¹
2. **æ’°å†™è€—æ—¶**ï¼šä»æ–‡çŒ®ç»¼è¿°åˆ°æœ€ç»ˆæŠ¥å‘Šï¼Œéœ€è¦æ•°å¤©ç”šè‡³æ•°å‘¨
3. **è¿­ä»£å›°éš¾**ï¼šæŠ¥å‘Šéœ€è¦å¤šæ¬¡ä¿®æ”¹ï¼Œç‰ˆæœ¬ç®¡ç†æ··ä¹±
4. **æ ¼å¼è½¬æ¢éº»çƒ¦**ï¼šéœ€è¦åœ¨PPTã€Wordã€PDFä¹‹é—´é¢‘ç¹è½¬æ¢
5. **ç¼ºå°‘ä¸“ä¸šæ¨¡æ¿**ï¼šå­¦æœ¯/æŠ€æœ¯æŠ¥å‘Šéœ€è¦ç‰¹å®šæ ¼å¼å’Œé£æ ¼

### 1.3 è§£å†³æ–¹æ¡ˆ

AI Office é€šè¿‡ä»¥ä¸‹æ–¹å¼è§£å†³ä¸Šè¿°é—®é¢˜ï¼š

```
èµ„æºé‡‡é›†ï¼ˆExploreé¡µé¢ï¼‰ â†’ æ·»åŠ åˆ°AI Office
    â†“
èµ„æºé€‰æ‹©ï¼ˆResourceListï¼‰
    â†“
AIäº¤äº’ï¼ˆChatPanel + Multi-Agent: Grok/ChatGPTï¼‰
    â†“
æ–‡æ¡£ç”Ÿæˆï¼ˆPPT/Docï¼Œæ”¯æŒæ™ºèƒ½å¯è§†åŒ–ï¼‰
    â†“
æŒç»­è¿­ä»£ç¼–è¾‘ï¼ˆç‰ˆæœ¬ç®¡ç† + å±€éƒ¨æ›´æ–° + é€‰ä¸­ç¼–è¾‘ï¼‰
    â†“
å¤šæ ¼å¼å¯¼å‡ºï¼ˆPPTX, DOCX, PDF, Markdownï¼‰
```

**åŸºäºç°æœ‰å®ç°ï¼š**

- âœ… å·²æœ‰å®Œæ•´çš„ä¸‰æ å¸ƒå±€ï¼ˆå·¦ä¾§èœå• + ä¸­é—´äº¤äº’ + å³ä¾§æ–‡æ¡£ï¼‰
- âœ… å·²æœ‰èµ„æºç®¡ç†ç³»ç»Ÿï¼ˆResourceList + aiOfficeStoreï¼‰
- âœ… å·²æœ‰AIäº¤äº’ç³»ç»Ÿï¼ˆChatPanel + æµå¼å¤„ç†ï¼‰
- âœ… å·²æœ‰æ–‡æ¡£ç¼–è¾‘å™¨ï¼ˆDocumentEditor + 5ç§PPTæ¨¡æ¿ï¼‰
- âœ… å·²æœ‰ç‰ˆæœ¬ç®¡ç†ï¼ˆè‡ªåŠ¨å¿«ç…§ + æ‰‹åŠ¨ä¿å­˜ + ç‰ˆæœ¬æ¢å¤ï¼‰
- âœ… å·²æœ‰ä»»åŠ¡ç³»ç»Ÿï¼ˆå®Œæ•´ä¸Šä¸‹æ–‡ä¿å­˜ä¸æ¢å¤ï¼‰

---

## 2. äº§å“å®šä½ä¸ä»·å€¼ä¸»å¼ 

### 2.1 ç›®æ ‡ç”¨æˆ·

**ä¸»è¦ç”¨æˆ·ç¾¤ä½“ï¼ˆç§‘ç ”/æŠ€æœ¯é¢†åŸŸï¼‰ï¼š**

1. **ç ”ç©¶ç”Ÿ/åšå£«ç”Ÿ**
   - éœ€æ±‚ï¼šæ–‡çŒ®ç»¼è¿°ã€å­¦æœ¯æ¼”è®²ã€è®ºæ–‡æ’°å†™
   - ç—›ç‚¹ï¼šé˜…è¯»é‡å¤§ã€å†™ä½œæ—¶é—´ç´§ã€æ ¼å¼è¦æ±‚ä¸¥
   - ä»·å€¼ï¼šå¿«é€Ÿç”Ÿæˆæ–‡çŒ®ç»¼è¿°ï¼Œè‡ªåŠ¨å¼•ç”¨ç®¡ç†

2. **æŠ€æœ¯Leader/æ¶æ„å¸ˆ**
   - éœ€æ±‚ï¼šæŠ€æœ¯åˆ†äº«ã€æ¶æ„è®¾è®¡æ–‡æ¡£ã€æŠ€æœ¯è¯„å®¡PPT
   - ç—›ç‚¹ï¼šéœ€è¦åˆ†æå¤šä¸ªå¼€æºé¡¹ç›®ã€æ•´ç†æŠ€æœ¯æ–¹æ¡ˆ
   - ä»·å€¼ï¼šå¿«é€Ÿåˆ†æGitHubé¡¹ç›®ï¼Œç”ŸæˆæŠ€æœ¯å¯¹æ¯”æŠ¥å‘Š

3. **ç§‘ç ”äººå‘˜**
   - éœ€æ±‚ï¼šç ”ç©¶æŠ¥å‘Šã€å­¦æœ¯ä¼šè®®æ¼”è®²ã€åŸºé‡‘ç”³è¯·
   - ç—›ç‚¹ï¼šéœ€è¦è·Ÿè¸ªæœ€æ–°ç ”ç©¶ã€æ•´ç†å®éªŒæ•°æ®
   - ä»·å€¼ï¼šè‡ªåŠ¨è¿½è¸ªarXivè®ºæ–‡ï¼Œç”Ÿæˆç ”ç©¶è¿›å±•æŠ¥å‘Š

### 2.2 å·®å¼‚åŒ–å®šä½

| ç»´åº¦         | Notion AI    | Gamma.app | Perplexity | **AI Office 2.0**               |
| ------------ | ------------ | --------- | ---------- | ------------------------------- |
| **ç›®æ ‡ç”¨æˆ·** | æ³›çŸ¥è¯†å·¥ä½œè€… | å•†åŠ¡/è¥é”€ | æ³›æœç´¢ç”¨æˆ· | **ç§‘ç ”/æŠ€æœ¯ä¸“å®¶**               |
| **èµ„æºé›†æˆ** | Web Clipper  | æ—         | Webæœç´¢    | **arXiv/GitHubæ·±åº¦é›†æˆ**        |
| **AIèƒ½åŠ›**   | å•æ¨¡å‹       | å•æ¨¡å‹    | å•æ¨¡å‹     | **Multi-Agentï¼ˆGrok+ChatGPTï¼‰** |
| **æŒç»­è¿­ä»£** | åŸºç¡€ç¼–è¾‘     | æœ‰é™      | æ—          | **âœ… ç‰ˆæœ¬ç®¡ç†+é€‰ä¸­ç¼–è¾‘**        |
| **æ–‡æ¡£ç±»å‹** | Notion Page  | PPT       | æ–‡æœ¬       | **âœ… PPT+Doc+å¤šæ ¼å¼å¯¼å‡º**       |
| **æ¨¡æ¿ç³»ç»Ÿ** | æ—            | å†…ç½®æ¨¡æ¿  | æ—          | **âœ… ç§‘ç ”/æŠ€æœ¯ä¸“ä¸šæ¨¡æ¿**        |
| **éªŒè¯æœºåˆ¶** | æ—            | æ—         | åŸºç¡€       | **âœ… Multi-Agentäº¤å‰éªŒè¯**      |

### 2.3 æ ¸å¿ƒä»·å€¼ä¸»å¼ 

> **"ä»æ–‡çŒ®åˆ°æ¼”è®²ï¼Œä¸€ç«™å¼å®Œæˆ - è®©ç§‘ç ”å’ŒæŠ€æœ¯æŠ¥å‘Šçš„åˆ›ä½œæ•ˆç‡æå‡10å€"**

**ä¸‰å¤§æ ¸å¿ƒä»·å€¼ï¼š**

1. **æ™ºèƒ½ç†è§£**ï¼šMulti-Agentæ·±åº¦åˆ†æå­¦æœ¯è®ºæ–‡å’ŒæŠ€æœ¯é¡¹ç›®ï¼Œæå–æ ¸å¿ƒè§‚ç‚¹
2. **æŒç»­è¿­ä»£**ï¼šç‰ˆæœ¬ç®¡ç†+é€‰ä¸­ç¼–è¾‘ï¼Œæ”¯æŒæŠ¥å‘Šçš„é•¿æœŸæ¼”åŒ–
3. **ä¸“ä¸šè¾“å‡º**ï¼šç§‘ç ”/æŠ€æœ¯æ¨¡æ¿ï¼Œç¬¦åˆå­¦æœ¯å’Œå·¥ç¨‹è§„èŒƒçš„æ–‡æ¡£

---

## 3. æ ¸å¿ƒåŠŸèƒ½è§„æ ¼

### 3.1 åŠŸèƒ½æ¨¡å—æ¦‚è§ˆ

```
AI Office 2.0ï¼ˆåŸºäºç°æœ‰å®ç°å¢å¼ºï¼‰
â”œâ”€â”€ èµ„æºç®¡ç†æ¨¡å— âœ… å·²å®ç°
â”‚   â”œâ”€â”€ èµ„æºæ·»åŠ ï¼ˆä»Exploreé¡µé¢ï¼‰
â”‚   â”œâ”€â”€ èµ„æºåˆ—è¡¨ï¼ˆResourceListç»„ä»¶ï¼‰
â”‚   â”œâ”€â”€ èµ„æºé€‰æ‹©/å…¨é€‰/æ‰¹é‡åˆ é™¤
â”‚   â”œâ”€â”€ èµ„æºå»é‡ï¼ˆåŸºäº_idï¼‰
â”‚   â”œâ”€â”€ ğŸ†• ç›¸å…³èµ„æºæ¨èï¼ˆåŸºäºAIåˆ†æï¼‰
â”‚   â””â”€â”€ ğŸ†• èµ„æºåˆ†ç±»ä¸æ ‡ç­¾
â”‚
â”œâ”€â”€ AIäº¤äº’æ¨¡å— âœ… å·²å®ç° + å¢å¼º
â”‚   â”œâ”€â”€ ChatPanelï¼ˆ1615è¡Œæ ¸å¿ƒé€»è¾‘ï¼‰
â”‚   â”œâ”€â”€ @èµ„æºå¼•ç”¨ç³»ç»Ÿ
â”‚   â”œâ”€â”€ æ„å›¾è¯†åˆ«ï¼ˆPPT/Word/æ›´æ–°ï¼‰
â”‚   â”œâ”€â”€ æµå¼å¤„ç†ï¼ˆSSEï¼‰
â”‚   â”œâ”€â”€ ğŸ†• Multi-Agentç¼–æ’
â”‚   â”‚   â”œâ”€â”€ CoordinatorAgentï¼ˆGrokï¼‰- ä»»åŠ¡è§„åˆ’
â”‚   â”‚   â”œâ”€â”€ ResourceAnalysisAgentï¼ˆGrokï¼‰- æ·±åº¦åˆ†æ
â”‚   â”‚   â”œâ”€â”€ ContentWritingAgentï¼ˆChatGPTï¼‰- å†…å®¹ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ VisualizationAgentï¼ˆChatGPTï¼‰- å›¾è¡¨è®¾è®¡
â”‚   â”‚   â””â”€â”€ VerificationAgentï¼ˆGrokï¼‰- äº‹å®éªŒè¯
â”‚   â””â”€â”€ ğŸ†• AIè¿‡ç¨‹é€æ˜åŒ–ï¼ˆæ˜¾ç¤ºAgentå·¥ä½œçŠ¶æ€ï¼‰
â”‚
â”œâ”€â”€ æ–‡æ¡£ç¼–è¾‘æ¨¡å— âœ… å·²å®ç° + å¢å¼º
â”‚   â”œâ”€â”€ DocumentEditorï¼ˆè‡ªåŠ¨ä¿å­˜ã€å®æ—¶é¢„è§ˆï¼‰
â”‚   â”œâ”€â”€ PPTåŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ 5ç§æ¨¡æ¿ï¼ˆCorporate/Minimal/Modern/Creative/Academicï¼‰
â”‚   â”‚   â”œâ”€â”€ 6ç§æ™ºèƒ½å¯è§†åŒ–ï¼ˆFLOW/CHART/MATRIXï¼‰
â”‚   â”‚   â”œâ”€â”€ å¹»ç¯ç‰‡å¯¼èˆªä¸ç¼©ç•¥å›¾
â”‚   â”‚   â”œâ”€â”€ å±€éƒ¨æ›´æ–°ï¼ˆæŒ‡å®šé¡µé¢ï¼‰
â”‚   â”‚   â””â”€â”€ ğŸ†• Slideçº§åˆ«é€‰ä¸­ç¼–è¾‘
â”‚   â”œâ”€â”€ DocåŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ Markdownç¼–è¾‘
â”‚   â”‚   â””â”€â”€ ğŸ†• ç« èŠ‚ç®¡ç†ï¼ˆç›®å½•/æŠ˜å ï¼‰
â”‚   â””â”€â”€ ğŸ†• Research Pageæ ¼å¼ï¼ˆç»“æ„åŒ–çŸ¥è¯†é¡µé¢ï¼‰
â”‚
â”œâ”€â”€ ç‰ˆæœ¬ç®¡ç†æ¨¡å— âœ… å·²å®ç° + å¢å¼º
â”‚   â”œâ”€â”€ è‡ªåŠ¨ç‰ˆæœ¬å¿«ç…§ï¼ˆai_generation/user_editï¼‰
â”‚   â”œâ”€â”€ ç‰ˆæœ¬å†å²æŸ¥çœ‹
â”‚   â”œâ”€â”€ ç‰ˆæœ¬æ¢å¤
â”‚   â”œâ”€â”€ ğŸ†• ç‰ˆæœ¬å¯¹æ¯”ï¼ˆDiffï¼‰
â”‚   â””â”€â”€ ğŸ†• ç‰ˆæœ¬åˆ†æ”¯/æ ‡ç­¾
â”‚
â”œâ”€â”€ ä»»åŠ¡ç®¡ç†æ¨¡å— âœ… å·²å®ç°
â”‚   â”œâ”€â”€ ä»»åŠ¡è‡ªåŠ¨åˆ›å»º
â”‚   â”œâ”€â”€ å®Œæ•´ä¸Šä¸‹æ–‡ä¿å­˜ï¼ˆèµ„æº+æ–‡æ¡£+å¯¹è¯ï¼‰
â”‚   â”œâ”€â”€ ä»»åŠ¡æ¢å¤ï¼ˆå®Œæ•´çŠ¶æ€æ¢å¤ï¼‰
â”‚   â””â”€â”€ ä»»åŠ¡åˆ—è¡¨ä¾§è¾¹æ 
â”‚
â”œâ”€â”€ æ¨¡æ¿ç³»ç»Ÿ âœ… éƒ¨åˆ†å®ç° + æ‰©å±•
â”‚   â”œâ”€â”€ å·²æœ‰ï¼š5ç§PPTæ¨¡æ¿
â”‚   â”œâ”€â”€ ğŸ†• ç§‘ç ”æ¨¡æ¿åº“ï¼ˆå­¦æœ¯ä¼šè®®/è®ºæ–‡/æ–‡çŒ®ç»¼è¿°ï¼‰
â”‚   â”œâ”€â”€ ğŸ†• æŠ€æœ¯æ¨¡æ¿åº“ï¼ˆè®¾è®¡æ–‡æ¡£/æŠ€æœ¯åˆ†äº«/ä»£ç å®¡æŸ¥ï¼‰
â”‚   â”œâ”€â”€ ğŸ†• è‡ªå®šä¹‰æ¨¡æ¿ç¼–è¾‘å™¨
â”‚   â””â”€â”€ ğŸ†• æ¨¡æ¿å¸‚åœºï¼ˆåˆ†äº«/ä¸‹è½½ï¼‰
â”‚
â””â”€â”€ å¯¼å‡ºæ¨¡å— âœ… å·²å®ç°
    â”œâ”€â”€ PPTXå¯¼å‡º
    â”œâ”€â”€ DOCXå¯¼å‡º
    â”œâ”€â”€ PDFå¯¼å‡º
    â”œâ”€â”€ Markdownå¯¼å‡º
    â””â”€â”€ ğŸ†• HTMLå¯¼å‡ºï¼ˆå“åº”å¼ï¼‰
    â””â”€â”€ ğŸ†• LaTeXå¯¼å‡ºï¼ˆå­¦æœ¯æœŸåˆŠï¼‰
```

**å›¾ä¾‹ï¼š**

- âœ… å·²å®ç° - å½“å‰ç³»ç»Ÿå·²æœ‰å®Œæ•´å®ç°
- ğŸ†• å¢å¼º - åŸºäºç°æœ‰å®ç°çš„å¢å¼ºåŠŸèƒ½

---

### 3.2 åŠŸèƒ½è¯¦ç»†è§„æ ¼

#### 3.2.1 èµ„æºç®¡ç†ç³»ç»Ÿï¼ˆåŸºäºç°æœ‰å®ç°ï¼‰

**ç°æœ‰å®ç°æ¦‚è¿°ï¼š**

å½“å‰AI Officeå·²æœ‰å®Œæ•´çš„èµ„æºç®¡ç†ç³»ç»Ÿï¼Œä½äºï¼š

- çŠ¶æ€ç®¡ç†ï¼š`frontend/stores/aiOfficeStore.ts` â†’ `useResourceStore`
- UIç»„ä»¶ï¼š`frontend/components/ai-office/resources/ResourceList.tsx`
- ç±»å‹å®šä¹‰ï¼š`frontend/types/ai-office.ts`

**æ ¸å¿ƒæµç¨‹ï¼š**

```
1. ç”¨æˆ·åœ¨Exploreé¡µé¢æµè§ˆèµ„æº
   â†“
2. ç‚¹å‡»èµ„æºå¡ç‰‡ä¸Šçš„"AI Office"æŒ‰é’®
   â†“
3. è°ƒç”¨ useResourceStore.addResource(resource)
   â†“
4. å»é‡æ£€æŸ¥ï¼ˆåŸºäº_idï¼‰
   - å¦‚æœå·²å­˜åœ¨ï¼šconsole.warnï¼Œä¸æ·»åŠ 
   - å¦‚æœä¸å­˜åœ¨ï¼šæ·»åŠ åˆ°resourcesæ•°ç»„
   â†“
5. èµ„æºå‡ºç°åœ¨AI Officeçš„ResourceListä¸­
   â†“
6. ç”¨æˆ·å¯ä»¥ï¼š
   - é€‰æ‹©/å–æ¶ˆé€‰æ‹©èµ„æºï¼ˆselectResource/deselectResourceï¼‰
   - å…¨é€‰/å–æ¶ˆå…¨é€‰ï¼ˆtoggleSelectAllï¼‰
   - æ‰¹é‡åˆ é™¤é€‰ä¸­èµ„æºï¼ˆdeleteSelectedResourcesï¼‰
   - å•ä¸ªåˆ é™¤èµ„æºï¼ˆremoveResourceï¼‰
```

**ç°æœ‰æ•°æ®æ¨¡å‹ï¼š**

```typescript
// frontend/types/ai-office.ts
export type ResourceType =
  | "youtube_video"
  | "academic_paper"
  | "web_page"
  | "database"
  | "file";

export type ResourceStatus = "pending" | "collecting" | "collected" | "failed";

export interface Resource {
  _id: string;
  userId: string;
  resourceId: string;
  resourceType: ResourceType;
  status: ResourceStatus;

  metadata: {
    title: string;
    description?: string;
    authors?: Array<{ name: string; affiliation?: string }>;
    channel?: string; // YouTubeé¢‘é“
    url?: string;
    publishedAt?: string;
    duration?: number; // è§†é¢‘æ—¶é•¿
  };

  content?: {
    transcript?: string; // YouTubeå­—å¹•
    summary?: string;
    fullText?: string;
  };

  aiAnalysis?: {
    summary: string;
    keyPoints: string[];
    tags?: string[];
    sentiment?: string;
  };

  collectedAt: Date;
  updatedAt: Date;
}
```

**ç°æœ‰Storeå®ç°ï¼š**

```typescript
// frontend/stores/aiOfficeStore.ts
interface ResourceState {
  resources: Resource[];
  selectedResourceIds: string[];
  isLoading: boolean;
  error: string | null;

  // æ ¸å¿ƒActions
  addResource: (resource: Resource) => void;
  removeResource: (id: string) => void;
  updateResource: (id: string, updates: Partial<Resource>) => void;

  // é€‰æ‹©ç®¡ç†
  selectResource: (id: string) => void;
  deselectResource: (id: string) => void;
  clearSelection: () => void;

  // æ‰¹é‡æ“ä½œ
  deleteSelectedResources: () => void;

  // çŠ¶æ€é‡ç½®
  resetResources: () => void;
}

// æŒä¹…åŒ–é…ç½®
persist: {
  name: 'ai-office-resource-storage',
  partialize: (state) => ({
    resources: state.resources,
    selectedResourceIds: state.selectedResourceIds,
  }),
}
```

**ğŸ†• 2.0å¢å¼ºåŠŸèƒ½ï¼š**

1. **ç›¸å…³èµ„æºæ¨èï¼ˆæ–°å¢ï¼‰**

   ```typescript
   interface ResourceRecommendation {
     resourceId: string;
     relevanceScore: number; // 0-1
     reason: string; // AIç”Ÿæˆçš„æ¨èç†ç”±
     basedOn: "content-similarity" | "user-history" | "ai-analysis";
   }

   // åœ¨ChatPanelä¸­é›†æˆ
   useEffect(() => {
     if (currentDocument && currentDocument.content) {
       // AIåˆ†ææ–‡æ¡£å†…å®¹ï¼Œæ¨èç›¸å…³èµ„æº
       const recommendations = await recommendRelatedResources({
         documentContent: currentDocument.content.markdown,
         existingResources: resources,
       });

       setRecommendations(recommendations);
     }
   }, [currentDocument]);
   ```

2. **èµ„æºåˆ†ç±»ä¸æ ‡ç­¾ï¼ˆæ–°å¢ï¼‰**

   ```typescript
   interface Resource {
     // æ‰©å±•ç°æœ‰Resource
     categories?: string[]; // ['æœºå™¨å­¦ä¹ ', 'è‡ªç„¶è¯­è¨€å¤„ç†']
     userTags?: string[]; // ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ çš„æ ‡ç­¾
     autoTags?: string[]; // AIè‡ªåŠ¨ç”Ÿæˆçš„æ ‡ç­¾
   }

   // ResourceListå¢å¼ºï¼šæ ‡ç­¾è¿‡æ»¤
   const filteredResources = resources.filter(
     (r) =>
       selectedCategories.length === 0 ||
       r.categories?.some((c) => selectedCategories.includes(c)),
   );
   ```

**ç°æœ‰UIç»„ä»¶ï¼š**

```typescript
// frontend/components/ai-office/resources/ResourceList.tsx (197è¡Œ)

<div className="resource-list">
  {/* å·¥å…·æ  */}
  <div className="toolbar">
    <Checkbox checked={allSelected} onChange={toggleSelectAll}>
      å…¨é€‰ ({selectedIds.length}/{resources.length})
    </Checkbox>
    <Button onClick={deleteSelected} disabled={selectedIds.length === 0}>
      åˆ é™¤é€‰ä¸­
    </Button>
  </div>

  {/* èµ„æºå¡ç‰‡åˆ—è¡¨ */}
  {resources.map(resource => (
    <ResourceCard key={resource._id}>
      <Checkbox
        checked={selectedIds.includes(resource._id)}
        onChange={() => toggleSelect(resource._id)}
      />

      <Icon type={resource.resourceType} />

      <div className="content">
        <h3>{resource.metadata.title}</h3>
        {resource.metadata.authors && (
          <Authors>{resource.metadata.authors.map(a => a.name).join(', ')}</Authors>
        )}
        <StatusBadge status={resource.status} />
      </div>

      <Button onClick={() => removeResource(resource._id)}>
        ç§»é™¤
      </Button>
    </ResourceCard>
  ))}
</div>
```

**ä¿ç•™ç°æœ‰å®ç°çš„åŸå› ï¼š**

1. âœ… å·²æœ‰å®Œæ•´çš„èµ„æºæ·»åŠ æµç¨‹ï¼ˆä»Exploreé¡µé¢ï¼‰
2. âœ… å·²æœ‰å¥å…¨çš„å»é‡æœºåˆ¶ï¼ˆåŸºäº\_idï¼‰
3. âœ… å·²æœ‰å®Œå–„çš„é€‰æ‹©ç®¡ç†ï¼ˆå•é€‰/å…¨é€‰/æ‰¹é‡åˆ é™¤ï¼‰
4. âœ… å·²æœ‰æŒä¹…åŒ–å­˜å‚¨ï¼ˆLocalStorageï¼‰
5. âœ… UIç»„ä»¶å·²ç»è¿‡ä¼˜åŒ–ï¼Œç”¨æˆ·ä½“éªŒè‰¯å¥½

**2.0å¢å¼ºç­–ç•¥ï¼š**

- åœ¨ç°æœ‰åŸºç¡€ä¸Šæ·»åŠ AIæ¨èåŠŸèƒ½ï¼ˆä¸ç ´åç°æœ‰æµç¨‹ï¼‰
- å¢åŠ èµ„æºåˆ†ç±»/æ ‡ç­¾ç³»ç»Ÿï¼ˆæ‰©å±•ç°æœ‰æ•°æ®æ¨¡å‹ï¼‰
- ä¼˜åŒ–ResourceList UIï¼ˆæ”¯æŒè¿‡æ»¤å’Œæœç´¢ï¼‰
  interface ResourceRecommendation {
  id: string;
  type: 'arxiv' | 'github' | 'youtube' | 'doi' | 'web';
  url: string;

  metadata: {
  title: string;
  authors?: string[];
  publishedAt?: Date;
  abstract?: string;
  thumbnail?: string;
  };

  recommendation: {
  score: number; // 0-1ç›¸å…³åº¦åˆ†æ•°
  reason: string; // æ¨èç†ç”±
  basedOn: 'url-detection' | 'content-similarity' | 'user-history';
  };

  status: 'pending' | 'accepted' | 'rejected';

  createdAt: Date;
  }

````

---

#### 3.2.2 Multi-Agent AIç³»ç»Ÿï¼ˆåŸºäºç°æœ‰ChatPanelå¢å¼ºï¼‰

**ç°æœ‰å®ç°åŸºç¡€ï¼š**

å½“å‰AI Officeå·²æœ‰å®Œæ•´çš„AIäº¤äº’ç³»ç»Ÿï¼Œä½äºï¼š
- æ ¸å¿ƒç»„ä»¶ï¼š`frontend/components/ai-office/chat/ChatPanel.tsx`ï¼ˆ1615è¡Œï¼‰
- APIè·¯ç”±ï¼š`frontend/app/api/ai-office/chat/route.ts`
- å½“å‰æ¨¡å‹ï¼šé»˜è®¤ä½¿ç”¨'grok'ï¼Œæ”¯æŒé…ç½®åˆ‡æ¢

**ç°æœ‰ChatPanelæ ¸å¿ƒåŠŸèƒ½ï¼š**

1. âœ… **æ„å›¾è¯†åˆ«ç³»ç»Ÿ**ï¼ˆè¡Œ74-193ï¼‰
   ```typescript
   // å·²å®ç°çš„æ„å›¾è¯†åˆ«
   - æ–‡æ¡£ç”Ÿæˆè¯·æ±‚æ£€æµ‹ï¼ˆPPT/Word/æŠ¥å‘Šï¼‰
   - æ›´æ–°/ä¿®æ”¹è¯·æ±‚æ£€æµ‹
   - å±€éƒ¨æ›´æ–°é¡µé¢æ£€æµ‹ï¼ˆ"æ›´æ–°ç¬¬1-3é¡µ"ï¼‰
   - æ–°æ–‡æ¡£åˆ›å»ºåˆ¤æ–­
````

2. âœ… **@èµ„æºå¼•ç”¨ç³»ç»Ÿ**ï¼ˆè¡Œ74-164ï¼‰

   ```typescript
   // å·²å®ç°çš„èµ„æºå¼•ç”¨
   - @all - å¼•ç”¨æ‰€æœ‰èµ„æº
   - @èµ„æºæ ‡é¢˜ - å¼•ç”¨ç‰¹å®šèµ„æº
   - è‡ªåŠ¨è¦†ç›–é€‰ä¸­èµ„æºé€»è¾‘
   ```

3. âœ… **æµå¼å¤„ç†**ï¼ˆè¡Œ706-897ï¼‰

   ```typescript
   // å·²å®ç°çš„SSEæµå¼ç”Ÿæˆ
   -å®æ—¶æ¥æ”¶AIè¾“å‡º - å®æ—¶æ›´æ–°æ¶ˆæ¯å’Œæ–‡æ¡£ - åœæ­¢ç”ŸæˆæŒ‰é’®;
   ```

4. âœ… **å±€éƒ¨æ›´æ–°**ï¼ˆè¡Œ898-939ï¼‰
   ```typescript
   // å·²å®ç°çš„PPTé¡µé¢çº§æ›´æ–°
   - æ”¯æŒ"æ›´æ–°ç¬¬1é¡µ"ã€"æ›´æ–°ç¬¬1-3é¡µ"
   - ä»…æ›¿æ¢æŒ‡å®šé¡µé¢ï¼Œä¿æŒå…¶ä»–é¡µé¢ä¸å˜
   - æ”¯æŒä¸­æ–‡/é˜¿æ‹‰ä¼¯æ•°å­—é¡µç 
   ```

**ğŸ†• 2.0 Multi-Agentå¢å¼ºæ–¹æ¡ˆï¼š**

åŸºäºç°æœ‰ChatPanelï¼Œå¢åŠ Multi-Agentç¼–æ’å±‚ï¼š

**Agenté…ç½®ï¼ˆåœ¨ç°æœ‰åŸºç¡€ä¸Šæ‰©å±•ï¼‰ï¼š**

| Agent                     | æ¨¡å‹    | èŒè´£                  | é›†æˆæ–¹å¼           |
| ------------------------- | ------- | --------------------- | ------------------ |
| **CoordinatorAgent**      | Grok    | ä»»åŠ¡è§„åˆ’ã€Agentç¼–æ’   | æ‰©å±•ç°æœ‰æ„å›¾è¯†åˆ«   |
| **ResourceAnalysisAgent** | Grok    | æ·±åº¦åˆ†æå­¦æœ¯/æŠ€æœ¯èµ„æº | æ–°å¢é¢„å¤„ç†æ­¥éª¤     |
| **ContentWritingAgent**   | ChatGPT | æ’°å†™æµç•…çš„å†…å®¹        | ä½¿ç”¨ç°æœ‰æµå¼ç”Ÿæˆ   |
| **VisualizationAgent**    | ChatGPT | è®¾è®¡å›¾è¡¨å’Œå¯è§†åŒ–      | å¢å¼ºç°æœ‰å¯è§†åŒ–æ ‡è®° |
| **VerificationAgent**     | Grok    | äº‹å®éªŒè¯ã€äº¤å‰æ£€æŸ¥    | æ–°å¢åå¤„ç†æ­¥éª¤     |

**å¢å¼ºåçš„å·¥ä½œæµç¨‹ï¼ˆåœ¨ç°æœ‰ChatPanelåŸºç¡€ä¸Šï¼‰ï¼š**

```typescript
// ============ ç°æœ‰æµç¨‹ï¼ˆä¿ç•™ï¼‰ ============
// ChatPanel.tsx handleSend() - 1615è¡Œæ ¸å¿ƒé€»è¾‘

// 1. ç”¨æˆ·è¾“å…¥ï¼ˆç°æœ‰ï¼‰
User: "å¸®æˆ‘ç”Ÿæˆä¸€ä¸ªå…³äºç£·é…¸åŒ–ç½‘ç»œçš„å­¦æœ¯æ¼”è®²PPT"
   â†“
// 2. æ„å›¾è¯†åˆ«ï¼ˆç°æœ‰ï¼Œè¡Œ74-193ï¼‰
const isPPTRequest = /ppt|powerpoint|æ¼”ç¤ºæ–‡ç¨¿/i.test(userInput); // âœ…
const isDocumentGenerationRequest = hasDocumentType && hasActionVerb; // âœ…
   â†“
// 3. @èµ„æºè§£æï¼ˆç°æœ‰ï¼Œè¡Œ74-164ï¼‰
const mentionedResourceIds = parseMentions(userInput); // âœ…
const resourceIdsToUse = mentionedResourceIds.length > 0
  ? mentionedResourceIds
  : selectedResourceIds; // âœ…

// ============ 2.0 Multi-Agentå¢å¼º ============

// 4. ğŸ†• CoordinatorAgenté¢„å¤„ç†
const agentPlan = await coordinatorAgent.plan({
  objective: isPPTRequest ? 'ç”Ÿæˆå­¦æœ¯æ¼”è®²PPT' : 'ç”Ÿæˆæ–‡æ¡£',
  resources: selectedResources,
  userIntent: userInput,
  existingDocument: currentDocument,
});
// è¿”å›ï¼š{ needsResourceAnalysis: true, needsVisualization: true, ... }

// 5. ğŸ†• Phase 1: ResourceAnalysisAgentï¼ˆå¦‚æœéœ€è¦ï¼‰
if (agentPlan.needsResourceAnalysis) {
  const analysis = await resourceAnalysisAgent.analyze({
    resources: selectedResources,
    focus: agentPlan.focus,
  });
  // è¿”å›ï¼š{ keyInsights, coreFindings, visualOpportunities }

  // å°†åˆ†æç»“æœæ³¨å…¥Prompt
  enhancedPrompt += `\n\nã€AIèµ„æºåˆ†æç»“æœã€‘\n${JSON.stringify(analysis)}`;
}

// 6. ç°æœ‰æµå¼ç”Ÿæˆï¼ˆä¿ç•™ï¼Œä½¿ç”¨å¢å¼ºåçš„Promptï¼‰
const response = await fetch('/api/ai-office/chat', {
  method: 'POST',
  body: JSON.stringify({
    message: enhancedPrompt, // âœ… ä½¿ç”¨å¢å¼ºåçš„Prompt
    resources: selectedResources, // âœ…
    documentId: targetDocumentId, // âœ…
    stream: true, // âœ…
    agentPlan, // ğŸ†• ä¼ é€’Agentè§„åˆ’
  }),
});

// 7. æµå¼æ¥æ”¶ï¼ˆç°æœ‰ï¼Œè¡Œ744-897ï¼‰
const reader = response.body?.getReader();
let aiContent = '';
while (true) {
  const { done, value } = await reader.read();
  if (done) break;

  const chunk = decoder.decode(value);
  aiContent += parseChunk(chunk);

  // âœ… å®æ—¶æ›´æ–°UIï¼ˆç°æœ‰ï¼‰
  updateMessage(aiMessageId, { content: aiContent });
  updateDocument(targetDocumentId, {
    content: { markdown: aiContent }
  });
}

// 8. ğŸ†• Phase 3: VerificationAgentåå¤„ç†
if (agentPlan.needsVerification) {
  const verified = await verificationAgent.verify({
    content: aiContent,
    sources: selectedResources,
  });

  // åœ¨æ–‡æ¡£ä¸­æ·»åŠ éªŒè¯æ ‡è®°
  const enhancedContent = addVerificationBadges(aiContent, verified);
  updateDocument(targetDocumentId, {
    content: { markdown: enhancedContent },
    metadata: { verificationResult: verified },
  });
}

// 9. ç‰ˆæœ¬ä¿å­˜ï¼ˆç°æœ‰ï¼Œè¡Œ908-939ï¼‰
saveVersion(
  targetDocumentId,
  'auto',
  'ai_generation',
  `Multi-Agentç”Ÿæˆï¼š${currentDocument.title}`
); // âœ…
```

**å…³é”®æ”¹è¿›ç‚¹ï¼š**

1. âœ… **ä¿ç•™ç°æœ‰æµç¨‹** - ChatPanelçš„æ ¸å¿ƒé€»è¾‘ä¸å˜
2. ğŸ†• **å¢åŠ é¢„å¤„ç†** - CoordinatorAgentè§„åˆ’ + ResourceAnalysisAgentåˆ†æ
3. ğŸ†• **å¢å¼ºPrompt** - å°†Agentåˆ†æç»“æœæ³¨å…¥Prompt
4. âœ… **ä¿ç•™æµå¼ç”Ÿæˆ** - ä½¿ç”¨ç°æœ‰çš„SSEæœºåˆ¶
5. ğŸ†• **å¢åŠ åå¤„ç†** - VerificationAgentéªŒè¯ + æ·»åŠ ç½®ä¿¡åº¦æ ‡è®°

**æ‰©å±•èƒ½åŠ›ä¿ç•™ï¼š**

```typescript
// backend/src/modules/ai/agents/agent-config.ts
export const AGENT_CONFIG = {
  models: {
    primary: {
      coordinator: "grok", // ä¸»åè°ƒå™¨
      reasoning: "grok", // æ·±åº¦æ¨ç†
      creative: "chatgpt", // åˆ›æ„å†…å®¹
      visual: "chatgpt", // å¯è§†åŒ–
    },
    // ä¿ç•™æ‰©å±•æ¥å£
    extensions: {
      claude: { enabled: false, apiKey: "" },
      gemini: { enabled: false, apiKey: "" },
      custom: { enabled: false, endpoint: "" },
    },
  },

  // Agentæ³¨å†Œè¡¨ï¼ˆæ”¯æŒåŠ¨æ€æ·»åŠ ï¼‰
  agents: [
    { name: "coordinator", model: "grok", enabled: true },
    { name: "resource-analysis", model: "grok", enabled: true },
    { name: "content-writing", model: "chatgpt", enabled: true },
    { name: "visualization", model: "chatgpt", enabled: true },
    { name: "verification", model: "grok", enabled: true },
    // ç”¨æˆ·å¯ä»¥é€šè¿‡é…ç½®æ·»åŠ æ–°Agent
  ],
};
```

---

#### 3.2.3 Research Page - ç»“æ„åŒ–çŸ¥è¯†é¡µé¢

**äº§å“ç†å¿µï¼š** å—Genspark Sparkpageå¯å‘ï¼Œä½†æ›´èšç„¦ç§‘ç ”/æŠ€æœ¯é¢†åŸŸ

**é¡µé¢ç»“æ„ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Research Page: ç£·é…¸åŒ–ç½‘ç»œçš„å¤šç¨³æ€ç‰¹æ€§                â”‚
â”‚ ğŸ“š 3 resources Â· ğŸ¤– 5 agents Â· â±ï¸ 12 min read       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ ğŸ“‹ Executive Summary â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç£·é…¸åŒ–ç½‘ç»œåœ¨ç»†èƒä¿¡å·ä¼ å¯¼ä¸­å±•ç°å‡ºå¤šç¨³æ€ç‰¹æ€§ï¼Œè¿™ç§  â”‚
â”‚ ç‰¹æ€§ä½¿å¾—ç”Ÿç‰©ç³»ç»Ÿèƒ½å¤Ÿå®ç°å¼€å…³å¼çš„å†³ç­–...          â”‚
â”‚                                                    â”‚
â”‚ Generated by: Grok Â· Confidence: 92%              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ ğŸ’¡ Key Findings â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Finding 1: ç£·é…¸åŒ–çº§è”ååº”å±•ç°åŒç¨³æ€              â”‚
â”‚ âœ… Verified by 2 agents Â· 95% confidence          â”‚
â”‚ ğŸ“„ Source: Smith et al. 2023, arXiv:2301.12345   â”‚
â”‚ ğŸ’¬ Evidence: "å®éªŒæ•°æ®æ˜¾ç¤ºåœ¨ç‰¹å®šå‚æ•°èŒƒå›´å†…..."   â”‚
â”‚                                                    â”‚
â”‚ Finding 2: ç”Ÿç‰©å¼€å…³çš„åˆ†å­åŸºç¡€                     â”‚
â”‚ âœ… Verified by 2 agents Â· 90% confidence          â”‚
â”‚ ğŸ“„ Source: Jones et al. 2022                      â”‚
â”‚                                                    â”‚
â”‚ Finding 3: ç†è®ºæ¨¡å‹çš„é¢„æµ‹èƒ½åŠ›                     â”‚
â”‚ âš ï¸ Partially verified Â· 70% confidence            â”‚
â”‚ ğŸ” Needs more evidence                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ ğŸ“Š Visual Insights â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [æµç¨‹å›¾] ç£·é…¸åŒ–çº§è”ååº”è·¯å¾„                       â”‚
â”‚ [æŸ±çŠ¶å›¾] ä¸åŒæ¡ä»¶ä¸‹çš„ç¨³æ€åˆ†å¸ƒ                     â”‚
â”‚ [åˆ†å­å›¾] å…³é”®è›‹ç™½ç»“æ„                             â”‚
â”‚ Generated by: ChatGPT                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ ğŸ”¬ Technical Deep Dive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Tabs]                                            â”‚
â”‚ â”‚ Methodology â”‚ Results â”‚ Code Examples â”‚         â”‚
â”‚                                                    â”‚
â”‚ [Methodology Tabå†…å®¹]                             â”‚
â”‚ å®éªŒé‡‡ç”¨åŒæ‚äº¤æŠ€æœ¯éªŒè¯è›‹ç™½ç›¸äº’ä½œç”¨...             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ ğŸ¯ Actionable Insights â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Recommendations:                                â”‚
â”‚   â€¢ åœ¨ç±»ä¼¼ç³»ç»Ÿä¸­åº”ç”¨å¤šç¨³æ€ç†è®º                    â”‚
â”‚   â€¢ è¿›ä¸€æ­¥éªŒè¯è¾¹ç•Œæ¡ä»¶                            â”‚
â”‚                                                    â”‚
â”‚ â†’ Next Steps:                                     â”‚
â”‚   1. è®¾è®¡æ–°å®éªŒéªŒè¯ç†è®ºé¢„æµ‹                       â”‚
â”‚   2. æ‰©å±•æ¨¡å‹åˆ°å…¶ä»–ä¿¡å·é€šè·¯                       â”‚
â”‚                                                    â”‚
â”‚ ? Open Questions:                                 â”‚
â”‚   â€¢ å¤šç¨³æ€åœ¨ä½“å†…æ˜¯å¦æ™®éå­˜åœ¨ï¼Ÿ                    â”‚
â”‚   â€¢ å¦‚ä½•å®šé‡æµ‹é‡ç¨³æ€è½¬æ¢ï¼Ÿ                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Actions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ“Š ç”ŸæˆPPT] [ğŸ“„ ç”ŸæˆDoc] [ğŸ”— åˆ†äº«] [â¬‡ï¸ å¯¼å‡º]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•°æ®æ¨¡å‹ï¼š**

```typescript
interface ResearchPage {
  id: string;
  title: string;
  query: string;

  sections: {
    summary: {
      content: string;
      generatedBy: "grok" | "chatgpt";
      confidence: number;
    };

    keyFindings: Array<{
      claim: string;
      verified: boolean;
      confidence: number;
      verifiedBy: Array<{
        agent: string;
        result: "verified" | "partial" | "rejected";
      }>;
      evidence: Array<{
        text: string;
        source: Resource;
      }>;
      contradictions?: Array<{
        text: string;
        source: Resource;
      }>;
    }>;

    visualInsights: {
      charts: ChartData[];
      diagrams: DiagramData[];
      generatedBy: string;
    };

    deepDive: {
      methodology?: string;
      results?: string;
      codeExamples?: CodeBlock[];
    };

    actionableInsights: {
      recommendations: string[];
      nextSteps: string[];
      openQuestions: string[];
    };
  };

  metadata: {
    resourcesAnalyzed: number;
    agentsInvolved: string[];
    generatedAt: Date;
    estimatedReadTime: number;
  };
}
```

**ä¸€é”®è½¬æ¢åŠŸèƒ½ï¼š**

```typescript
// ä»Research Pageä¸€é”®ç”ŸæˆPPT
ResearchPage â†’ [åº”ç”¨æ¨¡æ¿] â†’ PPT Document

// æˆ–ç”ŸæˆDoc
ResearchPage â†’ [åº”ç”¨æ¨¡æ¿] â†’ Doc Document
```

---

#### 3.2.4 æŒç»­è¿­ä»£ç¼–è¾‘ç³»ç»Ÿï¼ˆåŸºäºç°æœ‰å®ç°å¢å¼ºï¼‰

**ç°æœ‰å®ç°åŸºç¡€ï¼š**

å½“å‰AI Officeå·²æœ‰å®Œæ•´çš„ç‰ˆæœ¬ç®¡ç†å’Œæ–‡æ¡£ç¼–è¾‘ç³»ç»Ÿï¼š

- ç‰ˆæœ¬ç®¡ç†ç»„ä»¶ï¼š`frontend/components/ai-office/document/VersionHistory.tsx`
- æ–‡æ¡£ç¼–è¾‘å™¨ï¼š`frontend/components/ai-office/document/DocumentEditor.tsx`
- çŠ¶æ€ç®¡ç†ï¼š`frontend/stores/aiOfficeStore.ts` â†’ `useDocumentStore`

**ç°æœ‰ç‰ˆæœ¬ç®¡ç†åŠŸèƒ½ï¼š**

1. âœ… **è‡ªåŠ¨ç‰ˆæœ¬å¿«ç…§**ï¼ˆå·²å®ç°ï¼‰

   ```typescript
   // useDocumentStore.saveVersion()
   interface DocumentVersion {
     id: string;
     timestamp: Date;
     type: "auto" | "manual";
     trigger: "ai_generation" | "user_edit" | "manual_save";
     content: any; // å®Œæ•´å†…å®¹å¿«ç…§
     metadata: {
       title: string;
       wordCount?: number;
       slideCount?: number;
       description?: string;
     };
     aiModel?: string;
   }
   ```

2. âœ… **ç‰ˆæœ¬æ“ä½œ**ï¼ˆå·²å®ç°ï¼‰
   - `saveVersion()` - ä¿å­˜ç‰ˆæœ¬
   - `getVersions()` - è·å–ç‰ˆæœ¬åˆ—è¡¨
   - `restoreVersion()` - æ¢å¤ç‰ˆæœ¬ï¼ˆå®Œå…¨æ›¿æ¢å½“å‰å†…å®¹ï¼‰
   - `deleteVersion()` - åˆ é™¤ç‰ˆæœ¬

3. âœ… **è‡ªåŠ¨è§¦å‘æœºåˆ¶**ï¼ˆå·²å®ç°ï¼‰
   - AIç”Ÿæˆå®Œæˆ â†’ è‡ªåŠ¨ä¿å­˜ï¼ˆtrigger='ai_generation'ï¼‰
   - ç”¨æˆ·æ‰‹åŠ¨ä¿å­˜ â†’ æ‰‹åŠ¨ä¿å­˜ï¼ˆtrigger='manual_save'ï¼‰
   - ç”¨æˆ·ç¼–è¾‘ â†’ å¯é€‰è‡ªåŠ¨ä¿å­˜ï¼ˆtrigger='user_edit'ï¼‰

**ç°æœ‰æ–‡æ¡£ç¼–è¾‘åŠŸèƒ½ï¼š**

1. âœ… **è‡ªåŠ¨ä¿å­˜**ï¼ˆå·²å®ç°ï¼ŒDocumentEditorç»„ä»¶ï¼‰

   ```typescript
   // é˜²æŠ–1000msè‡ªåŠ¨ä¿å­˜
   useEffect(() => {
     const timer = setTimeout(() => {
       updateDocument(currentDocumentId, {
         title: title,
         content: { markdown: content },
         metadata: { wordCount: content.length },
       });
     }, 1000);
   }, [content, title]);
   ```

2. âœ… **PPT Slideç¼–è¾‘**ï¼ˆå·²å®ç°ï¼‰
   - å¹»ç¯ç‰‡å¯¼èˆªï¼ˆprev/nextï¼‰
   - å¹»ç¯ç‰‡ç¼©ç•¥å›¾
   - å±€éƒ¨æ›´æ–°ï¼ˆæŒ‡å®šé¡µé¢ï¼‰
   - 5ç§ä¸»é¢˜æ¨¡æ¿

3. âœ… **ä»»åŠ¡ä¸Šä¸‹æ–‡ä¿å­˜**ï¼ˆå·²å®ç°ï¼‰
   - å®Œæ•´èµ„æºåˆ—è¡¨å¿«ç…§
   - å®Œæ•´æ–‡æ¡£å†…å®¹å¿«ç…§
   - å®Œæ•´å¯¹è¯å†å²å¿«ç…§
   - å®Œæ•´ç‰ˆæœ¬å†å²å¿«ç…§

**ğŸ†• 2.0å¢å¼ºåŠŸèƒ½ï¼š**

##### A. ç‰ˆæœ¬å¯¹æ¯”ï¼ˆDiffï¼‰åŠŸèƒ½

```typescript
// æ–°å¢ï¼šç‰ˆæœ¬å¯¹æ¯”åŠŸèƒ½
interface VersionComparison {
  oldVersion: DocumentVersion;
  newVersion: DocumentVersion;

  changes: Array<{
    type: 'added' | 'modified' | 'deleted';
    section: string;  // slide ID or chapter ID
    oldContent?: string;
    newContent?: string;
    diff?: DiffResult;
  }>;

  stats: {
    added: number;
    modified: number;
    deleted: number;
  };
}

// å®ç°
function compareVersions(v1: DocumentVersion, v2: DocumentVersion): VersionComparison {
  // ä½¿ç”¨diffç®—æ³•æ¯”è¾ƒå†…å®¹
  // è¿”å›è¯¦ç»†çš„å˜æ›´åˆ—è¡¨
}
    diff?: any;          // è¯¦ç»†çš„diff
  };

  author: 'user' | 'ai';
  message: string;        // ç‰ˆæœ¬æäº¤ä¿¡æ¯
  createdAt: Date;

  // ç‰ˆæœ¬å…³ç³»
  parentVersion?: string;
  branches?: string[];    // æ”¯æŒåˆ†æ”¯ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰
}
```

**ç‰ˆæœ¬ç®¡ç†UIï¼š**

```
â”Œâ”€ ç‰ˆæœ¬å†å² â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                 â”‚
â”‚ â— v2.1 (å½“å‰)                   2025-11-17     â”‚
â”‚ â”‚ æ›´æ–°ç¬¬3-5é¡µçš„å¯è§†åŒ–                          â”‚
â”‚ â”‚ By: AI (ChatGPT)                             â”‚
â”‚ â”‚ [æŸ¥çœ‹è¯¦æƒ…] [æ¢å¤åˆ°æ­¤ç‰ˆæœ¬]                    â”‚
â”‚ â”‚                                               â”‚
â”‚ â— v2.0                          2025-11-16     â”‚
â”‚ â”‚ æ·»åŠ äº†Technical Deep Diveéƒ¨åˆ†                â”‚
â”‚ â”‚ By: User                                     â”‚
â”‚ â”‚                                               â”‚
â”‚ â— v1.5                          2025-11-15     â”‚
â”‚ â”‚ ä¿®å¤äº†å¼•ç”¨æ ¼å¼                               â”‚
â”‚ â”‚ By: User                                     â”‚
â”‚ â”‚                                               â”‚
â”‚ â— v1.0 (åˆå§‹ç‰ˆæœ¬)              2025-11-14     â”‚
â”‚   é¦–æ¬¡ç”Ÿæˆ                                      â”‚
â”‚   By: AI (Multi-Agent)                         â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### B. ç¼©ç•¥å›¾é¢„è§ˆ

**PPTç¼©ç•¥å›¾ï¼š**

```
â”Œâ”€ å¹»ç¯ç‰‡ç¼©ç•¥å›¾ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                 â”‚
â”‚ [Slide 1]  [Slide 2]  [Slide 3]  [Slide 4]    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”       â”‚
â”‚ â”‚Title â”‚  â”‚Intro â”‚  â”‚Flow  â”‚  â”‚Data  â”‚       â”‚
â”‚ â”‚Page  â”‚  â”‚      â”‚  â”‚Chart â”‚  â”‚Chart â”‚       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚   v2.1      v2.0      v2.1      v1.5          â”‚ â† ç‰ˆæœ¬æ ‡è®°
â”‚                                                 â”‚
â”‚ [Slide 5]  [Slide 6]  [+ æ–°å¢]                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚ â”‚Deep  â”‚  â”‚Actionâ”‚                            â”‚
â”‚ â”‚Dive  â”‚  â”‚Items â”‚                            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚   v2.1      v1.0                               â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‚¹å‡»ä»»ä¸€ç¼©ç•¥å›¾ â†’ è·³è½¬åˆ°è¯¥slide
å³é”®èœå•ï¼š
  - ç¼–è¾‘æ­¤slide
  - åˆ é™¤æ­¤slide  - æ’å…¥æ–°slide
  - æŸ¥çœ‹ç‰ˆæœ¬å†å²
  - æ¢å¤æ—§ç‰ˆæœ¬
```

**Docç« èŠ‚ç¼©ç•¥å›¾ï¼š**

```
â”Œâ”€ ç« èŠ‚ç¼©ç•¥å›¾ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                               â”‚
â”‚ ğŸ“„ 1. Introduction (v2.0)                    â”‚
â”‚    150 words Â· Last edited 2 days ago        â”‚
â”‚    [ç¼–è¾‘] [æŸ¥çœ‹ç‰ˆæœ¬]                          â”‚
â”‚                                               â”‚
â”‚ ğŸ“„ 2. Background (v1.5)                      â”‚
â”‚    300 words Â· Last edited 5 days ago        â”‚
â”‚    [ç¼–è¾‘] [æŸ¥çœ‹ç‰ˆæœ¬]                          â”‚
â”‚                                               â”‚
â”‚ ğŸ“Š 3. Visual Analysis (v2.1) â­ New!         â”‚
â”‚    2 charts Â· Last edited today              â”‚
â”‚    [ç¼–è¾‘] [æŸ¥çœ‹ç‰ˆæœ¬]                          â”‚
â”‚                                               â”‚
â”‚ ğŸ“„ 4. Methodology (v1.0)                     â”‚
â”‚    450 words Â· Last edited 10 days ago       â”‚
â”‚    [ç¼–è¾‘] [æŸ¥çœ‹ç‰ˆæœ¬]                          â”‚
â”‚                                               â”‚
â”‚ [+ æ·»åŠ æ–°ç« èŠ‚]                                â”‚
â”‚                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### C. é€‰ä¸­ç¼–è¾‘ï¼ˆGranular Editingï¼‰

**PPTé€‰ä¸­ç¼–è¾‘ï¼š**

```
ç”¨æˆ·ï¼šé€‰ä¸­Slide 3
    â†“
æ˜¾ç¤ºç¼–è¾‘é¢æ¿ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¼–è¾‘ Slide 3: æµç¨‹å›¾                        â”‚
â”‚                                             â”‚
â”‚ [é¢„è§ˆçª—å£]                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚ â”‚ ç£·é…¸åŒ–çº§è”ååº”      â”‚                    â”‚
â”‚ â”‚ [æµç¨‹å›¾æ˜¾ç¤º]        â”‚                    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                             â”‚
â”‚ ç¼–è¾‘é€‰é¡¹ï¼š                                  â”‚
â”‚ â—‹ é‡æ–°ç”Ÿæˆæ­¤slideï¼ˆAIï¼‰                    â”‚
â”‚   æç¤ºè¯ï¼š_____________________________    â”‚
â”‚   [ç”Ÿæˆ] [å–æ¶ˆ]                            â”‚
â”‚                                             â”‚
â”‚ â—‹ æ‰‹åŠ¨ç¼–è¾‘                                 â”‚
â”‚   æ ‡é¢˜ï¼šç£·é…¸åŒ–çº§è”ååº”                     â”‚
â”‚   å†…å®¹ï¼š[å¯Œæ–‡æœ¬ç¼–è¾‘å™¨]                     â”‚
â”‚   å¯è§†åŒ–ï¼š[æµç¨‹å›¾ç¼–è¾‘å™¨]                   â”‚
â”‚   [ä¿å­˜] [å–æ¶ˆ]                            â”‚
â”‚                                             â”‚
â”‚ â—‹ æ›´æ–°æ•°æ®ï¼ˆä¿æŒå¸ƒå±€ï¼‰                     â”‚
â”‚   ä¸Šä¼ æ–°æ•°æ®ï¼š[é€‰æ‹©æ–‡ä»¶]                   â”‚
â”‚   [æ›´æ–°] [å–æ¶ˆ]                            â”‚
â”‚                                             â”‚
â”‚ â—‹ æ¢å¤åˆ°æ—§ç‰ˆæœ¬                             â”‚
â”‚   [v2.0] [v1.5] [v1.0]                     â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Docé€‰ä¸­ç¼–è¾‘ï¼š**

```
ç”¨æˆ·ï¼šé€‰ä¸­Chapter 3 (Visual Analysis)
    â†“
æ˜¾ç¤ºç¼–è¾‘é¢æ¿ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¼–è¾‘ Chapter 3: Visual Analysis             â”‚
â”‚                                             â”‚
â”‚ [Markdownç¼–è¾‘å™¨]                            â”‚
â”‚ ## Visual Analysis                          â”‚
â”‚                                             â”‚
â”‚ æœ¬ç« åˆ†æäº†å®éªŒæ•°æ®çš„å¯è§†åŒ–ç»“æœ...          â”‚
â”‚                                             â”‚
â”‚ ### 3.1 æ•°æ®åˆ†å¸ƒ                            â”‚
â”‚ [å›¾è¡¨: æŸ±çŠ¶å›¾]                              â”‚
â”‚                                             â”‚
â”‚ ### 3.2 è¶‹åŠ¿åˆ†æ                            â”‚
â”‚ ...                                         â”‚
â”‚                                             â”‚
â”‚ AIè¾…åŠ©é€‰é¡¹ï¼š                                â”‚
â”‚ â€¢ [ğŸ’¡ AIå»ºè®®] æ·»åŠ æ›´å¤šå¯è§†åŒ–                â”‚
â”‚ â€¢ [ğŸ“Š ç”Ÿæˆå›¾è¡¨] åŸºäºæ–°æ•°æ®                  â”‚
â”‚ â€¢ [âœï¸ æ‰©å±•å†…å®¹] è¡¥å……åˆ†æç»†èŠ‚                â”‚
â”‚ â€¢ [ğŸ” äº‹å®æ£€æŸ¥] éªŒè¯æ•°æ®å‡†ç¡®æ€§              â”‚
â”‚                                             â”‚
â”‚ [ä¿å­˜ä¸ºæ–°ç‰ˆæœ¬] [ä¿å­˜è‰ç¨¿] [å–æ¶ˆ]            â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### D. æŒç»­ä¸°å¯Œï¼ˆContinuous Enrichmentï¼‰

**åœºæ™¯ï¼š** ç”¨æˆ·éšç€ç ”ç©¶è¿›å±•ï¼Œä¸æ–­æ·»åŠ æ–°èµ„æºå’Œå†…å®¹

```typescript
// æŒç»­ä¸°å¯Œæµç¨‹
Document v1.0 (åŸºäº3ç¯‡è®ºæ–‡)
    â†“
ç”¨æˆ·æ·»åŠ æ–°èµ„æº: paper4.pdf
    â†“
AIæ£€æµ‹åˆ°æ–°èµ„æºä¸Documentç›¸å…³
    â†“
AIæç¤ºï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¡ æ£€æµ‹åˆ°æ–°èµ„æºå¯ä»¥ä¸°å¯Œå½“å‰æ–‡æ¡£            â”‚
â”‚                                             â”‚
â”‚ æ–°èµ„æº: "Advanced Phosphorylation Study"   â”‚
â”‚ ç›¸å…³åº¦: 93%                                 â”‚
â”‚                                             â”‚
â”‚ å»ºè®®æ›´æ–°ï¼š                                  â”‚
â”‚ â€¢ Chapter 2: æ·»åŠ æœ€æ–°ç ”ç©¶è¿›å±•               â”‚
â”‚ â€¢ Chapter 4: æ›´æ–°å®éªŒæ–¹æ³•                   â”‚
â”‚ â€¢ æ–°å¢ Chapter 6: æœªæ¥å±•æœ›                  â”‚
â”‚                                             â”‚
â”‚ [âœ“ è‡ªåŠ¨ä¸°å¯Œ] [æ‰‹åŠ¨é€‰æ‹©] [å¿½ç•¥]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
ç”¨æˆ·ç‚¹å‡»"è‡ªåŠ¨ä¸°å¯Œ"
    â†“
AI (Grok) åˆ†ææ–°èµ„æºï¼Œæå–ç›¸å…³å†…å®¹
    â†“
AI (ChatGPT) å°†æ–°å†…å®¹æ•´åˆåˆ°ç°æœ‰ç« èŠ‚
    â†“
ç”Ÿæˆ Document v1.1
    â†“
æ˜¾ç¤ºDiffå¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç‰ˆæœ¬å¯¹æ¯”: v1.0 â†’ v1.1                       â”‚
â”‚                                             â”‚
â”‚ Chapter 2: Background                       â”‚
â”‚   + æ·»åŠ äº†æœ€æ–°ç ”ç©¶è¿›å±• (3æ®µ)                â”‚
â”‚   ~ æ›´æ–°äº†å¼•ç”¨åˆ—è¡¨ (æ–°å¢5ç¯‡)                â”‚
â”‚                                             â”‚
â”‚ Chapter 4: Methodology                      â”‚
â”‚   + æ·»åŠ äº†æ–°å®éªŒæ–¹æ³• (2æ®µ)                  â”‚
â”‚                                             â”‚
â”‚ + Chapter 6: Future Perspectives (æ–°å¢)    â”‚
â”‚                                             â”‚
â”‚ [âœ“ æ¥å—æ›´æ–°] [æŸ¥çœ‹è¯¦æƒ…] [æ’¤é”€]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 3.2.5 å¤šæ ¼å¼æ–‡æ¡£æ”¯æŒ

**æ”¯æŒçš„æ–‡æ¡£ç±»å‹ï¼š**

##### A. PPTæ–‡æ¡£ï¼ˆPowerPointï¼‰

**ç‰¹æ€§ï¼š**

1. **å¯ç¼–è¾‘Slide**
   - æ ‡é¢˜ã€å†…å®¹ã€å¯è§†åŒ–éƒ½å¯ç¼–è¾‘
   - æ”¯æŒå¯Œæ–‡æœ¬æ ¼å¼
   - æ”¯æŒå›¾ç‰‡ã€å›¾è¡¨åµŒå…¥

2. **ç‰ˆæœ¬åŒ–ç®¡ç†**
   - æ¯æ¬¡ç¼–è¾‘è‡ªåŠ¨åˆ›å»ºæ–°ç‰ˆæœ¬
   - ç‰ˆæœ¬å¯¹æ¯”ï¼ˆSlideçº§åˆ«ï¼‰
   - ä¸€é”®å›æ»š

3. **å®æ—¶é¢„è§ˆ**
   - ç¼–è¾‘æ—¶å®æ—¶çœ‹åˆ°æ•ˆæœ
   - æ”¯æŒæ¼”ç¤ºæ¨¡å¼é¢„è§ˆ

4. **æ™ºèƒ½å¸ƒå±€**
   - AIè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„å¸ƒå±€
   - ç”¨æˆ·å¯æ‰‹åŠ¨è°ƒæ•´

**æ•°æ®æ¨¡å‹ï¼š**

```typescript
interface PPTDocument extends Document {
  type: "ppt";

  content: {
    slides: Array<{
      id: string;
      order: number;
      layout: "title" | "content" | "two-column" | "visual" | "blank";

      elements: {
        title?: {
          text: string;
          style: TextStyle;
        };

        content?: {
          type: "text" | "bullet-list" | "markdown";
          data: string | string[];
          style: TextStyle;
        };

        visuals?: Array<{
          type: "chart" | "diagram" | "image" | "code";
          data: any;
          position: { x: number; y: number; width: number; height: number };
        }>;

        notes?: string; // æ¼”è®²è€…å¤‡æ³¨
      };

      // ç‰ˆæœ¬ä¿¡æ¯
      version: string;
      lastModified: Date;
      modifiedBy: "user" | "ai";
    }>;

    theme: {
      name: string;
      colors: ColorScheme;
      fonts: FontScheme;
      template: "academic" | "tech" | "minimal" | "custom";
    };
  };

  // ç¼©ç•¥å›¾ç¼“å­˜
  thumbnails: Map<string, string>; // slideId -> base64 image
}
```

##### B. Docæ–‡æ¡£ï¼ˆDocumentï¼‰

**ç‰¹æ€§ï¼š**

1. **ç« èŠ‚ç®¡ç†**
   - å¤šçº§æ ‡é¢˜ç»“æ„
   - è‡ªåŠ¨ç›®å½•ç”Ÿæˆ
   - ç« èŠ‚æŠ˜å /å±•å¼€

2. **æŒç»­ç¼–è¾‘**
   - Markdownç¼–è¾‘å™¨
   - å¯Œæ–‡æœ¬é¢„è§ˆ
   - å®æ—¶å­—æ•°ç»Ÿè®¡

3. **ç‰ˆæœ¬åŒ–ç®¡ç†**
   - ç« èŠ‚çº§åˆ«ç‰ˆæœ¬æ§åˆ¶
   - å†…å®¹Diffæ˜¾ç¤º
   - åˆå¹¶å†²çªå¤„ç†

4. **å­¦æœ¯ç‰¹æ€§**
   - å¼•ç”¨ç®¡ç†ï¼ˆBibTeXï¼‰
   - è„šæ³¨æ”¯æŒ
   - å…¬å¼ç¼–è¾‘ï¼ˆLaTeXï¼‰

**æ•°æ®æ¨¡å‹ï¼š**

```typescript
interface DocDocument extends Document {
  type: "doc";

  content: {
    chapters: Array<{
      id: string;
      order: number;
      level: 1 | 2 | 3 | 4; // h1, h2, h3, h4
      title: string;

      content: {
        markdown: string;
        html?: string; // æ¸²æŸ“ç¼“å­˜
      };

      elements: {
        text: string;
        citations?: Citation[];
        footnotes?: Footnote[];
        equations?: Equation[];
        figures?: Figure[];
        tables?: Table[];
        codeBlocks?: CodeBlock[];
      };

      metadata: {
        wordCount: number;
        readTime: number; // é¢„ä¼°é˜…è¯»æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
      };

      // ç‰ˆæœ¬ä¿¡æ¯
      version: string;
      lastModified: Date;
      modifiedBy: "user" | "ai";
    }>;

    // æ–‡æ¡£çº§å…ƒæ•°æ®
    frontMatter: {
      title: string;
      authors: string[];
      abstract?: string;
      keywords?: string[];
      date?: Date;
    };

    // å¼•ç”¨åˆ—è¡¨
    bibliography: Citation[];

    // æ ·å¼
    style: {
      template: "ieee" | "acm" | "apa" | "custom";
      fontSize: number;
      lineSpacing: number;
    };
  };
}
```

##### C. å¤šæ ¼å¼å¯¼å‡º

**å¯¼å‡ºæ”¯æŒï¼š**

| æ ¼å¼         | ç”¨é€”           | ç‰¹æ€§                                                          |
| ------------ | -------------- | ------------------------------------------------------------- |
| **PPTX**     | PowerPointæ¼”ç¤º | â€¢ åŸç”ŸPPTæ ¼å¼<br>â€¢ ä¿ç•™æ‰€æœ‰åŠ¨ç”»<br>â€¢ å¯åœ¨PowerPointä¸­ç»§ç»­ç¼–è¾‘ |
| **DOCX**     | Wordæ–‡æ¡£       | â€¢ åŸç”ŸWordæ ¼å¼<br>â€¢ ä¿ç•™æ ·å¼å’Œæ ¼å¼<br>â€¢ åŒ…å«å¼•ç”¨å’Œè„šæ³¨        |
| **PDF**      | æ‰“å°/åˆ†äº«      | â€¢ ä¸å¯ç¼–è¾‘<br>â€¢ ä¿ç•™æ’ç‰ˆ<br>â€¢ é€‚åˆæäº¤å’Œåˆ†äº«                  |
| **Markdown** | ç‰ˆæœ¬æ§åˆ¶/åä½œ  | â€¢ çº¯æ–‡æœ¬æ ¼å¼<br>â€¢ Gitå‹å¥½<br>â€¢ é€‚åˆåä½œç¼–è¾‘                   |
| **HTML**     | Webå‘å¸ƒ        | â€¢ å“åº”å¼å¸ƒå±€<br>â€¢ å¯åœ¨çº¿æŸ¥çœ‹<br>â€¢ æ”¯æŒäº¤äº’å¼å›¾è¡¨              |
| **LaTeX**    | å­¦æœ¯æŠ•ç¨¿       | â€¢ é«˜è´¨é‡æ’ç‰ˆ<br>â€¢ é€‚åˆå­¦æœ¯æœŸåˆŠ<br>â€¢ åŒ…å«BibTeXå¼•ç”¨            |

**å¯¼å‡ºæµç¨‹ï¼š**

```typescript
// å¯¼å‡ºAPI
class DocumentExportService {
  async exportToPPTX(document: PPTDocument): Promise<Buffer> {
    // ä½¿ç”¨ pptxgenjs åº“
    const pptx = new PptxGenJS();

    for (const slide of document.content.slides) {
      const pptxSlide = pptx.addSlide();

      // åº”ç”¨æ¨¡æ¿æ ·å¼
      this.applyTemplate(pptxSlide, document.content.theme);

      // æ·»åŠ æ ‡é¢˜
      if (slide.elements.title) {
        pptxSlide.addText(slide.elements.title.text, {
          x: 0.5,
          y: 0.5,
          w: 9,
          h: 1,
          fontSize: 32,
          bold: true,
        });
      }

      // æ·»åŠ å†…å®¹
      if (slide.elements.content) {
        this.addContent(pptxSlide, slide.elements.content);
      }

      // æ·»åŠ å¯è§†åŒ–
      if (slide.elements.visuals) {
        for (const visual of slide.elements.visuals) {
          await this.addVisual(pptxSlide, visual);
        }
      }
    }

    return await pptx.write();
  }

  async exportToDOCX(document: DocDocument): Promise<Buffer> {
    // ä½¿ç”¨ docx åº“
    const doc = new Document({
      sections: [
        {
          properties: {},
          children: [
            // æ ‡é¢˜é¡µ
            new Paragraph({
              text: document.content.frontMatter.title,
              heading: HeadingLevel.TITLE,
            }),

            // ä½œè€…
            new Paragraph({
              text: document.content.frontMatter.authors.join(", "),
            }),

            // ç›®å½•
            new TableOfContents(),

            // ç« èŠ‚å†…å®¹
            ...this.renderChapters(document.content.chapters),
          ],
        },
      ],
    });

    return await Packer.toBuffer(doc);
  }

  async exportToPDF(document: Document): Promise<Buffer> {
    // å…ˆè½¬ä¸ºHTMLï¼Œå†ç”¨puppeteerè½¬PDF
    const html = await this.exportToHTML(document);

    const browser = await puppeteer.launch();
    const page = await browser.newPage();
    await page.setContent(html);

    const pdf = await page.pdf({
      format: "A4",
      printBackground: true,
      margin: { top: "1in", bottom: "1in", left: "1in", right: "1in" },
    });

    await browser.close();
    return pdf;
  }

  async exportToMarkdown(document: DocDocument): Promise<string> {
    let markdown = "";

    // Front matter
    markdown += "---\n";
    markdown += `title: ${document.content.frontMatter.title}\n`;
    markdown += `authors: ${document.content.frontMatter.authors.join(", ")}\n`;
    markdown += "---\n\n";

    // ç« èŠ‚
    for (const chapter of document.content.chapters) {
      markdown += "#".repeat(chapter.level) + " " + chapter.title + "\n\n";
      markdown += chapter.content.markdown + "\n\n";
    }

    return markdown;
  }
}
```

---

#### 3.2.6 æ¨¡æ¿ç³»ç»Ÿ

**æ ¸å¿ƒç†å¿µï¼š** ä¸“ä¸šé¢†åŸŸéœ€è¦ä¸“ä¸šæ¨¡æ¿

**æ¨¡æ¿ç±»å‹ï¼š**

##### A. ç§‘ç ”æ¨¡æ¿ï¼ˆAcademic Templatesï¼‰

**1. å­¦æœ¯ä¼šè®®æ¼”è®²æ¨¡æ¿**

```yaml
name: "Academic Conference Presentation"
category: "academic"
type: "ppt"

slides:
  - layout: "title"
    required: true
    fields:
      - title: "ç ”ç©¶æ ‡é¢˜"
      - subtitle: "ä¼šè®®åç§°"
      - authors: "ä½œè€…åˆ—è¡¨"
      - affiliation: "æœºæ„"

  - layout: "outline"
    optional: true
    fields:
      - title: "Outline"
      - bullets: ["Background", "Methods", "Results", "Discussion"]

  - layout: "background"
    required: true
    fields:
      - title: "Background & Motivation"
      - content: "ç ”ç©¶èƒŒæ™¯"
      - visual: "flow-diagram" # å»ºè®®å¯è§†åŒ–ç±»å‹

  - layout: "methods"
    required: true
    fields:
      - title: "Methodology"
      - content: "ç ”ç©¶æ–¹æ³•"
      - visual: "flowchart"

  - layout: "results"
    required: true
    fields:
      - title: "Experimental Results"
      - visual: "charts" # å¤šä¸ªå›¾è¡¨
      - notes: "å…³é”®å‘ç°"

  - layout: "discussion"
    required: true
    fields:
      - title: "Discussion"
      - bullets: ["Implications", "Limitations", "Future Work"]

  - layout: "thank-you"
    required: true
    fields:
      - title: "Thank You"
      - contact: "Email & Website"
      - acknowledgments: "è‡´è°¢"

style:
  colors:
    primary: "#003366" # æ·±è“ï¼ˆå­¦æœ¯æ„Ÿï¼‰
    secondary: "#006699"
    accent: "#FF6B35"
    background: "#FFFFFF"
    text: "#333333"

  fonts:
    heading: "Times New Roman" # å­¦æœ¯æœŸåˆŠå¸¸ç”¨
    body: "Arial"
    code: "Courier New"

  layout:
    margins: { top: 0.5, bottom: 0.5, left: 0.75, right: 0.75 }
    titleSize: 32
    bodySize: 18
```

**2. æ–‡çŒ®ç»¼è¿°æ–‡æ¡£æ¨¡æ¿**

```yaml
name: "Literature Review"
category: "academic"
type: "doc"

structure:
  - chapter: "Abstract"
    required: true
    wordCount: { min: 150, max: 300 }

  - chapter: "Introduction"
    required: true
    subsections:
      - "Research Question"
      - "Scope and Objectives"
      - "Significance"

  - chapter: "Methodology"
    required: true
    subsections:
      - "Search Strategy"
      - "Inclusion/Exclusion Criteria"
      - "Data Extraction"

  - chapter: "Literature Review"
    required: true
    subsections:
      - "Thematic Analysis"
      - "Comparative Analysis"
      - "Gap Analysis"

  - chapter: "Discussion"
    required: true
    subsections:
      - "Key Findings"
      - "Implications"
      - "Limitations"

  - chapter: "Conclusion"
    required: true

  - chapter: "References"
    required: true
    format: "IEEE" # or APA, ACM, etc.

style:
  citationFormat: "IEEE"
  lineSpacing: 1.5
  fontSize: 12
  font: "Times New Roman"
```

##### B. æŠ€æœ¯æ¨¡æ¿ï¼ˆTech Templatesï¼‰

**1. æŠ€æœ¯åˆ†äº«æ¨¡æ¿**

```yaml
name: "Tech Talk"
category: "tech"
type: "ppt"

slides:
  - layout: "title"
    style: "minimal" # æŠ€æœ¯é£æ ¼æ›´ç®€çº¦

  - layout: "problem"
    fields:
      - title: "The Problem"
      - bullets: ["Pain points", "Current solutions", "Why they fail"]

  - layout: "solution"
    fields:
      - title: "Our Solution"
      - architecture: "system-diagram"
      - highlights: ["Key innovations"]

  - layout: "architecture"
    fields:
      - title: "System Architecture"
      - diagram: "architecture-diagram"
      - components: ["Component descriptions"]

  - layout: "implementation"
    fields:
      - title: "Implementation Details"
      - code: true # æ”¯æŒä»£ç å—
      - visual: "flowchart"

  - layout: "demo"
    fields:
      - title: "Live Demo"
      - screenshots: true
      - video: true

  - layout: "results"
    fields:
      - title: "Performance & Results"
      - charts: ["metrics", "comparisons"]

  - layout: "roadmap"
    fields:
      - title: "Roadmap"
      - timeline: true

style:
  colors:
    primary: "#1E1E1E" # æ·±ç°ï¼ˆä»£ç ç¼–è¾‘å™¨é£æ ¼ï¼‰
    secondary: "#007ACC" # VS Codeè“
    accent: "#4EC9B0" # Teal
    background: "#FFFFFF"
    codeBackground: "#F5F5F5"

  fonts:
    heading: "Segoe UI"
    body: "Segoe UI"
    code: "Fira Code" # ç¨‹åºå‘˜å­—ä½“
```

**2. æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£æ¨¡æ¿**

```yaml
name: "Technical Design Doc"
category: "tech"
type: "doc"

structure:
  - chapter: "Overview"
    subsections:
      - "Problem Statement"
      - "Goals and Non-Goals"
      - "Success Metrics"

  - chapter: "Background"
    subsections:
      - "Current System"
      - "Limitations"
      - "Requirements"

  - chapter: "Proposed Solution"
    subsections:
      - "High-Level Design"
      - "Detailed Design"
      - "API Specifications"
      - "Data Models"

  - chapter: "Architecture"
    includesDiagrams: true
    subsections:
      - "System Architecture"
      - "Component Interactions"
      - "Data Flow"

  - chapter: "Implementation Plan"
    subsections:
      - "Phases"
      - "Timeline"
      - "Dependencies"

  - chapter: "Testing Strategy"
    subsections:
      - "Unit Tests"
      - "Integration Tests"
      - "Performance Tests"

  - chapter: "Risks and Mitigations"

  - chapter: "Alternatives Considered"

style:
  codeHighlighting: true
  diagramTool: "mermaid"
  font: "Roboto"
```

##### C. è‡ªå®šä¹‰æ¨¡æ¿

**ç”¨æˆ·å¯åˆ›å»ºè‡ªå®šä¹‰æ¨¡æ¿ï¼š**

```typescript
interface CustomTemplate {
  metadata: {
    name: string;
    author: string;
    description: string;
    category: 'academic' | 'tech' | 'business' | 'other';
    type: 'ppt' | 'doc';
  };

  structure: {
    slides?: SlideTemplate[];
    chapters?: ChapterTemplate[];
  };

  style: {
    colors: ColorScheme;
    fonts: FontScheme;
    layout: LayoutConfig;
  };

  // AIç”Ÿæˆæç¤ºè¯æ¨¡æ¿
  aiPrompts: {
    [section: string]: string;
  };
}

// ç”¨æˆ·åˆ›å»ºæ¨¡æ¿çš„UI
<TemplateBuilder>
  <Step1>é€‰æ‹©åŸºç¡€æ¨¡æ¿</Step1>
  <Step2>è‡ªå®šä¹‰å¸ƒå±€å’Œæ ·å¼</Step2>
  <Step3>é…ç½®AIç”Ÿæˆè§„åˆ™</Step3>
  <Step4>ä¿å­˜å¹¶åˆ†äº«</Step4>
</TemplateBuilder>
```

##### D. æ¨¡æ¿å¸‚åœºï¼ˆæœªæ¥åŠŸèƒ½ï¼‰

```
â”Œâ”€ æ¨¡æ¿å¸‚åœº â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                               â”‚
â”‚ [ğŸ” æœç´¢æ¨¡æ¿...]                              â”‚
â”‚                                               â”‚
â”‚ çƒ­é—¨æ¨¡æ¿                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚ IEEEè®ºæ–‡    â”‚  â”‚ ACMä¼šè®®     â”‚            â”‚
â”‚ â”‚ â­â­â­â­â­  â”‚  â”‚ â­â­â­â­    â”‚            â”‚
â”‚ â”‚ 1.2kä¸‹è½½    â”‚  â”‚ 890ä¸‹è½½     â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                               â”‚
â”‚ æŠ€æœ¯æ¨¡æ¿                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚ ç³»ç»Ÿè®¾è®¡    â”‚  â”‚ Code Review â”‚            â”‚
â”‚ â”‚ â­â­â­â­    â”‚  â”‚ â­â­â­â­â­  â”‚            â”‚
â”‚ â”‚ 650ä¸‹è½½     â”‚  â”‚ 420ä¸‹è½½     â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                               â”‚
â”‚ æˆ‘çš„æ¨¡æ¿                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚ â”‚ è‡ªå®šä¹‰æ¨¡æ¿1 â”‚                              â”‚
â”‚ â”‚ Created 3å¤©å‰ â”‚                            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                               â”‚
â”‚ [+ åˆ›å»ºæ–°æ¨¡æ¿]                                â”‚
â”‚                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. æŠ€æœ¯æ¶æ„è®¾è®¡

### 4.1 æ•´ä½“æ¶æ„

**å½“å‰æ¶æ„ï¼ˆåŸºäºç°æœ‰å®ç°ï¼‰+ 2.0å¢å¼ºç‚¹ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Frontend (Next.js) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                â”‚
â”‚  â”Œâ”€â”€â”€ Left Sidebar â”€â”€â”€â”  â”Œâ”€â”€â”€â”€ Middle Panel â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€ Right Panel â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     â”‚  â”‚                       â”‚  â”‚                      â”‚ â”‚
â”‚  â”‚ â€¢ Explore         âœ…â”‚  â”‚  Resource List      âœ…â”‚  â”‚  Document Editor   âœ…â”‚ â”‚
â”‚  â”‚ â€¢ AI Office       âœ…â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚ â€¢ Settings        âœ…â”‚  â”‚  â”‚ Resource Cardsâ”‚   â”‚  â”‚  â”‚ PPT Slides   â”‚   â”‚ â”‚
â”‚  â”‚                     â”‚  â”‚  â”‚ (Checkboxes)  â”‚   â”‚  â”‚  â”‚ Navigation   â”‚   â”‚ â”‚
â”‚  â”‚ WorkspaceLayout   âœ…â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                     â”‚  â”‚                       â”‚  â”‚                      â”‚ â”‚
â”‚  â”‚ (Sidebar.tsx)       â”‚  â”‚  ChatPanel          âœ…â”‚  â”‚  MarkdownEditor    âœ…â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  Version History   âœ…â”‚ â”‚
â”‚                            â”‚  â”‚ Message List  â”‚   â”‚  â”‚  Export Options    âœ…â”‚ â”‚
â”‚                            â”‚  â”‚ Input Area    â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                            â”‚  â”‚ @mentions     â”‚   â”‚                            â”‚
â”‚                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  Task Sidebar (optional) âœ…â”‚
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Zustand State Stores âœ… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ useResourceStore | useDocumentStore | useChatStore | useTaskStore       â”‚ â”‚
â”‚  â”‚ â€¢ addResource    | â€¢ updateDocument  | â€¢ addMessage | â€¢ addTask         â”‚ â”‚
â”‚  â”‚ â€¢ _id dedup      | â€¢ saveVersion     | â€¢ clearChat  | â€¢ restoreContext  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                      â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚ REST API / SSE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          API Routes (Next.js App Router)                         â”‚
â”‚                                                                                   â”‚
â”‚  /api/ai-office/chat (route.ts) âœ…                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ†• [Pre-processing] Multi-Agent Enhancement Layer (2.0æ–°å¢)               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ CoordinatorAgent (Grok)    â†’ ä»»åŠ¡è§„åˆ’ã€æ„å›¾åˆ†æ                      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ ResourceAnalysisAgent (Grok) â†’ æ·±åº¦åˆ†æèµ„æºã€æå–æ´å¯Ÿ                â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                  â†“                                          â”‚ â”‚
â”‚  â”‚  âœ… [Core Stream] ç°æœ‰æµå¼ç”Ÿæˆ (ä¿æŒä¸å˜)                                  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ æ„å›¾è¯†åˆ« (isPPTRequest, isUpdateRequest)                            â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ @èµ„æºè§£æ (parseMentions)                                           â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Promptå¢å¼º (æ ¼å¼è¦æ±‚ + å¯è§†åŒ–æ ‡è®° + ğŸ†•Agentåˆ†æç»“æœ)                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ SSEæµå¼è°ƒç”¨ Grok/ChatGPT API                                        â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ å®æ—¶è¿”å›ç”Ÿæˆå†…å®¹                                                    â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                  â†“                                          â”‚ â”‚
â”‚  â”‚  ğŸ†• [Post-processing] éªŒè¯ä¸å¢å¼ºå±‚ (2.0æ–°å¢)                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ VerificationAgent (Grok) â†’ äº‹å®éªŒè¯ã€ç½®ä¿¡åº¦æ ‡è®°                       â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ ContentEnhancer          â†’ æ·»åŠ å¼•ç”¨ã€æ•°æ®æ¥æºæ ‡æ³¨                     â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                   â”‚
â”‚  å…¶ä»–APIè·¯ç”±ï¼š                                                                   â”‚
â”‚  â€¢ /api/ai-office/export âœ… (PPTX/DOCX/PDFå¯¼å‡º)                                 â”‚
â”‚  â€¢ /api/crawler/arxiv âœ… (arXivé‡‡é›†)                                            â”‚
â”‚  â€¢ /api/crawler/github âœ… (GitHubé‡‡é›†)                                          â”‚
â”‚                                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         External Services & Storage                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚  Grok API       â”‚  â”‚  ChatGPT API    â”‚  â”‚  MongoDB        â”‚                â”‚
â”‚  â”‚  (xAI)          â”‚  â”‚  (OpenAI)       â”‚  â”‚                 â”‚                â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚ â€¢ raw_data      â”‚                â”‚
â”‚  â”‚ â€¢ Coordinator   â”‚  â”‚ â€¢ Content       â”‚  â”‚ â€¢ resources-*   â”‚                â”‚
â”‚  â”‚ â€¢ Analysis      â”‚  â”‚ â€¢ Visualization â”‚  â”‚ â€¢ templates     â”‚                â”‚
â”‚  â”‚ â€¢ Verification  â”‚  â”‚                 â”‚  â”‚                 â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                                   â”‚
â”‚  ğŸ†• æ‰©å±•æ¥å£ï¼ˆé¢„ç•™ï¼‰ï¼š                                                           â”‚
â”‚  â€¢ Claude API (å¯é€‰)                                                            â”‚
â”‚  â€¢ Gemini API (å¯é€‰)                                                            â”‚
â”‚  â€¢ Custom Endpoint (å¯é€‰)                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¶æ„è¯´æ˜ï¼š**

1. **âœ… å·²å®ç°éƒ¨åˆ†ï¼ˆä¿æŒä¸å˜ï¼‰**ï¼š
   - å®Œæ•´çš„ä¸‰æ å¸ƒå±€ç³»ç»Ÿ (WorkspaceLayout.tsx)
   - Resourceç®¡ç† (ResourceList.tsx + useResourceStore)
   - ChatPanelæ ¸å¿ƒé€»è¾‘ (1615è¡Œï¼ŒChatPanel.tsx)
   - Documentç¼–è¾‘å™¨ (DocumentEditor.tsx + PPTæ¸²æŸ“)
   - ç‰ˆæœ¬ç®¡ç† (VersionHistory.tsx + useDocumentStore)
   - ä»»åŠ¡ç³»ç»Ÿ (TaskList.tsx + useTaskStore)
   - APIè·¯ç”± (route.ts)

2. **ğŸ†• 2.0å¢å¼ºï¼ˆåœ¨ç°æœ‰åŸºç¡€ä¸Šæ·»åŠ ï¼‰**ï¼š
   - **Pre-processingå±‚**: åœ¨API routeä¸­æ·»åŠ CoordinatorAgentå’ŒResourceAnalysisAgentï¼Œåˆ†æç”¨æˆ·æ„å›¾å’Œèµ„æº
   - **Promptå¢å¼º**: å°†Agentåˆ†æç»“æœæ³¨å…¥åˆ°ç°æœ‰Promptä¸­
   - **Post-processingå±‚**: åœ¨å†…å®¹ç”Ÿæˆåæ·»åŠ VerificationAgentéªŒè¯å’Œç½®ä¿¡åº¦æ ‡è®°

3. **æ ¸å¿ƒè®¾è®¡åŸåˆ™**ï¼š
   - **æ— éœ€é‡æ„**: æ‰€æœ‰å¢å¼ºéƒ½æ˜¯åœ¨ç°æœ‰æµç¨‹çš„"å‰å"æ·»åŠ ï¼Œä¸ä¿®æ”¹æ ¸å¿ƒé€»è¾‘
   - **æ¸è¿›å¢å¼º**: Multi-AgentåŠŸèƒ½å¯ä»¥é€æ­¥å¯ç”¨ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½
   - **å…¼å®¹æ€§**: ä¿æŒç°æœ‰APIæ¥å£ä¸å˜ï¼Œç¡®ä¿å‘åå…¼å®¹

### 4.2 Multi-Agenté›†æˆè®¾è®¡ï¼ˆåŸºäºç°æœ‰API Routeå¢å¼ºï¼‰

**è®¾è®¡ç†å¿µ**: åœ¨ç°æœ‰ `/api/ai-office/chat` è·¯ç”±ä¸­é›†æˆMulti-Agentèƒ½åŠ›ï¼Œè€Œéæ„å»ºç‹¬ç«‹çš„åç«¯ç³»ç»Ÿã€‚

#### 4.2.1 API Routeé›†æˆæ¶æ„

```typescript
// frontend/app/api/ai-office/chat/route.ts (âœ… ç°æœ‰æ–‡ä»¶ï¼Œæ·»åŠ Multi-Agentå¢å¼º)

import {
  CoordinatorAgent,
  ResourceAnalysisAgent,
  VerificationAgent,
} from "@/lib/ai-agents";

export async function POST(req: Request) {
  const {
    message,
    resources,
    documentId,
    agentMode = "enhanced",
  } = await req.json();

  // ============ âœ… ç°æœ‰é€»è¾‘ä¿ç•™ ============
  // 1. è§£æç”¨æˆ·è¾“å…¥
  const isPPTRequest = /ppt|powerpoint|æ¼”ç¤º/i.test(message);
  const isUpdateRequest = /æ›´æ–°|ä¿®æ”¹|è¡¥å……/i.test(message);

  // ============ ğŸ†• Multi-Agent Pre-processing ============
  let agentPlan, resourceAnalysis;

  if (agentMode === "enhanced" && resources?.length > 0) {
    // Step 1: CoordinatorAgentåˆ†ææ„å›¾
    const coordinator = new CoordinatorAgent("grok");
    agentPlan = await coordinator.analyze({
      userMessage: message,
      isPPT: isPPTRequest,
      isUpdate: isUpdateRequest,
      resourceCount: resources.length,
    });

    // Step 2: ResourceAnalysisAgentæ·±åº¦åˆ†æèµ„æº
    if (agentPlan.needsResourceAnalysis) {
      const analyzer = new ResourceAnalysisAgent("grok");
      resourceAnalysis = await analyzer.analyze({
        resources,
        focus: agentPlan.focus,
        analysisDepth: agentPlan.depth,
      });
    }
  }

  // ============ ğŸ†• Prompt Enhancement ============
  let enhancedPrompt = message;

  if (resourceAnalysis) {
    enhancedPrompt = `
${message}

ã€AIèµ„æºåˆ†æã€‘
æ ¸å¿ƒæ´å¯Ÿ: ${resourceAnalysis.insights.join("; ")}
å…³é”®å‘ç°: ${resourceAnalysis.findings.map((f) => f.claim).join("; ")}
å¯è§†åŒ–å»ºè®®: ${resourceAnalysis.visualOpportunities.map((v) => v.type).join(", ")}

è¯·åŸºäºä»¥ä¸Šåˆ†æç»“æœç”Ÿæˆå†…å®¹ã€‚
`;
  }

  // ============ âœ… ç°æœ‰æµå¼ç”Ÿæˆï¼ˆä½¿ç”¨å¢å¼ºåçš„Promptï¼‰============
  const response = await fetch(getAIEndpoint(agentPlan?.model || "grok"), {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      model: agentPlan?.model || "grok",
      messages: [
        {
          role: "system",
          content: buildSystemPrompt(isPPTRequest, resources), // âœ… ç°æœ‰å‡½æ•°
        },
        {
          role: "user",
          content: enhancedPrompt, // ğŸ†• ä½¿ç”¨å¢å¼ºåçš„Prompt
        },
      ],
      stream: true,
    }),
  });

  // âœ… æµå¼è¿”å›ï¼ˆç°æœ‰é€»è¾‘ï¼‰
  const encoder = new TextEncoder();
  const stream = new ReadableStream({
    async start(controller) {
      const reader = response.body?.getReader();
      let fullContent = "";

      while (true) {
        const { done, value } = await reader!.read();
        if (done) break;

        const chunk = new TextDecoder().decode(value);
        fullContent += chunk;
        controller.enqueue(encoder.encode(`data: ${chunk}\n\n`));
      }

      // ============ ğŸ†• Post-processing: Verification ============
      if (agentMode === "enhanced" && agentPlan?.needsVerification) {
        const verifier = new VerificationAgent("grok");
        const verification = await verifier.verify({
          content: fullContent,
          sources: resources,
        });

        // æ·»åŠ éªŒè¯ç»“æœåˆ°å“åº”
        controller.enqueue(
          encoder.encode(
            `data: ${JSON.stringify({
              type: "verification",
              confidence: verification.confidence,
              badges: verification.badges,
            })}\n\n`,
          ),
        );
      }

      controller.close();
    },
  });

  return new Response(stream, {
    headers: {
      "Content-Type": "text/event-stream",
      "Cache-Control": "no-cache",
    },
  });
}
```

#### 4.2.2 Agentå®ç°ï¼ˆè½»é‡çº§å·¥å…·å‡½æ•°ï¼‰

**æ³¨æ„**: Agentså®ç°ä¸ºè½»é‡çº§å·¥å…·å‡½æ•°ï¼Œä¸æ˜¯ç‹¬ç«‹çš„åç«¯æœåŠ¡ã€‚

```typescript
// frontend/lib/ai-agents/coordinator.agent.ts (ğŸ†• æ–°å¢æ–‡ä»¶)

interface AgentPlan {
  needsResourceAnalysis: boolean;
  needsVerification: boolean;
  focus?: string;
  depth: "shallow" | "deep";
  model: "grok" | "chatgpt";
}

export class CoordinatorAgent {
  constructor(private model: string) {}

  async analyze(input: {
    userMessage: string;
    isPPT: boolean;
    isUpdate: boolean;
    resourceCount: number;
  }): Promise<AgentPlan> {
    // ä½¿ç”¨ç®€å•çš„APIè°ƒç”¨Grokè¿›è¡Œæ„å›¾åˆ†æ
    const response = await fetch("/api/ai/grok", {
      method: "POST",
      body: JSON.stringify({
        model: "grok-2",
        messages: [
          {
            role: "system",
            content: "ä½ æ˜¯ä»»åŠ¡è§„åˆ’ä¸“å®¶ã€‚åˆ†æç”¨æˆ·æ„å›¾ï¼Œè¿”å›JSONæ ¼å¼çš„æ‰§è¡Œè®¡åˆ’ã€‚",
          },
          {
            role: "user",
            content: `
ç”¨æˆ·æ¶ˆæ¯: ${input.userMessage}
æ˜¯å¦PPTè¯·æ±‚: ${input.isPPT}
æ˜¯å¦æ›´æ–°è¯·æ±‚: ${input.isUpdate}
èµ„æºæ•°é‡: ${input.resourceCount}

è¿”å›JSON:
{
  "needsResourceAnalysis": boolean,  // æ˜¯å¦éœ€è¦æ·±åº¦åˆ†æèµ„æº
  "needsVerification": boolean,      // æ˜¯å¦éœ€è¦éªŒè¯
  "focus": string,                    // åˆ†æé‡ç‚¹
  "depth": "shallow|deep",           // åˆ†ææ·±åº¦
  "model": "grok|chatgpt"            // æ¨èä½¿ç”¨çš„æ¨¡å‹
}
`,
          },
        ],
        temperature: 0.1,
      }),
    });

    const result = await response.json();
    return JSON.parse(result.choices[0].message.content);
  }
}
```

```typescript
// frontend/lib/ai-agents/resource-analysis.agent.ts (ğŸ†• æ–°å¢æ–‡ä»¶)

interface ResourceAnalysis {
  insights: string[];
  findings: Array<{ claim: string; evidence: string; source: string }>;
  visualOpportunities: Array<{ type: string; description: string }>;
  confidence: number;
}

export class ResourceAnalysisAgent {
  constructor(private model: string) {}

  async analyze(input: {
    resources: Resource[];
    focus?: string;
    analysisDepth: "shallow" | "deep";
  }): Promise<ResourceAnalysis> {
    const prompt = this.buildPrompt(input.resources, input.focus);

    const response = await fetch("/api/ai/grok", {
      method: "POST",
      body: JSON.stringify({
        model: "grok-2",
        messages: [
          {
            role: "system",
            content:
              "ä½ æ˜¯ç§‘ç ”æ–‡çŒ®åˆ†æä¸“å®¶ã€‚æ·±åº¦åˆ†æå­¦æœ¯è®ºæ–‡å’ŒæŠ€æœ¯æ–‡æ¡£ï¼Œæå–æ ¸å¿ƒè§‚ç‚¹ã€å…³é”®æ•°æ®å’Œç ”ç©¶æ–¹æ³•ã€‚",
          },
          {
            role: "user",
            content: prompt,
          },
        ],
        temperature: 0.3,
        max_tokens: 4000,
      }),
    });

    const result = await response.json();
    return JSON.parse(result.choices[0].message.content);
  }

  private buildPrompt(resources: Resource[], focus?: string): string {
    return `
åˆ†æä»¥ä¸‹${resources.length}ç¯‡å­¦æœ¯/æŠ€æœ¯èµ„æºï¼Œæå–å…³é”®ä¿¡æ¯ï¼š

${resources
  .map(
    (r, i) => `
èµ„æº${i + 1}: ${r.title}
ç±»å‹: ${r.type}
æ‘˜è¦: ${r.abstract || ""}
${r.content ? `å†…å®¹: ${r.content.substring(0, 500)}...` : ""}
`,
  )
  .join("\n---\n")}

${focus ? `åˆ†æé‡ç‚¹: ${focus}` : ""}

è¯·ä»¥JSONæ ¼å¼è¿”å›ï¼š
{
  "insights": ["æ ¸å¿ƒè§‚ç‚¹1", "æ ¸å¿ƒè§‚ç‚¹2"],
  "findings": [{
    "claim": "å…³é”®å‘ç°",
    "evidence": "æ”¯æŒè¯æ®",
    "source": "èµ„æºæ ‡é¢˜"
  }],
  "visualOpportunities": [{
    "type": "flow|chart|matrix",
    "description": "å¯è§†åŒ–æè¿°"
  }],
  "confidence": 0.95
}
`;
  }
}
```

```typescript
// frontend/lib/ai-agents/verification.agent.ts (ğŸ†• æ–°å¢æ–‡ä»¶)

interface VerificationResult {
  confidence: number;
  badges: Array<{
    section: string;
    status: "verified" | "uncertain" | "unsupported";
  }>;
  suggestions: string[];
}

export class VerificationAgent {
  constructor(private model: string) {}

  async verify(input: {
    content: string;
    sources: Resource[];
  }): Promise<VerificationResult> {
    const response = await fetch("/api/ai/grok", {
      method: "POST",
      body: JSON.stringify({
        model: "grok-2",
        messages: [
          {
            role: "system",
            content:
              "ä½ æ˜¯äº‹å®éªŒè¯ä¸“å®¶ã€‚äº¤å‰æ£€æŸ¥å†…å®¹ä¸èµ„æºçš„ä¸€è‡´æ€§ï¼Œæ ‡æ³¨ç½®ä¿¡åº¦ã€‚",
          },
          {
            role: "user",
            content: `
ç”Ÿæˆçš„å†…å®¹:
${content}

å‚è€ƒèµ„æº:
${input.sources.map((r) => `- ${r.title}: ${r.abstract}`).join("\n")}

éªŒè¯å†…å®¹çš„å‡†ç¡®æ€§ï¼Œè¿”å›JSON:
{
  "confidence": 0.0-1.0,
  "badges": [{"section": "ç¬¬1é¡µ", "status": "verified"}],
  "suggestions": ["å»ºè®®1"]
}
`,
          },
        ],
        temperature: 0.1,
      }),
    });

    const result = await response.json();
    return JSON.parse(result.choices[0].message.content);
  }
}
```

#### 4.2.3 å…³é”®è®¾è®¡å†³ç­–

| å†³ç­–ç‚¹        | é€‰æ‹©                | ç†ç”±                     |
| ------------- | ------------------- | ------------------------ |
| **Agentä½ç½®** | Frontend API Route  | é¿å…åç«¯é‡æ„ï¼Œä¿æŒè½»é‡çº§ |
| **Agentå½¢å¼** | å·¥å…·å‡½æ•°ç±»          | ä¸æ˜¯ç‹¬ç«‹æœåŠ¡ï¼Œæ˜“äºé›†æˆ   |
| **æµç¨‹é›†æˆ**  | Pre/Post-processing | ä¸ä¿®æ”¹ç°æœ‰æ ¸å¿ƒé€»è¾‘       |
| **æ¨¡å‹è°ƒç”¨**  | ç›´æ¥è°ƒç”¨AI API      | æ— éœ€é¢å¤–çš„æœåŠ¡å±‚         |
| **çŠ¶æ€ç®¡ç†**  | æ— çŠ¶æ€              | æ¯æ¬¡è¯·æ±‚ç‹¬ç«‹ï¼Œç®€åŒ–å®ç°   |
| **æ¸è¿›å¢å¼º**  | agentModeå‚æ•°æ§åˆ¶   | å¯é€‰å¯ç”¨ï¼Œå‘åå…¼å®¹       |

#### 4.2.4 å¯ç”¨/ç¦ç”¨Multi-Agent

```typescript
// åœ¨ChatPanelä¸­æ§åˆ¶
const handleSend = async () => {
  const response = await fetch("/api/ai-office/chat", {
    method: "POST",
    body: JSON.stringify({
      message: userInput,
      resources: selectedResources,
      agentMode: useMultiAgent ? "enhanced" : "basic", // ğŸ†• å¼€å…³
    }),
  });
};
```

**ä¼˜åŠ¿**:

1. âœ… **æ— éœ€é‡æ„**: ç°æœ‰ChatPanelé€»è¾‘100%ä¿ç•™
2. âœ… **æ˜“äºå®ç°**: Agentæ˜¯ç®€å•çš„å·¥å…·å‡½æ•°ï¼Œä¸æ˜¯å¤æ‚çš„æœåŠ¡
3. âœ… **æ¸è¿›å¢å¼º**: å¯ä»¥é€æ­¥æ·»åŠ AgentåŠŸèƒ½
4. âœ… **å‘åå…¼å®¹**: agentMode='basic'æ—¶ä½¿ç”¨åŸæœ‰æµç¨‹
5. âœ… **æ˜“äºæµ‹è¯•**: å¯ä»¥å•ç‹¬æµ‹è¯•æ¯ä¸ªAgentå‡½æ•°

### 4.3 æ•°æ®åº“è®¾è®¡ï¼ˆåŸºäºç°æœ‰æ¶æ„ä¼˜åŒ–ï¼‰

**PostgreSQL Schemaæ›´æ–°ï¼š**

```prisma
// prisma/schema.prisma

model Resource {
  id              String       @id @default(uuid())
  type            ResourceType
  title           String
  abstract        String?
  content         String?
  sourceUrl       String
  pdfUrl          String?
  authors         Json?
  organizations   Json?
  publishedAt     DateTime?

  // AIå¢å¼ºå­—æ®µ
  aiSummary       String?
  keyInsights     Json?
  difficultyLevel Int?
  categories      Json?
  tags            Json?
  autoTags        Json?
  qualityScore    Decimal?
  trendingScore   Decimal?

  // å…³è”
  rawDataId       String?      // MongoDBå¼•ç”¨

  // æ–°å¢ï¼šæ¨èç›¸å…³
  recommendations ResourceRecommendation[]

  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt

  @@index([type])
  @@index([qualityScore])
  @@index([createdAt])
}

// æ–°å¢ï¼šèµ„æºæ¨èè®°å½•
model ResourceRecommendation {
  id           String   @id @default(uuid())
  resourceId   String
  resource     Resource @relation(fields: [resourceId], references: [id])

  score        Decimal  // ç›¸å…³åº¦åˆ†æ•°
  reason       String   // æ¨èç†ç”±
  basedOn      String   // 'url-detection' | 'content-similarity' | 'user-history'

  status       String   // 'pending' | 'accepted' | 'rejected'

  userId       String?
  documentId   String?

  createdAt    DateTime @default(now())

  @@index([resourceId])
  @@index([status])
}

// æ–‡æ¡£è¡¨ï¼ˆæ‰©å±•ï¼‰
model Document {
  id            String       @id @default(uuid())
  type          DocumentType // 'ppt' | 'doc' | 'research-page'
  title         String

  // å†…å®¹ï¼ˆå­˜å‚¨åœ¨MongoDBï¼‰
  contentId     String       // MongoDB _id

  // æ¨¡æ¿
  templateId    String?
  template      Template?    @relation(fields: [templateId], references: [id])

  // ç‰ˆæœ¬ç®¡ç†
  currentVersion String      @default("v1.0")
  versions      DocumentVersion[]

  // å…ƒæ•°æ®
  metadata      Json         // å„ç§ç»Ÿè®¡ä¿¡æ¯

  userId        String

  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt

  @@index([userId])
  @@index([type])
}

// æ–‡æ¡£ç‰ˆæœ¬
model DocumentVersion {
  id           String    @id @default(uuid())
  documentId   String
  document     Document  @relation(fields: [documentId], references: [id])

  version      String    // 'v1.0', 'v1.1', 'v2.0'

  // å¿«ç…§ï¼ˆå­˜å‚¨åœ¨MongoDBï¼‰
  snapshotId   String    // MongoDB _id

  // å˜æ›´è®°å½•
  changes      Json      // { type, section, description, diff }

  author       String    // 'user' | 'ai' | userId
  message      String    // ç‰ˆæœ¬æäº¤ä¿¡æ¯

  parentVersion String?  // çˆ¶ç‰ˆæœ¬ID

  createdAt    DateTime  @default(now())

  @@index([documentId])
  @@index([version])
}

// æ¨¡æ¿è¡¨
model Template {
  id          String     @id @default(uuid())
  name        String
  description String?
  category    String     // 'academic' | 'tech' | 'business' | 'custom'
  type        String     // 'ppt' | 'doc'

  // æ¨¡æ¿å®šä¹‰ï¼ˆå­˜å‚¨åœ¨MongoDBï¼‰
  definitionId String    // MongoDB _id

  // é¢„è§ˆ
  thumbnailUrl String?

  // ç»Ÿè®¡
  downloadCount Int      @default(0)
  rating       Decimal?

  // ä½œè€…
  authorId     String    // 'system' | userId
  isPublic     Boolean   @default(false)

  documents    Document[]

  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  @@index([category])
  @@index([type])
  @@index([isPublic])
}

enum DocumentType {
  PPT
  DOC
  RESEARCH_PAGE
}
```

**MongoDB Collections:**

```javascript
// MongoDB: document_contents
{
  _id: ObjectId("..."),
  documentId: "uuid",  // å…³è”PostgreSQL
  type: "ppt" | "doc" | "research-page",

  // PPTå†…å®¹
  slides: [
    {
      id: "slide-1",
      order: 1,
      layout: "title",
      elements: {
        title: { text: "...", style: {...} },
        content: {...},
        visuals: [...]
      },
      version: "v2.1",
      lastModified: ISODate("..."),
      modifiedBy: "user"
    }
  ],

  // æˆ–Docå†…å®¹
  chapters: [
    {
      id: "chapter-1",
      order: 1,
      level: 1,
      title: "Introduction",
      content: {
        markdown: "...",
        html: "..."
      },
      elements: {...},
      version: "v1.5",
      lastModified: ISODate("...")
    }
  ],

  // æˆ–Research Pageå†…å®¹
  sections: {
    summary: {...},
    keyFindings: [...],
    visualInsights: {...},
    deepDive: {...},
    actionableInsights: {...}
  },

  createdAt: ISODate("..."),
  updatedAt: ISODate("...")
}

// MongoDB: document_versions
{
  _id: ObjectId("..."),
  versionId: "uuid",  // å…³è”PostgreSQL
  documentId: "uuid",
  version: "v2.1",

  snapshot: {
    // å®Œæ•´çš„æ–‡æ¡£å¿«ç…§
    slides: [...] // æˆ– chapters: [...] æˆ– sections: {...}
  },

  thumbnails: {
    "slide-1": "base64...",
    "slide-2": "base64..."
  },

  createdAt: ISODate("...")
}

// MongoDB: templates
{
  _id: ObjectId("..."),
  templateId: "uuid",  // å…³è”PostgreSQL

  metadata: {
    name: "Academic Conference Presentation",
    category: "academic",
    type: "ppt"
  },

  structure: {
    slides: [
      {
        layout: "title",
        required: true,
        fields: [...]
      },
      ...
    ]
  },

  style: {
    colors: {...},
    fonts: {...},
    layout: {...}
  },

  aiPrompts: {
    "background": "ç”Ÿæˆå­¦æœ¯èƒŒæ™¯ä»‹ç»...",
    "methods": "æ€»ç»“ç ”ç©¶æ–¹æ³•...",
    ...
  },

  createdAt: ISODate("...")
}
```

### 4.4 APIè®¾è®¡

**æ ¸å¿ƒAPIç«¯ç‚¹ï¼š**

```typescript
// èµ„æºç®¡ç†API
POST   /api/resources/recommend           // æ™ºèƒ½æ¨èèµ„æº
GET    /api/resources/recommendations     // è·å–æ¨èåˆ—è¡¨
POST   /api/resources/import              // å¯¼å…¥èµ„æºï¼ˆç”¨æˆ·å†³ç­–åï¼‰
GET    /api/resources/:id                 // è·å–èµ„æºè¯¦æƒ…

// Multi-Agentæ–‡æ¡£ç”ŸæˆAPI
POST   /api/documents/generate             // ç”Ÿæˆæ–‡æ¡£
GET    /api/documents/:id/stream           // SSEæµå¼ç”Ÿæˆ
POST   /api/documents/:id/enrich           // æŒç»­ä¸°å¯Œæ–‡æ¡£

// Research Page API
POST   /api/research-pages/generate        // ç”ŸæˆResearch Page
GET    /api/research-pages/:id/stream      // SSEæµå¼ç”Ÿæˆ

// æ–‡æ¡£ç¼–è¾‘API
GET    /api/documents/:id                  // è·å–æ–‡æ¡£
PATCH  /api/documents/:id/slides/:slideId  // ç¼–è¾‘ç‰¹å®šslide
PATCH  /api/documents/:id/chapters/:chapterId  // ç¼–è¾‘ç‰¹å®šç« èŠ‚
POST   /api/documents/:id/slides           // æ·»åŠ æ–°slide
DELETE /api/documents/:id/slides/:slideId  // åˆ é™¤slide

// ç‰ˆæœ¬ç®¡ç†API
GET    /api/documents/:id/versions         // è·å–ç‰ˆæœ¬åˆ—è¡¨
GET    /api/documents/:id/versions/:version // è·å–ç‰¹å®šç‰ˆæœ¬
POST   /api/documents/:id/versions         // åˆ›å»ºæ–°ç‰ˆæœ¬
POST   /api/documents/:id/rollback/:version // å›æ»šåˆ°æŸç‰ˆæœ¬

// æ¨¡æ¿API
GET    /api/templates                      // è·å–æ¨¡æ¿åˆ—è¡¨
GET    /api/templates/:id                  // è·å–æ¨¡æ¿è¯¦æƒ…
POST   /api/templates                      // åˆ›å»ºè‡ªå®šä¹‰æ¨¡æ¿
POST   /api/documents/:id/apply-template   // åº”ç”¨æ¨¡æ¿

// å¯¼å‡ºAPI
POST   /api/documents/:id/export/pptx      // å¯¼å‡ºPPTX
POST   /api/documents/:id/export/docx      // å¯¼å‡ºDOCX
POST   /api/documents/:id/export/pdf       // å¯¼å‡ºPDF
POST   /api/documents/:id/export/markdown  // å¯¼å‡ºMarkdown
POST   /api/documents/:id/export/html      // å¯¼å‡ºHTML
```

**SSEæµå¼ç”Ÿæˆç¤ºä¾‹ï¼š**

```typescript
// frontend/hooks/useDocumentGeneration.ts

export function useDocumentGeneration() {
  const [status, setStatus] = useState<"idle" | "generating" | "complete">(
    "idle",
  );
  const [progress, setProgress] = useState<GenerationProgress>({});

  const generateDocument = async (request: DocumentGenerationRequest) => {
    setStatus("generating");

    const eventSource = new EventSource(
      `/api/documents/generate/stream?${new URLSearchParams(request)}`,
    );

    eventSource.addEventListener("phase", (e) => {
      const data = JSON.parse(e.data);
      setProgress((prev) => ({
        ...prev,
        currentPhase: data.phase,
        currentAgent: data.agent,
      }));
    });

    eventSource.addEventListener("section-start", (e) => {
      const { sectionName } = JSON.parse(e.data);
      setProgress((prev) => ({
        ...prev,
        sections: {
          ...prev.sections,
          [sectionName]: { status: "generating", content: "" },
        },
      }));
    });

    eventSource.addEventListener("section-chunk", (e) => {
      const { sectionName, chunk } = JSON.parse(e.data);
      setProgress((prev) => ({
        ...prev,
        sections: {
          ...prev.sections,
          [sectionName]: {
            ...prev.sections[sectionName],
            content: (prev.sections[sectionName].content || "") + chunk,
          },
        },
      }));
    });

    eventSource.addEventListener("complete", (e) => {
      const { documentId } = JSON.parse(e.data);
      setStatus("complete");
      eventSource.close();
      return documentId;
    });

    eventSource.addEventListener("error", (e) => {
      console.error("Generation error:", e);
      eventSource.close();
      setStatus("idle");
    });
  };

  return { generateDocument, status, progress };
}
```

---

## 5. ç”¨æˆ·ä½“éªŒæµç¨‹

### 5.1 æ ¸å¿ƒç”¨æˆ·æ—…ç¨‹

#### Journey 1: ä»èµ„æºåˆ°PPT

```
1. ç”¨æˆ·æ‰“å¼€AI Office
   â†“
2. ç²˜è´´arXivé“¾æ¥ (https://arxiv.org/abs/2301.12345)
   â†“
3. ç³»ç»Ÿæ˜¾ç¤ºæ¨èå¡ç‰‡ï¼š
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ğŸ“„ æ£€æµ‹åˆ° arXiv è®ºæ–‡             â”‚
   â”‚ Multistationarity in Phospho...  â”‚
   â”‚ ğŸ’¡ ç›¸å…³åº¦: 95%                   â”‚
   â”‚ [âœ“ æ·»åŠ ] [âœ• å¿½ç•¥]               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
4. ç”¨æˆ·ç‚¹å‡»"æ·»åŠ " â†’ èµ„æºå¯¼å…¥
   â†“
5. ç”¨æˆ·åœ¨Chaté¢æ¿è¾“å…¥ï¼š
   "å¸®æˆ‘ç”Ÿæˆä¸€ä¸ªå­¦æœ¯ä¼šè®®æ¼”è®²PPTï¼Œä¸»é¢˜æ˜¯ç£·é…¸åŒ–ç½‘ç»œçš„å¤šç¨³æ€ç‰¹æ€§"
   â†“
6. ç³»ç»Ÿæ˜¾ç¤ºæ¨¡æ¿é€‰æ‹©ï¼š
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ è¯·é€‰æ‹©æ¨¡æ¿ï¼š                     â”‚
   â”‚ â—‹ Academic Conference            â”‚
   â”‚ â—‹ Tech Talk                      â”‚
   â”‚ â—‹ è‡ªå®šä¹‰æ¨¡æ¿                     â”‚
   â”‚ [ç»§ç»­]                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
7. ç”¨æˆ·é€‰æ‹©"Academic Conference" â†’ ç‚¹å‡»ç»§ç»­
   â†“
8. Multi-Agentå¼€å§‹å·¥ä½œï¼ˆå®æ—¶è¿›åº¦æ˜¾ç¤ºï¼‰ï¼š

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ğŸ¤– æ­£åœ¨ç”Ÿæˆæ‚¨çš„æ¼”è®²PPT...         â”‚
   â”‚                                    â”‚
   â”‚ âœ… ä»»åŠ¡è§„åˆ’ (Grok)                â”‚
   â”‚    - è¯†åˆ«ä¸ºå­¦æœ¯æ¼”è®²                â”‚
   â”‚    - è§„åˆ’6ä¸ªslides                â”‚
   â”‚                                    â”‚
   â”‚ ğŸ”„ èµ„æºåˆ†æ (Grok) è¿›è¡Œä¸­...      â”‚
   â”‚    - æ­£åœ¨åˆ†æè®ºæ–‡æ ¸å¿ƒè§‚ç‚¹          â”‚
   â”‚    - æå–å…³é”®å®éªŒæ•°æ®              â”‚
   â”‚    [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 80%               â”‚
   â”‚                                    â”‚
   â”‚ â³ å†…å®¹ç”Ÿæˆ (ChatGPT) ç­‰å¾…ä¸­...   â”‚
   â”‚ â³ å¯è§†åŒ–è®¾è®¡ (ChatGPT) ç­‰å¾…ä¸­... â”‚
   â”‚ â³ éªŒè¯ (Grok) ç­‰å¾…ä¸­...          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   â†“ (3ç§’å)

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ğŸ¤– æ­£åœ¨ç”Ÿæˆæ‚¨çš„æ¼”è®²PPT...         â”‚
   â”‚                                    â”‚
   â”‚ âœ… ä»»åŠ¡è§„åˆ’ (Grok)                â”‚
   â”‚ âœ… èµ„æºåˆ†æ (Grok)                â”‚
   â”‚    - æå–äº†5ä¸ªæ ¸å¿ƒè§‚ç‚¹             â”‚
   â”‚    - è¯†åˆ«äº†3ä¸ªå¯è§†åŒ–æœºä¼š           â”‚
   â”‚                                    â”‚
   â”‚ ğŸ”„ å†…å®¹ç”Ÿæˆ (ChatGPT) è¿›è¡Œä¸­...   â”‚
   â”‚    âœ… Slide 1: æ ‡é¢˜é¡µ              â”‚
   â”‚    âœ… Slide 2: èƒŒæ™¯ä»‹ç»            â”‚
   â”‚    ğŸ”„ Slide 3: ç ”ç©¶æ–¹æ³•            â”‚
   â”‚    [â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] 40%               â”‚
   â”‚                                    â”‚
   â”‚ ğŸ”„ å¯è§†åŒ–è®¾è®¡ (ChatGPT) è¿›è¡Œä¸­... â”‚
   â”‚    âœ… æµç¨‹å›¾: ç£·é…¸åŒ–çº§è”ååº”       â”‚
   â”‚    ğŸ”„ æŸ±çŠ¶å›¾: å®éªŒæ•°æ®å¯¹æ¯”         â”‚
   â”‚    [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 60%               â”‚
   â”‚                                    â”‚
   â”‚ â³ éªŒè¯ (Grok) ç­‰å¾…ä¸­...          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   â†“ (10ç§’å)

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ âœ… PPTç”Ÿæˆå®Œæˆï¼                  â”‚
   â”‚                                    â”‚
   â”‚ ğŸ“Š 6 slides Â· 3 visualizations    â”‚
   â”‚ âœ… 95% å¹³å‡ç½®ä¿¡åº¦                 â”‚
   â”‚ â±ï¸ ç”¨æ—¶ 12 ç§’                     â”‚
   â”‚                                    â”‚
   â”‚ [æŸ¥çœ‹PPT] [é‡æ–°ç”Ÿæˆ]              â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   â†“
9. ç”¨æˆ·ç‚¹å‡»"æŸ¥çœ‹PPT" â†’ è¿›å…¥ç¼–è¾‘å™¨

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ç£·é…¸åŒ–ç½‘ç»œçš„å¤šç¨³æ€ç‰¹æ€§ (v1.0)              â”‚
   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
   â”‚ â”‚ [Slide Thumbnails]                      â”‚ â”‚
   â”‚ â”‚ [1] [2] [3] [4] [5] [6]                 â”‚ â”‚
   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
   â”‚                                             â”‚
   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
   â”‚ â”‚ [å½“å‰Slide 1é¢„è§ˆ]                       â”‚ â”‚
   â”‚ â”‚                                         â”‚ â”‚
   â”‚ â”‚  ç£·é…¸åŒ–ç½‘ç»œçš„å¤šç¨³æ€ç‰¹æ€§                 â”‚ â”‚
   â”‚ â”‚  Multistationarity in Phospho Networks â”‚ â”‚
   â”‚ â”‚                                         â”‚ â”‚
   â”‚ â”‚  æ‚¨çš„åå­—                               â”‚ â”‚
   â”‚ â”‚  æœºæ„åç§°                               â”‚ â”‚
   â”‚ â”‚  2025-11-17                            â”‚ â”‚
   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
   â”‚                                             â”‚
   â”‚ [ç¼–è¾‘] [æ¼”ç¤ºæ¨¡å¼] [å¯¼å‡º] [ç‰ˆæœ¬å†å²]        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   â†“
10. ç”¨æˆ·ç‚¹å‡»Slide 3ç¼©ç•¥å›¾ â†’ æŸ¥çœ‹å¹¶ç¼–è¾‘

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ç¼–è¾‘ Slide 3: ç ”ç©¶æ–¹æ³•                  â”‚
    â”‚                                         â”‚
    â”‚ [æµç¨‹å›¾æ˜¾ç¤º]                            â”‚
    â”‚ â”Œâ”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”     â”‚
    â”‚ â”‚æ¿€é…¶ â”‚  â†’  â”‚åº•ç‰© â”‚  â†’  â”‚ç£·é…¸åŒ–â”‚     â”‚
    â”‚ â””â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”˜     â”‚
    â”‚                                         â”‚
    â”‚ ç”¨æˆ·æ“ä½œï¼š                              â”‚
    â”‚ â—‹ é‡æ–°ç”Ÿæˆæ­¤slide                      â”‚
    â”‚   æç¤ºè¯: "æ·»åŠ æ›´å¤šå®éªŒç»†èŠ‚"            â”‚
    â”‚   [ç”Ÿæˆ]                                â”‚
    â”‚                                         â”‚
    â”‚ â—‹ æ‰‹åŠ¨ç¼–è¾‘                             â”‚
    â”‚   [ç¼–è¾‘æ ‡é¢˜] [ç¼–è¾‘å†…å®¹] [ç¼–è¾‘å›¾è¡¨]     â”‚
    â”‚                                         â”‚
    â”‚ [ä¿å­˜ä¸ºv1.1] [å–æ¶ˆ]                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â†“
11. ç”¨æˆ·ç‚¹å‡»"é‡æ–°ç”Ÿæˆ" â†’ AI (ChatGPT)é‡æ–°ç”ŸæˆSlide 3

    â†“
12. ç”Ÿæˆå®Œæˆ â†’ ä¿å­˜ä¸ºv1.1

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ âœ… Slide 3 å·²æ›´æ–° (v1.1)               â”‚
    â”‚                                         â”‚
    â”‚ å˜æ›´ï¼š                                  â”‚
    â”‚ â€¢ æ·»åŠ äº†å®éªŒç»†èŠ‚æè¿°                    â”‚
    â”‚ â€¢ æ›´æ–°äº†æµç¨‹å›¾å¸ƒå±€                      â”‚
    â”‚                                         â”‚
    â”‚ [æŸ¥çœ‹å¯¹æ¯”] [ä¿å­˜] [æ’¤é”€]                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â†“
13. ç”¨æˆ·æ»¡æ„ â†’ ç‚¹å‡»"å¯¼å‡º" â†’ é€‰æ‹©PPTX

    â†“
14. ä¸‹è½½PPTæ–‡ä»¶ â†’ å®Œæˆï¼
```

#### Journey 2: æŒç»­è¿­ä»£æŠ¥å‘Š

```
1. ç”¨æˆ·æœ‰ä¸€ä¸ªå·²å­˜åœ¨çš„Research Page (v1.0)
   - åŸºäº3ç¯‡è®ºæ–‡ç”Ÿæˆ

   â†“
2. ä¸€å‘¨åï¼Œç”¨æˆ·å‘ç°æ–°è®ºæ–‡
   - ç²˜è´´æ–°è®ºæ–‡URL

   â†“
3. ç³»ç»Ÿæ¨èï¼š
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ğŸ’¡ æ£€æµ‹åˆ°å¯ä»¥ä¸°å¯Œæ‚¨çš„æ–‡æ¡£ï¼š          â”‚
   â”‚ "ç£·é…¸åŒ–ç½‘ç»œç ”ç©¶æŠ¥å‘Š v1.0"            â”‚
   â”‚                                      â”‚
   â”‚ æ–°èµ„æº: "Advanced Phospho Study"     â”‚
   â”‚ ç›¸å…³åº¦: 93%                          â”‚
   â”‚                                      â”‚
   â”‚ å»ºè®®æ›´æ–°ï¼š                           â”‚
   â”‚ â€¢ Chapter 2: æ·»åŠ æœ€æ–°ç ”ç©¶è¿›å±•        â”‚
   â”‚ â€¢ Chapter 4: æ›´æ–°å®éªŒæ–¹æ³•            â”‚
   â”‚                                      â”‚
   â”‚ [è‡ªåŠ¨ä¸°å¯Œ] [æ‰‹åŠ¨é€‰æ‹©] [å¿½ç•¥]         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   â†“
4. ç”¨æˆ·ç‚¹å‡»"è‡ªåŠ¨ä¸°å¯Œ"

   â†“
5. AI (Grok)åˆ†ææ–°è®ºæ–‡ï¼ŒAI (ChatGPT)æ•´åˆå†…å®¹

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ğŸ”„ æ­£åœ¨ä¸°å¯Œæ–‡æ¡£...                   â”‚
   â”‚                                      â”‚
   â”‚ âœ… åˆ†ææ–°èµ„æº (Grok)                 â”‚
   â”‚ ğŸ”„ æ•´åˆåˆ°Chapter 2 (ChatGPT)         â”‚
   â”‚ â³ æ•´åˆåˆ°Chapter 4 (ChatGPT)         â”‚
   â”‚                                      â”‚
   â”‚ [è¿›åº¦: 60%]                          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   â†“
6. å®Œæˆåæ˜¾ç¤ºDiffå¯¹æ¯”

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ç‰ˆæœ¬å¯¹æ¯”: v1.0 â†’ v1.1                â”‚
   â”‚                                      â”‚
   â”‚ Chapter 2: Background                â”‚
   â”‚ + æ·»åŠ äº†æœ€æ–°ç ”ç©¶è¿›å±• (3æ®µ)           â”‚
   â”‚ ~ æ›´æ–°äº†å¼•ç”¨åˆ—è¡¨ (æ–°å¢5ç¯‡)           â”‚
   â”‚                                      â”‚
   â”‚ Chapter 4: Methodology               â”‚
   â”‚ + æ·»åŠ äº†æ–°å®éªŒæ–¹æ³• (2æ®µ)             â”‚
   â”‚                                      â”‚
   â”‚ [æ¥å—æ›´æ–°] [æŸ¥çœ‹è¯¦æƒ…] [æ’¤é”€]         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   â†“
7. ç”¨æˆ·ç‚¹å‡»"æ¥å—æ›´æ–°" â†’ ä¿å­˜ä¸ºv1.1

   â†“
8. 2å‘¨åï¼Œç”¨æˆ·åˆæ·»åŠ 2ç¯‡æ–°è®ºæ–‡
   - é‡å¤ä¸Šè¿°æµç¨‹ â†’ ç”Ÿæˆv1.2

   â†“
9. ä¸€ä¸ªæœˆåï¼Œç”¨æˆ·éœ€è¦æ¼”è®²PPT
   - ç‚¹å‡»"ç”ŸæˆPPT"
   - åŸºäºv1.2çš„å†…å®¹ç”ŸæˆPPT

   â†“
10. ç”ŸæˆPPT â†’ ç”¨æˆ·ç¼–è¾‘ä¸ªåˆ«slides â†’ ä¿å­˜ä¸ºPPT v1.0

    â†“
11. å¯¼å‡ºPPTX â†’ ç”¨äºä¼šè®®æ¼”è®²
```

### 5.2 å…³é”®äº¤äº’æ¨¡å¼

#### äº¤äº’æ¨¡å¼1: æ™ºèƒ½èµ„æºæ¨è

```tsx
// frontend/components/ai-office/resources/ResourceRecommendation.tsx

export function ResourceRecommendation({ url, onAccept, onReject }: Props) {
  const { recommendation, loading } = useResourceRecommendation(url);

  if (loading) {
    return (
      <Card>
        <Spinner /> æ­£åœ¨åˆ†æèµ„æº...
      </Card>
    );
  }

  return (
    <Card className="resource-recommendation">
      <CardHeader>
        <Icon type={recommendation.type} />
        <Badge>æ£€æµ‹åˆ° {getResourceTypeLabel(recommendation.type)}</Badge>
      </CardHeader>

      <CardBody>
        <h3>{recommendation.metadata.title}</h3>
        {recommendation.metadata.authors && (
          <Authors>{recommendation.metadata.authors.join(", ")}</Authors>
        )}
        <Abstract>{recommendation.metadata.abstract}</Abstract>

        <RelevanceScore score={recommendation.recommendation.score}>
          ğŸ’¡ ç›¸å…³åº¦: {(recommendation.recommendation.score * 100).toFixed(0)}%
        </RelevanceScore>

        <Reason>{recommendation.recommendation.reason}</Reason>
      </CardBody>

      <CardActions>
        <Button onClick={() => onAccept(recommendation)}>âœ“ æ·»åŠ åˆ°èµ„æºåº“</Button>
        <Button variant="ghost" onClick={() => onReject(recommendation)}>
          âœ• å¿½ç•¥
        </Button>
      </CardActions>
    </Card>
  );
}
```

#### äº¤äº’æ¨¡å¼2: å®æ—¶ç”Ÿæˆè¿›åº¦

```tsx
// frontend/components/ai-office/document/GenerationProgress.tsx

export function GenerationProgress({ progress }: Props) {
  return (
    <ProgressPanel>
      <Title>ğŸ¤– æ­£åœ¨ç”Ÿæˆæ‚¨çš„{progress.documentType}...</Title>

      {/* Phaseåˆ—è¡¨ */}
      <PhaseList>
        {PHASES.map((phase) => (
          <PhaseItem
            key={phase}
            status={getPhaseStatus(phase, progress)}
            current={progress.currentPhase === phase}
          >
            {getPhaseStatus(phase, progress) === "complete" && "âœ…"}
            {getPhaseStatus(phase, progress) === "in-progress" && "ğŸ”„"}
            {getPhaseStatus(phase, progress) === "pending" && "â³"}

            <PhaseLabel>{getPhaseLabel(phase)}</PhaseLabel>

            {progress.currentPhase === phase && progress.currentAgent && (
              <AgentBadge>{progress.currentAgent}</AgentBadge>
            )}

            {/* è¯¦ç»†è¿›åº¦ */}
            {progress.currentPhase === phase && progress.details && (
              <PhaseDetails>
                {progress.details.map((detail) => (
                  <DetailItem key={detail}>
                    {detail.status === "complete" && "âœ…"}
                    {detail.status === "in-progress" && "ğŸ”„"}
                    {detail.text}
                  </DetailItem>
                ))}

                {progress.percentage && (
                  <ProgressBar value={progress.percentage} />
                )}
              </PhaseDetails>
            )}
          </PhaseItem>
        ))}
      </PhaseList>

      {/* å®ŒæˆçŠ¶æ€ */}
      {progress.status === "complete" && (
        <CompletionCard>
          <SuccessIcon>âœ…</SuccessIcon>
          <h3>{progress.documentType}ç”Ÿæˆå®Œæˆï¼</h3>
          <Stats>
            <Stat>
              <StatIcon>ğŸ“Š</StatIcon>
              <StatValue>
                {progress.stats.slideCount || progress.stats.chapterCount}
              </StatValue>
              <StatLabel>
                {progress.documentType === "ppt" ? "slides" : "chapters"}
              </StatLabel>
            </Stat>
            <Stat>
              <StatIcon>âœ…</StatIcon>
              <StatValue>{progress.stats.confidence}%</StatValue>
              <StatLabel>å¹³å‡ç½®ä¿¡åº¦</StatLabel>
            </Stat>
            <Stat>
              <StatIcon>â±ï¸</StatIcon>
              <StatValue>{progress.stats.duration}s</StatValue>
              <StatLabel>ç”¨æ—¶</StatLabel>
            </Stat>
          </Stats>

          <Actions>
            <Button primary onClick={progress.onView}>
              æŸ¥çœ‹{progress.documentType}
            </Button>
            <Button onClick={progress.onRegenerate}>é‡æ–°ç”Ÿæˆ</Button>
          </Actions>
        </CompletionCard>
      )}
    </ProgressPanel>
  );
}
```

#### äº¤äº’æ¨¡å¼3: ç‰ˆæœ¬å¯¹æ¯”

```tsx
// frontend/components/ai-office/document/VersionComparison.tsx

export function VersionComparison({
  documentId,
  oldVersion,
  newVersion,
}: Props) {
  const { comparison, loading } = useVersionComparison(
    documentId,
    oldVersion,
    newVersion,
  );

  if (loading) return <Spinner />;

  return (
    <ComparisonView>
      <Header>
        <h2>
          ç‰ˆæœ¬å¯¹æ¯”: {oldVersion} â†’ {newVersion}
        </h2>
        <CloseButton onClick={onClose} />
      </Header>

      <Summary>
        <SummaryCard type="added">
          <Icon>+</Icon>
          <Count>{comparison.stats.added}</Count>
          <Label>æ–°å¢</Label>
        </SummaryCard>

        <SummaryCard type="modified">
          <Icon>~</Icon>
          <Count>{comparison.stats.modified}</Count>
          <Label>ä¿®æ”¹</Label>
        </SummaryCard>

        <SummaryCard type="deleted">
          <Icon>-</Icon>
          <Count>{comparison.stats.deleted}</Count>
          <Label>åˆ é™¤</Label>
        </SummaryCard>
      </Summary>

      <DiffList>
        {comparison.changes.map((change) => (
          <DiffItem key={change.id} type={change.type}>
            <DiffHeader>
              <ChangeIcon type={change.type} />
              <SectionName>{change.section}</SectionName>
              <ChangeType>{getChangeTypeLabel(change.type)}</ChangeType>
            </DiffHeader>

            {change.type === "modified" && (
              <SideBySide>
                <OldVersion>
                  <Label>æ—§ç‰ˆæœ¬ ({oldVersion})</Label>
                  <Content>{change.oldContent}</Content>
                </OldVersion>

                <NewVersion>
                  <Label>æ–°ç‰ˆæœ¬ ({newVersion})</Label>
                  <Content>
                    <Diff
                      oldText={change.oldContent}
                      newText={change.newContent}
                    />
                  </Content>
                </NewVersion>
              </SideBySide>
            )}

            {change.type === "added" && (
              <AddedContent>
                <Content>{change.newContent}</Content>
              </AddedContent>
            )}

            {change.type === "deleted" && (
              <DeletedContent>
                <Content>{change.oldContent}</Content>
              </DeletedContent>
            )}
          </DiffItem>
        ))}
      </DiffList>

      <Actions>
        <Button primary onClick={() => onAccept(newVersion)}>
          âœ“ æ¥å—æ›´æ–°
        </Button>
        <Button onClick={() => onReject()}>âœ• æ’¤é”€</Button>
        <Button variant="ghost" onClick={() => onViewDetails()}>
          æŸ¥çœ‹è¯¦æƒ…
        </Button>
      </Actions>
    </ComparisonView>
  );
}
```

---

## 6. æ•°æ®æ¨¡å‹è®¾è®¡

ï¼ˆå·²åœ¨4.3èŠ‚è¯¦ç»†è¯´æ˜ï¼Œè¿™é‡Œè¡¥å……å…³é”®ç±»å‹å®šä¹‰ï¼‰

```typescript
// frontend/types/ai-office-v2.ts

// æ–‡æ¡£ç”Ÿæˆè¯·æ±‚
export interface DocumentGenerationRequest {
  type: "ppt" | "doc" | "research-page";
  resources: string[]; // resource IDs
  template?: string; // template ID
  prompt: string;
  focus?: string; // åˆ†æé‡ç‚¹
  style?: "academic" | "tech" | "business";
}

// æ–‡æ¡£ç”Ÿæˆè¿›åº¦
export interface GenerationProgress {
  status: "idle" | "generating" | "complete" | "error";
  documentType: "ppt" | "doc" | "research-page";

  currentPhase:
    | "planning"
    | "analyzing"
    | "generating"
    | "verifying"
    | "synthesizing";
  currentAgent?: "grok" | "chatgpt";

  details: Array<{
    text: string;
    status: "pending" | "in-progress" | "complete";
  }>;

  percentage?: number;

  stats?: {
    slideCount?: number;
    chapterCount?: number;
    confidence: number;
    duration: number;
  };
}

// ç‰ˆæœ¬å¯¹æ¯”ç»“æœ
export interface VersionComparison {
  documentId: string;
  oldVersion: string;
  newVersion: string;

  stats: {
    added: number;
    modified: number;
    deleted: number;
  };

  changes: Array<{
    id: string;
    type: "added" | "modified" | "deleted";
    section: string; // slide ID or chapter ID
    oldContent?: string;
    newContent?: string;
    diff?: DiffResult;
  }>;
}

// æ¨¡æ¿å®šä¹‰
export interface Template {
  id: string;
  name: string;
  description: string;
  category: "academic" | "tech" | "business" | "custom";
  type: "ppt" | "doc";

  structure: {
    slides?: SlideTemplate[];
    chapters?: ChapterTemplate[];
  };

  style: {
    colors: ColorScheme;
    fonts: FontScheme;
    layout: LayoutConfig;
  };

  aiPrompts: Record<string, string>;

  metadata: {
    author: string;
    downloads: number;
    rating: number;
    isPublic: boolean;
  };
}

export interface SlideTemplate {
  layout: "title" | "content" | "two-column" | "visual" | "blank";
  required: boolean;
  fields: Array<{
    name: string;
    type: "text" | "bullets" | "image" | "chart" | "diagram" | "code";
    placeholder?: string;
  }>;
  visual?: "flow" | "chart" | "diagram" | "image";
}

export interface ChapterTemplate {
  level: 1 | 2 | 3 | 4;
  required: boolean;
  title: string;
  subsections?: string[];
  wordCount?: { min: number; max: number };
  includesDiagrams?: boolean;
}
```

---

## 7. UI/UXè®¾è®¡è§„èŒƒï¼ˆåŸºäºç°æœ‰å®ç°ï¼‰

> **è¯´æ˜**: æœ¬èŠ‚æè¿°å½“å‰AI Officeçš„å®é™…UIé£æ ¼å’Œè®¾è®¡æ¨¡å¼ï¼Œæ‰€æœ‰2.0æ–°å¢ç»„ä»¶åº”éµå¾ªæ­¤è§„èŒƒä»¥ä¿æŒä¸€è‡´æ€§ã€‚

### 7.1 è®¾è®¡åŸåˆ™

1. **ç®€æ´ç°ä»£** - ä½¿ç”¨Tailwind CSSï¼Œä¿æŒç•Œé¢å¹²å‡€æ¸…çˆ½
2. **æ¸è¿›å¼æŠ«éœ²** - å¤æ‚åŠŸèƒ½éšè—åœ¨é«˜çº§é€‰é¡¹ä¸­ï¼Œé»˜è®¤ç®€æ´
3. **å³æ—¶åé¦ˆ** - æ“ä½œç«‹å³å“åº”ï¼ŒçŠ¶æ€åŠæ—¶æ›´æ–°ï¼ˆtransition-colorsï¼‰
4. **å¯æ¢å¤æ€§** - æ‰€æœ‰é‡è¦æ“ä½œå¯æ’¤é”€/å›æ»šï¼ˆç‰ˆæœ¬ç®¡ç†ï¼‰
5. **æµç•…äº¤äº’** - ä½¿ç”¨hover/focusçŠ¶æ€ï¼Œæä¾›æ¸…æ™°çš„è§†è§‰åé¦ˆ

### 7.2 è‰²å½©ç³»ç»Ÿï¼ˆå½“å‰å®ç°ï¼‰

**åŸºäº Tailwind CSS + AlphaXiv é…è‰²**

```typescript
// frontend/tailwind.config.ts
export const CURRENT_THEME = {
  // ä¸»è‰²ç³»ï¼ˆè“è‰²ï¼‰
  primary: {
    DEFAULT: "#3b82f6", // blue-500
    hover: "#2563eb", // blue-600
    active: "#1d4ed8", // blue-700
    light: "#60a5fa", // blue-400
    lightest: "#dbeafe", // blue-100
  },

  // èƒŒæ™¯è‰²
  background: {
    primary: "#ffffff", // white
    secondary: "#f9fafb", // gray-50
    tertiary: "#f3f4f6", // gray-100
  },

  // è¾¹æ¡†è‰²
  border: {
    light: "#f3f4f6", // gray-100
    DEFAULT: "#e5e7eb", // gray-200
    dark: "#d1d5db", // gray-300
  },

  // æ–‡å­—è‰²
  text: {
    primary: "#111827", // gray-900
    secondary: "#6b7280", // gray-600
    tertiary: "#9ca3af", // gray-500
    disabled: "#d1d5db", // gray-300
  },

  // çŠ¶æ€è‰²
  success: "#10b981", // green-500
  warning: "#f59e0b", // amber-500
  error: "#ef4444", // red-500
  info: "#3b82f6", // blue-500
};
```

### 7.3 ç»„ä»¶æ ·å¼æ¨¡å¼ï¼ˆå½“å‰å®ç°ï¼‰

#### æŒ‰é’®æ ·å¼

```tsx
// âœ… ä¸»è¦æŒ‰é’®ï¼ˆå·²ä½¿ç”¨ï¼‰- WorkspaceLayout.tsx:92
<button className="rounded-full bg-blue-600 px-5 py-3 text-white shadow-lg transition-all hover:bg-blue-700 hover:shadow-xl hover:scale-105 active:scale-95">
  ä»»åŠ¡åˆ—è¡¨
</button>

// âœ… å›¾æ ‡æŒ‰é’®ï¼ˆå·²ä½¿ç”¨ï¼‰- ResourceList.tsx:111
<button className="flex-shrink-0 rounded p-1 transition-colors hover:bg-gray-200">
  <X className="h-4 w-4 text-gray-500" />
</button>

// âœ… æ–‡å­—æŒ‰é’®/å±é™©æ“ä½œï¼ˆå·²ä½¿ç”¨ï¼‰- ResourceList.tsx:168
<button className="text-xs font-medium text-red-600 hover:text-red-700">
  åˆ é™¤é€‰ä¸­
</button>

// âœ… æ¬¡è¦æŒ‰é’®ï¼ˆé€šç”¨æ¨¡å¼ï¼‰
<button className="rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50">
  å–æ¶ˆ
</button>

// âœ… ç¦ç”¨çŠ¶æ€
<button
  disabled
  className="cursor-not-allowed rounded-lg bg-gray-100 px-4 py-2 text-sm text-gray-400"
>
  å·²ç¦ç”¨
</button>
```

#### è¡¨å•å…ƒç´ 

```tsx
// âœ… Checkboxï¼ˆå·²ä½¿ç”¨ï¼‰- ResourceList.tsx:153
<input
  type="checkbox"
  className="h-4 w-4 cursor-pointer rounded border-gray-300 text-blue-600 focus:ring-blue-500"
/>

// âœ… Text Inputï¼ˆé€šç”¨æ¨¡å¼ï¼‰
<input
  type="text"
  className="w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20"
  placeholder="è¾“å…¥å†…å®¹..."
/>

// âœ… Textareaï¼ˆé€šç”¨æ¨¡å¼ï¼‰
<textarea
  className="w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20"
  rows={4}
/>
```

#### å¡ç‰‡ä¸å®¹å™¨

```tsx
// âœ… èµ„æºå¡ç‰‡ï¼ˆå·²ä½¿ç”¨ï¼‰- ResourceList.tsxé£æ ¼
<div className="group relative cursor-pointer rounded-lg border border-gray-200 bg-white p-4 transition-all hover:border-blue-300 hover:shadow-md">
  {/* å¡ç‰‡å†…å®¹ */}
</div>

// âœ… å·¥å…·æ ï¼ˆå·²ä½¿ç”¨ï¼‰- ResourceList.tsx:147
<div className="flex items-center justify-between border-b border-gray-100 bg-gray-50 px-4 py-2">
  {/* å·¥å…·æ å†…å®¹ */}
</div>

// âœ… é¢æ¿å®¹å™¨ï¼ˆå·²ä½¿ç”¨ï¼‰- WorkspaceLayout.tsx:68
<div className="relative flex-shrink-0 border-r border-gray-200 bg-white">
  {/* é¢æ¿å†…å®¹ */}
</div>
```

#### çŠ¶æ€æŒ‡ç¤ºå™¨

```tsx
// âœ… çŠ¶æ€å¾½ç« ï¼ˆResourceCardä½¿ç”¨ï¼‰
<div className="flex items-center space-x-1">
  <div className={`h-2 w-2 rounded-full ${
    status === 'collected' ? 'bg-green-500' :
    status === 'collecting' ? 'bg-yellow-500' :
    'bg-gray-400'
  }`} />
  <span className="text-xs text-gray-600">
    {statusText}
  </span>
</div>

// ğŸ†• è¿›åº¦æ¡ï¼ˆæ–°å¢ç»„ä»¶åº”éµå¾ªæ­¤é£æ ¼ï¼‰
<div className="h-2 w-full overflow-hidden rounded-full bg-gray-200">
  <div
    className="h-full bg-blue-600 transition-all duration-300"
    style={{ width: `${progress}%` }}
  />
</div>

// ğŸ†• åŠ è½½æ—‹è½¬å™¨
<div className="animate-spin rounded-full h-6 w-6 border-2 border-gray-200 border-t-blue-600" />
```

### 7.4 å¸ƒå±€è§„èŒƒï¼ˆå½“å‰å®ç°ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… å½“å‰å®ç°ï¼ˆWorkspaceLayout.tsxï¼‰                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Left    â”‚  Middle Panel            â”‚  Right Panel    â”‚   â”‚
â”‚ â”‚ Sidebar â”‚  (å¯è°ƒèŠ‚ 400-700px)      â”‚  (flex-1)       â”‚   â”‚
â”‚ â”‚         â”‚                          â”‚                 â”‚   â”‚
â”‚ â”‚ å›ºå®š    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚ â”‚ å®½åº¦    â”‚  â”‚ ResourceList       â”‚  â”‚  â”‚ Document  â”‚  â”‚   â”‚
â”‚ â”‚         â”‚  â”‚ (å¯æŠ˜å )           â”‚  â”‚  â”‚ Editor    â”‚  â”‚   â”‚
â”‚ â”‚ Explore â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚           â”‚  â”‚   â”‚
â”‚ â”‚ AI Offc â”‚                          â”‚  â”‚ PPT/Doc   â”‚  â”‚   â”‚
â”‚ â”‚ Setting â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ Preview   â”‚  â”‚   â”‚
â”‚ â”‚         â”‚  â”‚ ChatPanel          â”‚  â”‚  â”‚           â”‚  â”‚   â”‚
â”‚ â”‚         â”‚  â”‚ (å›ºå®šé«˜åº¦)         â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚ â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                 â”‚   â”‚
â”‚ â”‚         â”‚                          â”‚  [å¯é€‰]         â”‚   â”‚
â”‚ â”‚         â”‚  [æ‹–æ‹½è°ƒèŠ‚å®½åº¦]          â”‚  TaskSidebar    â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚ bg-gray-50 (å¤–å±‚) | bg-white (é¢æ¿) | border-gray-200      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®å¸ƒå±€å‚æ•°ï¼ˆæ¥è‡ªå®é™…ä»£ç ï¼‰**:

- Left Sidebar: å›ºå®šå®½åº¦ï¼Œç”±Sidebarç»„ä»¶æ§åˆ¶
- Middle Panel: 400px - 700px å¯æ‹–æ‹½è°ƒèŠ‚ï¼ˆWorkspaceLayout.tsx:68-75ï¼‰
- Right Panel: flex-1 è‡ªé€‚åº”å‰©ä½™ç©ºé—´
- Task Sidebar: 384px å›ºå®šå®½åº¦ï¼ˆå¯é€‰æ˜¾ç¤ºï¼‰
- æ‹–æ‹½æ‰‹æŸ„: w-1 å®½åº¦ï¼Œhover:bg-blue-500

### 7.5 äº¤äº’æ¨¡å¼ï¼ˆå½“å‰å®ç°ï¼‰

#### Hover æ•ˆæœ

```tsx
// âœ… å¡ç‰‡æ‚¬åœ
hover:border-blue-300 hover:shadow-md

// âœ… æŒ‰é’®æ‚¬åœ
hover:bg-blue-700 hover:shadow-xl hover:scale-105

// âœ… å›¾æ ‡æŒ‰é’®æ‚¬åœ
hover:bg-gray-200

// âœ… æ–‡å­—æ‚¬åœ
hover:text-red-700
```

#### è¿‡æ¸¡åŠ¨ç”»

```tsx
// âœ… é¢œè‰²è¿‡æ¸¡ï¼ˆæœ€å¸¸ç”¨ï¼‰
transition-colors

// âœ… å…¨å±æ€§è¿‡æ¸¡
transition-all

// âœ… ç‰¹å®šå±æ€§è¿‡æ¸¡
transition-shadow transition-transform

// âœ… è‡ªå®šä¹‰æ—¶é•¿
transition-all duration-300
```

#### å“åº”å¼é—´è·

```tsx
// âœ… æ°´å¹³é—´è·
space-x-1 space-x-2 space-x-3 space-x-4

// âœ… å‚ç›´é—´è·
space-y-2 space-y-3 space-y-4

// âœ… å†…è¾¹è·
px-3 py-2  // å°
px-4 py-2  // ä¸­
px-5 py-3  // å¤§

// âœ… å¤–è¾¹è·
m-2 m-4 mt-4 mb-6
```

### 7.6 å­—ä½“è§„èŒƒï¼ˆå½“å‰å®ç°ï¼‰

```tsx
// âœ… æ–‡å­—å¤§å°
text - xs; // 12px - æ¬¡è¦ä¿¡æ¯ã€æ ‡ç­¾
text - sm; // 14px - æ­£æ–‡ã€è¾“å…¥æ¡†
text - base; // 16px - æ ‡é¢˜ã€å¼ºè°ƒ
text - lg; // 18px - å¤§æ ‡é¢˜
text - xl; // 20px - é¡µé¢ä¸»æ ‡é¢˜

// âœ… å­—é‡
font - normal; // 400 - æ­£æ–‡
font - medium; // 500 - æŒ‰é’®ã€æ ‡ç­¾
font - semibold; // 600 - å°æ ‡é¢˜
font - bold; // 700 - å¤§æ ‡é¢˜

// âœ… è¡Œé«˜
leading - tight; // ç´§å‡‘
leading - normal; // æ­£å¸¸
leading - relaxed; // å®½æ¾
```

### 7.7 é˜´å½±ç³»ç»Ÿï¼ˆå½“å‰å®ç°ï¼‰

```tsx
// âœ… å¡ç‰‡é˜´å½±
shadow-sm    // å¾®é˜´å½±
shadow-md    // ä¸­ç­‰é˜´å½±ï¼ˆhoverçŠ¶æ€ï¼‰
shadow-lg    // è¾ƒå¤§é˜´å½±ï¼ˆæµ®åŠ¨æŒ‰é’®ï¼‰
shadow-xl    // æœ€å¤§é˜´å½±ï¼ˆhoverå¼ºè°ƒï¼‰

// âœ… ä½¿ç”¨åœºæ™¯
<div className="shadow-sm hover:shadow-md">  // å¡ç‰‡
<button className="shadow-lg hover:shadow-xl"> // æµ®åŠ¨æ“ä½œæŒ‰é’®
```

### 7.8 2.0æ–°å¢ç»„ä»¶è®¾è®¡æŒ‡å—

**æ‰€æœ‰2.0æ–°å¢UIç»„ä»¶å¿…é¡»éµå¾ªä»¥ä¸Šè§„èŒƒ**ï¼Œå…·ä½“åŒ…æ‹¬ï¼š

1. **Multi-Agentè¿›åº¦æ˜¾ç¤º**
   - ä½¿ç”¨ `bg-gray-200` + `bg-blue-600` è¿›åº¦æ¡
   - é˜¶æ®µæ–‡å­—ä½¿ç”¨ `text-sm text-gray-600`
   - å®ŒæˆçŠ¶æ€ä½¿ç”¨ `text-green-600`

2. **ç‰ˆæœ¬å¯¹æ¯”Diffè§†å›¾**
   - æ–°å¢å†…å®¹: `bg-green-50 border-l-4 border-green-500`
   - åˆ é™¤å†…å®¹: `bg-red-50 border-l-4 border-red-500`
   - ä¿®æ”¹å†…å®¹: `bg-yellow-50 border-l-4 border-yellow-500`

3. **Research Pageç»“æ„åŒ–å±•ç¤º**
   - Sectionå¡ç‰‡: `border border-gray-200 rounded-lg p-4 bg-white`
   - ç½®ä¿¡åº¦å¾½ç« : `text-xs rounded-full px-2 py-1 bg-blue-100 text-blue-700`

4. **èµ„æºæ¨èå¡ç‰‡**
   - åŸºç¡€æ ·å¼ç»§æ‰¿ResourceCard
   - æ¨èç†ç”±ä½¿ç”¨ `text-xs text-gray-500 italic`
   - ç›¸å…³åº¦åˆ†æ•°ä½¿ç”¨ `text-sm font-semibold text-blue-600`

---

## 8. å®æ–½è·¯çº¿å›¾

> **é‡è¦æ›´æ–°**: æœ¬èŠ‚ä¸ºåŸå§‹è§„åˆ’ï¼ˆå‡è®¾ä»é›¶å¼€å§‹ï¼‰ã€‚åŸºäºç°æœ‰å®ç°çš„**è°ƒæ•´ç‰ˆè·¯çº¿å›¾**è¯·å‚è§ **[Â§10.3 å®æ–½è·¯çº¿å›¾ï¼ˆè°ƒæ•´ç‰ˆï¼‰](#103-å®æ–½è·¯çº¿å›¾è°ƒæ•´ç‰ˆ)**ï¼Œè¯¥ç‰ˆæœ¬è€ƒè™‘äº†å·²å®Œæˆçš„70%+åŠŸèƒ½ï¼Œæ›´ç¬¦åˆå®é™…æƒ…å†µã€‚

---

### 8.1 åŸå§‹è§„åˆ’ï¼ˆå‚è€ƒç”¨ï¼‰

ä»¥ä¸‹ä¸ºåŸå§‹7é˜¶æ®µè§„åˆ’ï¼ˆå‡è®¾ä»é›¶å¼€å§‹ï¼Œ21å‘¨ï¼‰ã€‚å®é™…æ‰§è¡Œåº”å‚ç…§Â§10.3çš„5é˜¶æ®µè§„åˆ’ï¼ˆ13å‘¨ï¼‰ã€‚

### Phase 1: æ ¸å¿ƒæ¶æ„ (4å‘¨)

**ç›®æ ‡: å»ºç«‹Multi-AgentåŸºç¡€å’ŒåŸºæœ¬æ–‡æ¡£ç”Ÿæˆ**

**Week 1-2: Multi-Agentç³»ç»Ÿ**

- [ ] Agentåè°ƒå™¨å®ç°
- [ ] Grok Agenté›†æˆï¼ˆCoordinatorAgent, ResourceAnalysisAgent, VerificationAgentï¼‰
- [ ] ChatGPT Agenté›†æˆï¼ˆContentWritingAgent, VisualizationAgentï¼‰
- [ ] Agenté€šä¿¡åè®®
- [ ] æ‰©å±•æ¥å£è®¾è®¡ï¼ˆæ”¯æŒæœªæ¥æ·»åŠ Claudeã€Geminiç­‰ï¼‰

**Week 3-4: åŸºç¡€æ–‡æ¡£ç”Ÿæˆ**

- [ ] PPTåŸºç¡€ç”Ÿæˆï¼ˆä½¿ç”¨é»˜è®¤æ¨¡æ¿ï¼‰
- [ ] DocåŸºç¡€ç”Ÿæˆ
- [ ] Research Page MVP
- [ ] SSEæµå¼ç”Ÿæˆ
- [ ] å®æ—¶è¿›åº¦æ˜¾ç¤º

**äº¤ä»˜ç‰©:**

- âœ… Multi-Agentç³»ç»Ÿå¯å·¥ä½œ
- âœ… å¯ç”ŸæˆåŸºç¡€PPTå’ŒDoc
- âœ… å®æ—¶è¿›åº¦åé¦ˆ

---

### Phase 2: èµ„æºç®¡ç†ä¸æ¨è (3å‘¨)

**ç›®æ ‡: æ™ºèƒ½èµ„æºæ¨èç³»ç»Ÿ**

**Week 5-6: èµ„æºæ¨èå¼•æ“**

- [ ] URLæ™ºèƒ½æ£€æµ‹ï¼ˆarXiv, GitHub, YouTube, DOIï¼‰
- [ ] èµ„æºæ¨èç®—æ³•ï¼ˆåŸºäºç›¸å…³åº¦ï¼‰
- [ ] æ¨èUIç»„ä»¶
- [ ] ç”¨æˆ·å¯¼å…¥å†³ç­–æµç¨‹

**Week 7: ç›¸å…³èµ„æºå‘ç°**

- [ ] åŸºäºå†…å®¹çš„ç›¸ä¼¼åº¦è®¡ç®—
- [ ] åŸºäºç”¨æˆ·å†å²çš„æ¨è
- [ ] æ¨èç†ç”±ç”Ÿæˆï¼ˆAIè§£é‡Šï¼‰

**äº¤ä»˜ç‰©:**

- âœ… URLç²˜è´´ â†’ æ¨è â†’ ç”¨æˆ·å†³ç­– â†’ å¯¼å…¥æµç¨‹
- âœ… ç›¸å…³èµ„æºè‡ªåŠ¨å‘ç°

---

### Phase 3: ç‰ˆæœ¬ç®¡ç†ä¸æŒç»­è¿­ä»£ (4å‘¨)

**ç›®æ ‡: å®Œæ•´çš„ç‰ˆæœ¬æ§åˆ¶å’Œè¿­ä»£ç¼–è¾‘ç³»ç»Ÿ**

**Week 8-9: ç‰ˆæœ¬ç®¡ç†**

- [ ] Git-likeç‰ˆæœ¬ç³»ç»Ÿ
- [ ] ç‰ˆæœ¬å¿«ç…§å­˜å‚¨
- [ ] ç‰ˆæœ¬å†å²UI
- [ ] ç‰ˆæœ¬å¯¹æ¯”ï¼ˆDiffï¼‰
- [ ] ç‰ˆæœ¬å›æ»š

**Week 10-11: æŒç»­è¿­ä»£**

- [ ] æ–‡æ¡£ä¸°å¯Œæ£€æµ‹ï¼ˆæ–°èµ„æº â†’ å»ºè®®æ›´æ–°ï¼‰
- [ ] å¢é‡æ›´æ–°ï¼ˆåªæ›´æ–°ç›¸å…³ç« èŠ‚ï¼‰
- [ ] ç¼©ç•¥å›¾ç”Ÿæˆä¸ç¼“å­˜
- [ ] é€‰ä¸­ç¼–è¾‘ï¼ˆSlide/Chapterçº§åˆ«ï¼‰
- [ ] AIè¾…åŠ©ç¼–è¾‘ï¼ˆé‡æ–°ç”Ÿæˆã€æ‰©å±•å†…å®¹ç­‰ï¼‰

**äº¤ä»˜ç‰©:**

- âœ… å®Œæ•´ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿ
- âœ… æ”¯æŒé•¿æœŸè¿­ä»£çš„æ–‡æ¡£
- âœ… ç¼©ç•¥å›¾é¢„è§ˆ

---

### Phase 4: æ¨¡æ¿ç³»ç»Ÿ (3å‘¨)

**ç›®æ ‡: ä¸“ä¸šæ¨¡æ¿åº“å’Œè‡ªå®šä¹‰èƒ½åŠ›**

**Week 12-13: å†…ç½®æ¨¡æ¿**

- [ ] å­¦æœ¯æ¨¡æ¿ï¼ˆä¼šè®®æ¼”è®²ã€æ–‡çŒ®ç»¼è¿°ã€è®ºæ–‡ï¼‰
- [ ] æŠ€æœ¯æ¨¡æ¿ï¼ˆæŠ€æœ¯åˆ†äº«ã€è®¾è®¡æ–‡æ¡£ã€ä»£ç å®¡æŸ¥ï¼‰
- [ ] æ¨¡æ¿åº”ç”¨å¼•æ“
- [ ] æ¨¡æ¿é¢„è§ˆ

**Week 14: è‡ªå®šä¹‰æ¨¡æ¿**

- [ ] æ¨¡æ¿ç¼–è¾‘å™¨
- [ ] æ¨¡æ¿ä¿å­˜/åŠ è½½
- [ ] æ¨¡æ¿åˆ†äº«ï¼ˆå¯¼å…¥/å¯¼å‡ºï¼‰

**äº¤ä»˜ç‰©:**

- âœ… 6-8ä¸ªä¸“ä¸šæ¨¡æ¿
- âœ… ç”¨æˆ·å¯åˆ›å»ºè‡ªå®šä¹‰æ¨¡æ¿

---

### Phase 5: å¤šæ ¼å¼å¯¼å‡º (2å‘¨)

**ç›®æ ‡: æ”¯æŒæ‰€æœ‰ä¸»æµæ ¼å¼å¯¼å‡º**

**Week 15-16: å¯¼å‡ºåŠŸèƒ½**

- [ ] PPTXå¯¼å‡ºï¼ˆpptxgenjsï¼‰
- [ ] DOCXå¯¼å‡ºï¼ˆdocxåº“ï¼‰
- [ ] PDFå¯¼å‡ºï¼ˆpuppeteerï¼‰
- [ ] Markdownå¯¼å‡º
- [ ] HTMLå¯¼å‡ºï¼ˆå“åº”å¼ï¼‰
- [ ] LaTeXå¯¼å‡ºï¼ˆå­¦æœ¯æœŸåˆŠï¼‰

**äº¤ä»˜ç‰©:**

- âœ… 6ç§æ ¼å¼å¯¼å‡º
- âœ… ä¿ç•™æ ·å¼å’Œæ ¼å¼

---

### Phase 6: ä¼˜åŒ–ä¸å¢å¼º (3å‘¨)

**ç›®æ ‡: æ€§èƒ½ä¼˜åŒ–å’Œä½“éªŒæå‡**

**Week 17: æ€§èƒ½ä¼˜åŒ–**

- [ ] Agentå¹¶è¡Œæ‰§è¡Œä¼˜åŒ–
- [ ] ç¼“å­˜ç­–ç•¥ï¼ˆAgentç»“æœç¼“å­˜ï¼‰
- [ ] å›¾ç‰‡/ç¼©ç•¥å›¾å‹ç¼©
- [ ] æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

**Week 18: ä½“éªŒä¼˜åŒ–**

- [ ] é”®ç›˜å¿«æ·é”®
- [ ] æ‹–æ‹½æ’åºï¼ˆSlides/Chaptersï¼‰
- [ ] æ‰¹é‡æ“ä½œ
- [ ] æœç´¢åŠŸèƒ½ï¼ˆå…¨æ–‡æœç´¢ï¼‰

**Week 19: é”™è¯¯å¤„ç†**

- [ ] ç»Ÿä¸€é”™è¯¯å¤„ç†
- [ ] å‹å¥½é”™è¯¯æç¤º
- [ ] è‡ªåŠ¨é‡è¯•æœºåˆ¶
- [ ] ç¦»çº¿æ”¯æŒï¼ˆéƒ¨åˆ†åŠŸèƒ½ï¼‰

**äº¤ä»˜ç‰©:**

- âœ… æ€§èƒ½æå‡2-3x
- âœ… æ›´æµç•…çš„ç”¨æˆ·ä½“éªŒ
- âœ… å¥å£®çš„é”™è¯¯å¤„ç†

---

### Phase 7: Betaæµ‹è¯• (2å‘¨)

**Week 20-21: å†…éƒ¨æµ‹è¯•ä¸ä¿®å¤**

- [ ] æ‹›å‹Ÿ10-20ä¸ªbetaç”¨æˆ·ï¼ˆç ”ç©¶ç”Ÿã€æŠ€æœ¯leaderï¼‰
- [ ] æ”¶é›†åé¦ˆ
- [ ] ä¿®å¤å…³é”®bug
- [ ] æ–‡æ¡£å’Œæ•™ç¨‹

**äº¤ä»˜ç‰©:**

- âœ… Betaç‰ˆæœ¬
- âœ… ç”¨æˆ·åé¦ˆæŠ¥å‘Š
- âœ… Bugä¿®å¤

---

### æ€»è®¡: 21å‘¨ (çº¦5ä¸ªæœˆ)

**é‡Œç¨‹ç¢‘:**

- **M1 (Week 4):** æ ¸å¿ƒæ¶æ„å®Œæˆï¼Œå¯ç”ŸæˆåŸºç¡€æ–‡æ¡£
- **M2 (Week 7):** èµ„æºæ¨èç³»ç»Ÿä¸Šçº¿
- **M3 (Week 11):** ç‰ˆæœ¬ç®¡ç†å’ŒæŒç»­è¿­ä»£å®Œæˆ
- **M4 (Week 14):** æ¨¡æ¿ç³»ç»Ÿä¸Šçº¿
- **M5 (Week 16):** å¤šæ ¼å¼å¯¼å‡ºå®Œæˆ
- **M6 (Week 19):** ä¼˜åŒ–å®Œæˆï¼Œå‡†å¤‡Beta
- **M7 (Week 21):** Betaæµ‹è¯•å®Œæˆï¼Œå‡†å¤‡å‘å¸ƒ

---

## 9. æˆåŠŸæŒ‡æ ‡

### 9.1 åŒ—ææ˜ŸæŒ‡æ ‡

**æ¯å‘¨ç”Ÿæˆçš„é«˜è´¨é‡æ–‡æ¡£æ•°ï¼ˆWeekly Quality Documents Generatedï¼‰**

å®šä¹‰ï¼š

- è´¨é‡æ–‡æ¡£ = ç”¨æˆ·è¯„åˆ† â‰¥ 4æ˜Ÿ ä¸” ä½¿ç”¨æ—¶é•¿ â‰¥ 10åˆ†é’Ÿ çš„æ–‡æ¡£
- ç›®æ ‡ï¼šQ1ç»“æŸæ—¶è¾¾åˆ° 1000 documents/week

### 9.2 å…³é”®æŒ‡æ ‡æ ‘

```
ğŸ“ˆ Weekly Quality Documents
   â”‚
   â”œâ”€ ğŸ“š èµ„æºç®¡ç†æ•ˆç‡
   â”‚  â”œâ”€ æ–°å¢èµ„æºæ•°/å‘¨: ç›®æ ‡ 5000+
   â”‚  â”œâ”€ æ¨èæ¥å—ç‡: ç›®æ ‡ > 60%
   â”‚  â”œâ”€ èµ„æºè´¨é‡åˆ†æ•°: ç›®æ ‡ > 0.75
   â”‚  â””â”€ å¯¼å…¥é”™è¯¯ç‡: ç›®æ ‡ < 2%
   â”‚
   â”œâ”€ ğŸ¤– AIç”Ÿæˆæ•ˆç‡
   â”‚  â”œâ”€ å¹³å‡ç”Ÿæˆæ—¶é—´: ç›®æ ‡ < 15ç§’
   â”‚  â”œâ”€ ç”ŸæˆæˆåŠŸç‡: ç›®æ ‡ > 95%
   â”‚  â”œâ”€ å¹³å‡ç½®ä¿¡åº¦: ç›®æ ‡ > 0.85
   â”‚  â””â”€ ç”¨æˆ·æ»¡æ„åº¦(ğŸ‘/ğŸ‘): ç›®æ ‡ > 80%
   â”‚
   â”œâ”€ ğŸ“ æŒç»­è¿­ä»£ä½¿ç”¨
   â”‚  â”œâ”€ å¹³å‡ç‰ˆæœ¬æ•°/æ–‡æ¡£: ç›®æ ‡ > 3
   â”‚  â”œâ”€ æ–‡æ¡£ç¼–è¾‘æ¬¡æ•°/å‘¨: ç›®æ ‡ > 2
   â”‚  â”œâ”€ èµ„æºä¸°å¯Œé‡‡ç”¨ç‡: ç›®æ ‡ > 50%
   â”‚  â””â”€ ç‰ˆæœ¬å›æ»šç‡: ç›®æ ‡ < 10%
   â”‚
   â”œâ”€ ğŸ¨ æ¨¡æ¿ä½¿ç”¨
   â”‚  â”œâ”€ æ¨¡æ¿åº”ç”¨ç‡: ç›®æ ‡ > 70%
   â”‚  â”œâ”€ è‡ªå®šä¹‰æ¨¡æ¿æ•°: ç›®æ ‡ > 100
   â”‚  â””â”€ æ¨¡æ¿æ»¡æ„åº¦: ç›®æ ‡ > 4.0/5
   â”‚
   â””â”€ ğŸ“¤ å¯¼å‡ºä¸åˆ†äº«
      â”œâ”€ å¯¼å‡ºç‡: ç›®æ ‡ > 60%
      â”œâ”€ PPTXå¯¼å‡ºå æ¯”: ç›®æ ‡ > 40%
      â”œâ”€ PDFå¯¼å‡ºå æ¯”: ç›®æ ‡ > 30%
      â””â”€ åˆ†äº«ç‡: ç›®æ ‡ > 20%
```

### 9.3 ç”¨æˆ·ç•™å­˜æŒ‡æ ‡

- **Day 1ç•™å­˜:** ç›®æ ‡ > 60%
- **Week 1ç•™å­˜:** ç›®æ ‡ > 40%
- **Month 1ç•™å­˜:** ç›®æ ‡ > 25%

### 9.4 æ€§èƒ½æŒ‡æ ‡

- **æ–‡æ¡£ç”Ÿæˆæ—¶é—´ (P50):** < 10ç§’
- **æ–‡æ¡£ç”Ÿæˆæ—¶é—´ (P95):** < 20ç§’
- **APIå“åº”æ—¶é—´ (P95):** < 200ms
- **é¡µé¢åŠ è½½æ—¶é—´:** < 2ç§’

---

## 10. åŸºäºç°æœ‰å®ç°çš„2.0å‡çº§æ€»ç»“

### 10.1 ç°æœ‰å®ç°æ¦‚è§ˆï¼ˆå·²å®Œæˆçš„åŠŸèƒ½ï¼‰

AI Officeå½“å‰å·²ç»å…·å¤‡å®Œæ•´çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œè¿™æ˜¯2.0å‡çº§çš„åšå®åŸºç¡€ï¼š

#### âœ… å®Œæ•´å®ç°çš„æ¨¡å—ï¼ˆä¿ç•™ï¼‰

**1. ä¸‰æ å¸ƒå±€ç³»ç»Ÿ**ï¼ˆWorkspaceLayout.tsxï¼‰

- å·¦ä¾§ï¼šå…¨å±€Sidebarï¼ˆå¯¼èˆªï¼‰
- ä¸­é—´ï¼šMiddlePanelï¼ˆèµ„æºåˆ—è¡¨ + ChatPanelï¼‰
  - å¯æŠ˜å èµ„æºåˆ—è¡¨
  - æ‹–æ‹½è°ƒèŠ‚å®½åº¦ï¼ˆ400-700pxï¼‰
- å³ä¾§ï¼šRightPanelï¼ˆDocumentEditorï¼‰
- å¯é€‰ï¼šTaskListä¾§è¾¹æ ï¼ˆå›ºå®š384pxï¼‰

**2. èµ„æºç®¡ç†ç³»ç»Ÿ**ï¼ˆResourceList.tsx + useResourceStoreï¼‰

- âœ… ä»Exploreé¡µé¢æ·»åŠ èµ„æº
- âœ… \_idå»é‡æ£€æŸ¥
- âœ… å•é€‰/å…¨é€‰/æ‰¹é‡åˆ é™¤
- âœ… LocalStorageæŒä¹…åŒ–
- âœ… çŠ¶æ€ç®¡ç†ï¼ˆZustandï¼‰

**3. AIäº¤äº’ç³»ç»Ÿ**ï¼ˆChatPanel.tsx - 1615è¡Œï¼‰

- âœ… æ„å›¾è¯†åˆ«ï¼ˆPPT/Word/æ›´æ–°ï¼‰
- âœ… @èµ„æºå¼•ç”¨ç³»ç»Ÿï¼ˆ@all / @èµ„æºåï¼‰
- âœ… æµå¼å¤„ç†ï¼ˆSSEï¼‰
- âœ… å±€éƒ¨æ›´æ–°ï¼ˆ"æ›´æ–°ç¬¬1-3é¡µ"ï¼‰
- âœ… æ–‡æ¡£åˆ›å»ºå†³ç­–
- âœ… å¯¹è¯å†å²ä¿å­˜

**4. æ–‡æ¡£ç¼–è¾‘ç³»ç»Ÿ**ï¼ˆDocumentEditor.tsxï¼‰

- âœ… PPTåŠŸèƒ½
  - 5ç§ä¸»é¢˜æ¨¡æ¿ï¼ˆCorporate/Minimal/Modern/Creative/Academicï¼‰
  - 6ç§æ™ºèƒ½å¯è§†åŒ–ï¼ˆFLOW/CHART:line/pie/bar/radar/MATRIXï¼‰
  - å¹»ç¯ç‰‡å¯¼èˆªä¸ç¼©ç•¥å›¾
  - å±€éƒ¨æ›´æ–°ï¼ˆæŒ‡å®šé¡µé¢ï¼‰
- âœ… è‡ªåŠ¨ä¿å­˜ï¼ˆé˜²æŠ–1000msï¼‰
- âœ… å®æ—¶é¢„è§ˆ
- âœ… å¤šæ ¼å¼å¯¼å‡ºï¼ˆPPTX/DOCX/PDF/Markdownï¼‰

**5. ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿ**ï¼ˆVersionHistory.tsx + useDocumentStoreï¼‰

- âœ… è‡ªåŠ¨ç‰ˆæœ¬å¿«ç…§ï¼ˆai_generation/user_edit/manual_saveï¼‰
- âœ… ç‰ˆæœ¬å†å²æŸ¥çœ‹
- âœ… ç‰ˆæœ¬æ¢å¤
- âœ… ç‰ˆæœ¬åˆ é™¤
- âœ… è§¦å‘æºè®°å½•

**6. ä»»åŠ¡ç®¡ç†ç³»ç»Ÿ**ï¼ˆTaskList.tsx + useTaskStoreï¼‰

- âœ… ä»»åŠ¡è‡ªåŠ¨åˆ›å»º
- âœ… å®Œæ•´ä¸Šä¸‹æ–‡ä¿å­˜ï¼ˆèµ„æº+æ–‡æ¡£+å¯¹è¯+ç‰ˆæœ¬ï¼‰
- âœ… ä»»åŠ¡æ¢å¤ï¼ˆå®Œæ•´çŠ¶æ€æ¢å¤ï¼‰
- âœ… ä»»åŠ¡åˆ—è¡¨ä¾§è¾¹æ 
- âœ… ä»»åŠ¡è®¡æ•°å¾½ç« 

**7. å¯è§†åŒ–ç³»ç»Ÿ**ï¼ˆEnhancedSlideRenderer.tsxï¼‰

- âœ… ChartRendererï¼ˆRechartsï¼‰
- âœ… FlowDiagramï¼ˆSVGï¼‰
- âœ… MatrixLayoutï¼ˆå››è±¡é™ï¼‰
- âœ… å¹»ç¯ç‰‡ç±»å‹è¯†åˆ«
- âœ… æ¨¡æ¿ç³»ç»Ÿï¼ˆ5ç§PPTæ¨¡æ¿ï¼‰

---

### 10.2 2.0å‡çº§é‡ç‚¹ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰

åŸºäºç°æœ‰å®ç°ï¼Œ2.0ç‰ˆæœ¬èšç„¦ä»¥ä¸‹å¢å¼ºï¼š

#### ğŸ†• ä¼˜å…ˆçº§P0ï¼ˆç«‹å³å®æ–½ï¼‰

**1. Multi-Agentç¼–æ’ç³»ç»Ÿ**

- åœ¨ç°æœ‰ChatPanelåŸºç¡€ä¸Šæ·»åŠ Agentå±‚
- ä¸æ”¹å˜ç°æœ‰çš„æ„å›¾è¯†åˆ«å’Œæµå¼å¤„ç†
- å®ç°æ–¹å¼ï¼š

  ```typescript
  // åœ¨handleSend()ä¸­æ’å…¥
  // 1. ç°æœ‰æµç¨‹ä¿ç•™
  const isPPTRequest = /ppt/.test(userInput); // âœ… ä¿ç•™
  const mentionedResources = parseMentions(userInput); // âœ… ä¿ç•™

  // 2. æ–°å¢Agenté¢„å¤„ç†
  if (isComplexTask) {
    const analysis = await resourceAnalysisAgent.analyze(resources);
    enhancedPrompt += analysis; // æ³¨å…¥åˆ†æç»“æœ
  }

  // 3. ç°æœ‰æµå¼ç”Ÿæˆ
  const response = await fetch("/api/ai-office/chat", {
    message: enhancedPrompt, // âœ… ä½¿ç”¨å¢å¼ºPrompt
  }); // âœ… ä¿ç•™

  // 4. æ–°å¢Agentåå¤„ç†
  const verified = await verificationAgent.verify(aiContent);
  updateDocument({ metadata: { verificationResult: verified } });
  ```

**2. AIè¿‡ç¨‹é€æ˜åŒ–**

- åœ¨ç°æœ‰GenerationProgressåŸºç¡€ä¸Šå¢å¼º
- æ˜¾ç¤ºAgentå·¥ä½œçŠ¶æ€
- å®ç°æ–¹å¼ï¼š
  ```tsx
  // æ‰©å±•ç°æœ‰GenerationSteps
  {phase: 'analyzing', agent: 'grok', status: 'in-progress', details: 'æ­£åœ¨åˆ†æè®ºæ–‡æ ¸å¿ƒè§‚ç‚¹'}
  {phase: 'generating', agent: 'chatgpt', status: 'in-progress', details: 'æ­£åœ¨ç”ŸæˆSlide 3'}
  {phase: 'verifying', agent: 'grok', status: 'in-progress', details: 'æ­£åœ¨éªŒè¯äº‹å®'}
  ```

**3. ç›¸å…³èµ„æºæ¨è**

- åœ¨ChatPanelä¸­é›†æˆæ¨èå¡ç‰‡
- ä¸æ”¹å˜ç°æœ‰çš„èµ„æºæ·»åŠ æµç¨‹
- å®ç°æ–¹å¼ï¼š

  ```tsx
  // ChatPanelä¸­æ–°å¢
  useEffect(() => {
    if (currentDocument) {
      const recommendations = await recommendRelatedResources({
        documentContent: currentDocument.content.markdown,
        existingResources: resources,
      });
      setRecommendations(recommendations);
    }
  }, [currentDocument]);

  // UIä¸­æ˜¾ç¤º
  {
    recommendations.length > 0 && (
      <RecommendationPanel>
        {recommendations.map((rec) => (
          <RecommendationCard
            resource={rec}
            onAccept={() => addResource(rec)} // ä½¿ç”¨ç°æœ‰addResource
          />
        ))}
      </RecommendationPanel>
    );
  }
  ```

#### ğŸ†• ä¼˜å…ˆçº§P1ï¼ˆè¿‘æœŸå®æ–½ï¼‰

**4. ç‰ˆæœ¬å¯¹æ¯”ï¼ˆDiffï¼‰åŠŸèƒ½**

- æ‰©å±•ç°æœ‰VersionHistoryç»„ä»¶
- å®ç°æ–¹å¼ï¼š

  ```tsx
  // VersionHistory.tsxä¸­æ–°å¢
  <Button onClick={() => compareVersions(v1, v2)}>å¯¹æ¯”ç‰ˆæœ¬</Button>

  // æ–°ç»„ä»¶ VersionComparison.tsx
  <VersionComparison
    oldVersion={v1}
    newVersion={v2}
    changes={calculateDiff(v1, v2)}
  />
  ```

**5. Slideçº§åˆ«é€‰ä¸­ç¼–è¾‘**

- åœ¨ç°æœ‰DocumentEditoråŸºç¡€ä¸Šå¢å¼º
- å®ç°æ–¹å¼ï¼š

  ```tsx
  // DocumentEditor.tsxä¸­æ–°å¢
  const [selectedSlideIndex, setSelectedSlideIndex] = useState<number | null>(
    null,
  );

  // ç‚¹å‡»ç¼©ç•¥å›¾
  <Thumbnail
    onClick={() => {
      setSelectedSlideIndex(index);
      setEditMode("slide"); // æ–°å¢ç¼–è¾‘æ¨¡å¼
    }}
  />;

  // ç¼–è¾‘é¢æ¿
  {
    editMode === "slide" && (
      <SlideEditPanel
        slide={slides[selectedSlideIndex]}
        onUpdate={(updated) => updateSlide(selectedSlideIndex, updated)}
        onRegenerate={() => regenerateSlide(selectedSlideIndex)}
      />
    );
  }
  ```

**6. Research Pageæ ¼å¼**

- ä½œä¸ºæ–°çš„æ–‡æ¡£ç±»å‹æ·»åŠ 
- åŸºäºç°æœ‰Documentæ•°æ®æ¨¡å‹æ‰©å±•
- å®ç°æ–¹å¼ï¼š

  ```typescript
  // types/ai-office.tsä¸­æ–°å¢
  export type DocumentType = 'ppt' | 'article' | 'research-page'; // æ–°å¢research-page

  interface ResearchPageContent {
    sections: {
      summary: {...},
      keyFindings: [...],
      visualInsights: {...},
      deepDive: {...},
      actionableInsights: {...}
    };
  }
  ```

**7. æ¨¡æ¿åº“æ‰©å±•**

- åŸºäºç°æœ‰5ç§PPTæ¨¡æ¿
- æ–°å¢ç§‘ç ”/æŠ€æœ¯æ¨¡æ¿
- å®ç°æ–¹å¼ï¼š

  ```typescript
  // lib/ppt-templates.tsä¸­æ‰©å±•
  export const TEMPLATES = {
    ...EXISTING_TEMPLATES, // ä¿ç•™ç°æœ‰5ç§

    // æ–°å¢ç§‘ç ”æ¨¡æ¿
    'academic-conference': {...},
    'literature-review': {...},

    // æ–°å¢æŠ€æœ¯æ¨¡æ¿
    'tech-talk': {...},
    'design-doc': {...},
  };
  ```

#### ğŸ†• ä¼˜å…ˆçº§P2ï¼ˆé•¿æœŸè§„åˆ’ï¼‰

**8. æ¨¡æ¿ç¼–è¾‘å™¨**

- å…è®¸ç”¨æˆ·è‡ªå®šä¹‰æ¨¡æ¿
- æ–°å¢ç‹¬ç«‹é¡µé¢

**9. èµ„æºåˆ†ç±»ä¸æ ‡ç­¾**

- æ‰©å±•Resourceæ•°æ®æ¨¡å‹
- åœ¨ResourceListä¸­æ·»åŠ è¿‡æ»¤åŠŸèƒ½

**10. HTML/LaTeXå¯¼å‡º**

- æ‰©å±•ç°æœ‰å¯¼å‡ºAPI
- æ·»åŠ æ–°çš„å¯¼å‡ºæ ¼å¼

---

### 10.3 å®æ–½è·¯çº¿å›¾ï¼ˆè°ƒæ•´ç‰ˆï¼‰

åŸºäºç°æœ‰å®ç°ï¼Œ2.0å‡çº§é‡‡ç”¨"å¢å¼ºè€Œéé‡æ„"ç­–ç•¥ï¼š

#### Phase 1: Multi-Agentæ ¸å¿ƒï¼ˆ4å‘¨ï¼‰

**Week 1-2: AgentåŸºç¡€æ¶æ„**

- [ ] åˆ›å»ºMulti-Agentåè°ƒå±‚ï¼ˆä¸å½±å“ç°æœ‰ChatPanelï¼‰
- [ ] å®ç°CoordinatorAgentï¼ˆGrokï¼‰
- [ ] å®ç°ResourceAnalysisAgentï¼ˆGrokï¼‰
- [ ] å®ç°VerificationAgentï¼ˆGrokï¼‰
- [ ] åœ¨ChatPanelä¸­é›†æˆAgenté¢„å¤„ç†

**Week 3-4: AIè¿‡ç¨‹é€æ˜åŒ–**

- [ ] æ‰©å±•ç°æœ‰GenerationStepsæ•°æ®ç»“æ„
- [ ] åœ¨ChatPanelä¸­æ·»åŠ AgentçŠ¶æ€æ˜¾ç¤º
- [ ] å®æ—¶æ˜¾ç¤ºAgentå·¥ä½œè¿›åº¦
- [ ] æ·»åŠ ç½®ä¿¡åº¦æ ‡è®°UI

**äº¤ä»˜ç‰©ï¼š**

- âœ… Multi-Agentç³»ç»Ÿå¯å·¥ä½œ
- âœ… AIè¿‡ç¨‹å¯è§†åŒ–
- âœ… ä¸ç ´åç°æœ‰åŠŸèƒ½

---

#### Phase 2: ç¼–è¾‘å¢å¼ºï¼ˆ3å‘¨ï¼‰

**Week 5-6: ç‰ˆæœ¬å¯¹æ¯”ä¸Slideç¼–è¾‘**

- [ ] å®ç°ç‰ˆæœ¬Diffç®—æ³•
- [ ] åˆ›å»ºVersionComparisonç»„ä»¶
- [ ] å®ç°Slideçº§åˆ«é€‰ä¸­ç¼–è¾‘
- [ ] æ·»åŠ SlideEditPanelç»„ä»¶

**Week 7: èµ„æºæ¨è**

- [ ] å®ç°ç›¸å…³èµ„æºæ¨èç®—æ³•
- [ ] åœ¨ChatPanelä¸­é›†æˆæ¨èå¡ç‰‡
- [ ] å®ç°æ¨èæ¥å—/æ‹’ç»é€»è¾‘

**äº¤ä»˜ç‰©ï¼š**

- âœ… ç‰ˆæœ¬å¯¹æ¯”åŠŸèƒ½
- âœ… Slideé€‰ä¸­ç¼–è¾‘
- âœ… èµ„æºæ¨èç³»ç»Ÿ

---

#### Phase 3: æ¨¡æ¿ä¸å¯¼å‡ºï¼ˆ2å‘¨ï¼‰

**Week 8-9: æ¨¡æ¿åº“æ‰©å±•**

- [ ] æ·»åŠ 4-6ä¸ªç§‘ç ”/æŠ€æœ¯æ¨¡æ¿
- [ ] å®ç°æ¨¡æ¿é¢„è§ˆ
- [ ] ï¼ˆå¯é€‰ï¼‰æ¨¡æ¿ç¼–è¾‘å™¨MVP

**äº¤ä»˜ç‰©ï¼š**

- âœ… 10+ä¸“ä¸šæ¨¡æ¿
- âœ… æ¨¡æ¿é¢„è§ˆåŠŸèƒ½

---

#### Phase 4: Research Pageï¼ˆ2å‘¨ï¼‰

**Week 10-11: Research Pageæ ¼å¼**

- [ ] æ‰©å±•Documentç±»å‹
- [ ] å®ç°ResearchPageRendererç»„ä»¶
- [ ] å®ç°ä¸€é”®è½¬æ¢ï¼ˆResearch Page â†’ PPT/Docï¼‰

**äº¤ä»˜ç‰©ï¼š**

- âœ… Research PageåŠŸèƒ½
- âœ… å¤šæ ¼å¼è½¬æ¢

---

#### Phase 5: ä¼˜åŒ–ä¸æµ‹è¯•ï¼ˆ2å‘¨ï¼‰

**Week 12-13: æ€§èƒ½ä¼˜åŒ–ä¸Bugä¿®å¤**

- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆAgentå¹¶è¡Œã€ç¼“å­˜ï¼‰
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] ç”¨æˆ·æµ‹è¯•ä¸åé¦ˆ
- [ ] Bugä¿®å¤

**äº¤ä»˜ç‰©ï¼š**

- âœ… ç¨³å®šçš„2.0ç‰ˆæœ¬
- âœ… ç”¨æˆ·åé¦ˆæŠ¥å‘Š

---

**æ€»è®¡ï¼š13å‘¨ï¼ˆçº¦3ä¸ªæœˆï¼‰**

**é‡Œç¨‹ç¢‘ï¼š**

- **M1 (Week 4):** Multi-Agentç³»ç»Ÿä¸Šçº¿
- **M2 (Week 7):** ç¼–è¾‘å¢å¼ºå®Œæˆ
- **M3 (Week 9):** æ¨¡æ¿åº“æ‰©å±•å®Œæˆ
- **M4 (Week 11):** Research Pageä¸Šçº¿
- **M5 (Week 13):** 2.0æ­£å¼å‘å¸ƒ

---

### 10.4 ä¸éœ€è¦æ”¹åŠ¨çš„éƒ¨åˆ†ï¼ˆä¿ç•™ç°æœ‰å®ç°ï¼‰

ä¸ºäº†é™ä½é£é™©å’Œå·¥ä½œé‡ï¼Œä»¥ä¸‹éƒ¨åˆ†**ä¿æŒç°æœ‰å®ç°ä¸å˜**ï¼š

1. âœ… **ä¸‰æ å¸ƒå±€**ï¼ˆWorkspaceLayout.tsxï¼‰- åŠŸèƒ½å®Œå–„ï¼Œæ— éœ€æ”¹åŠ¨
2. âœ… **èµ„æºæ·»åŠ æµç¨‹**ï¼ˆä»Exploreé¡µé¢ï¼‰- ç”¨æˆ·ä¹ æƒ¯å·²å½¢æˆ
3. âœ… **ChatPanelæ ¸å¿ƒé€»è¾‘**ï¼ˆæ„å›¾è¯†åˆ«ã€@å¼•ç”¨ã€æµå¼å¤„ç†ï¼‰- ç¨³å®šå¯é 
4. âœ… **DocumentEditor**ï¼ˆè‡ªåŠ¨ä¿å­˜ã€å®æ—¶é¢„è§ˆï¼‰- åŠŸèƒ½å®Œæ•´
5. âœ… **ç‰ˆæœ¬ç®¡ç†åŸºç¡€**ï¼ˆè‡ªåŠ¨å¿«ç…§ã€æ¢å¤ï¼‰- å·²æ»¡è¶³éœ€æ±‚
6. âœ… **ä»»åŠ¡ç³»ç»Ÿ**ï¼ˆä¸Šä¸‹æ–‡ä¿å­˜ã€æ¢å¤ï¼‰- ç‹¬ç‰¹ä¼˜åŠ¿
7. âœ… **å¯è§†åŒ–ç³»ç»Ÿ**ï¼ˆ6ç§ç±»å‹ï¼‰- å·²ç»å¼ºå¤§
8. âœ… **å¯¼å‡ºåŠŸèƒ½**ï¼ˆPPTX/DOCX/PDF/Markdownï¼‰- åŠŸèƒ½å®Œå¤‡
9. âœ… **çŠ¶æ€ç®¡ç†**ï¼ˆZustand Storeï¼‰- æ¶æ„æ¸…æ™°
10. âœ… **æŒä¹…åŒ–æœºåˆ¶**ï¼ˆLocalStorageï¼‰- æ»¡è¶³å½“å‰éœ€æ±‚

---

### 10.5 å…³é”®æˆåŠŸå› ç´ 

**1. æ¸è¿›å¼å¢å¼º**

- æ¯ä¸ªæ–°åŠŸèƒ½éƒ½åŸºäºç°æœ‰å®ç°
- ä¸ç ´åç”¨æˆ·å·²ä¹ æƒ¯çš„å·¥ä½œæµ
- å¯ä»¥é€æ­¥ä¸Šçº¿ï¼Œé™ä½é£é™©

**2. ä¿æŒç®€æ´**

- ä¸è¿‡åº¦å·¥ç¨‹åŒ–
- åªæ·»åŠ çœŸæ­£æœ‰ä»·å€¼çš„åŠŸèƒ½
- ä¿æŒç°æœ‰çš„ä¼˜ç§€ç”¨æˆ·ä½“éªŒ

**3. å……åˆ†æµ‹è¯•**

- æ¯ä¸ªPhaseç»“æŸéƒ½è¿›è¡Œç”¨æˆ·æµ‹è¯•
- æ”¶é›†åé¦ˆï¼Œå¿«é€Ÿè¿­ä»£
- ç¡®ä¿æ–°åŠŸèƒ½ä¸å½±å“ç°æœ‰åŠŸèƒ½

**4. æ–‡æ¡£å®Œå–„**

- æ›´æ–°ç”¨æˆ·æ–‡æ¡£
- æä¾›æ–°åŠŸèƒ½æ•™ç¨‹
- è®°å½•æŠ€æœ¯å†³ç­–

---

## 11. é™„å½•

### 10.1 æŠ€æœ¯æ ˆæ€»ç»“

**Frontend:**

- Next.js 14
- React 18
- TypeScript
- Zustand (çŠ¶æ€ç®¡ç†)
- TailwindCSS
- Recharts (å›¾è¡¨)
- React Flow (æµç¨‹å›¾)
- Monaco Editor (ä»£ç ç¼–è¾‘)

**Backend:**

- NestJS
- TypeScript
- PostgreSQL (Prisma ORM)
- MongoDB (Mongoose)
- Redis (ç¼“å­˜)

**AI/ML:**

- Grok API (xAI)
- ChatGPT API (OpenAI)
- æ‰©å±•æ¥å£æ”¯æŒï¼šClaude API, Gemini API

**å¯¼å‡ºåº“:**

- pptxgenjs (PPTX)
- docx (DOCX)
- puppeteer (PDF)
- marked (Markdown â†’ HTML)

**DevOps:**

- Docker
- GitHub Actions
- Vercel (Frontendéƒ¨ç½²)
- AWS/DigitalOcean (Backendéƒ¨ç½²)

### 10.2 APIé™åˆ¶ä¸æˆæœ¬ä¼°ç®—

**AI APIæˆæœ¬:**

| æ“ä½œ     | ä½¿ç”¨æ¨¡å‹  | å¹³å‡Token | æˆæœ¬/æ¬¡   | æœˆæˆæœ¬(1000 docs) |
| -------- | --------- | --------- | --------- | ----------------- |
| èµ„æºåˆ†æ | Grok      | 4000      | $0.02     | $20               |
| å†…å®¹ç”Ÿæˆ | ChatGPT-4 | 6000      | $0.12     | $120              |
| å¯è§†åŒ–   | ChatGPT-4 | 2000      | $0.04     | $40               |
| éªŒè¯     | Grok      | 2000      | $0.01     | $10               |
| **æ€»è®¡** | -         | -         | **$0.19** | **$190**          |

**ä¼˜åŒ–ç­–ç•¥:**

- ç¼“å­˜Agentç»“æœï¼ˆå‡å°‘50%é‡å¤è°ƒç”¨ï¼‰
- ä½¿ç”¨æ›´ä¾¿å®œçš„æ¨¡å‹å¤„ç†ç®€å•ä»»åŠ¡
- æ‰¹é‡å¤„ç†ï¼ˆå‡å°‘APIè°ƒç”¨æ¬¡æ•°ï¼‰

**é¢„ä¼°æœˆæˆæœ¬ï¼ˆ1000ä¸ªæ´»è·ƒç”¨æˆ·ï¼‰:**

- AI API: $200
- æœåŠ¡å™¨: $100
- æ•°æ®åº“: $50
- å­˜å‚¨: $30
- **æ€»è®¡: $380/æœˆ**

### 10.3 é£é™©ä¸ç¼“è§£æªæ–½

| é£é™©           | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½                                                |
| -------------- | ---- | ---- | ------------------------------------------------------- |
| AI APIä¸ç¨³å®š   | é«˜   | ä¸­   | â€¢ å®ç°é‡è¯•æœºåˆ¶<br>â€¢ å¤šæ¨¡å‹å¤‡ä»½<br>â€¢ é™çº§ç­–ç•¥            |
| ç”Ÿæˆè´¨é‡ä¸ç¨³å®š | é«˜   | ä¸­   | â€¢ Multi-Agentäº¤å‰éªŒè¯<br>â€¢ ç”¨æˆ·åé¦ˆå¾ªç¯<br>â€¢ Promptä¼˜åŒ– |
| æ€§èƒ½é—®é¢˜       | ä¸­   | ä¸­   | â€¢ ç¼“å­˜ç­–ç•¥<br>â€¢ å¼‚æ­¥å¤„ç†<br>â€¢ CDNåŠ é€Ÿ                   |
| æˆæœ¬è¿‡é«˜       | ä¸­   | ä½   | â€¢ æ™ºèƒ½ç¼“å­˜<br>â€¢ æ¨¡å‹é€‰æ‹©ä¼˜åŒ–<br>â€¢ ç”¨é‡ç›‘æ§              |
| ç”¨æˆ·æ•°æ®å®‰å…¨   | é«˜   | ä½   | â€¢ ç«¯åˆ°ç«¯åŠ å¯†<br>â€¢ æƒé™æ§åˆ¶<br>â€¢ å®šæœŸå®¡è®¡                |

---

## ç»“è¯­

AI Office 2.0 æ—¨åœ¨æˆä¸ºç§‘ç ”å’ŒæŠ€æœ¯äººå‘˜ä¸å¯æˆ–ç¼ºçš„æ™ºèƒ½ç ”ç©¶åŠ©æ‰‹ã€‚é€šè¿‡ Multi-Agent æ¶æ„ï¼ˆGrok + ChatGPTï¼‰ã€æ™ºèƒ½èµ„æºæ¨èã€æŒç»­è¿­ä»£ç¼–è¾‘ã€ä¸“ä¸šæ¨¡æ¿ç³»ç»Ÿå’Œå¤šæ ¼å¼å¯¼å‡ºï¼Œæˆ‘ä»¬ä¸ºç”¨æˆ·æä¾›ä»æ–‡çŒ®åˆ°æ¼”è®²çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆã€‚

**æ ¸å¿ƒå·®å¼‚åŒ–:**

1. âœ… èšç„¦ç§‘ç ”/æŠ€æœ¯é¢†åŸŸï¼ˆå‚ç›´æ·±è€•ï¼‰
2. âœ… Multi-Agentç³»ç»Ÿï¼ˆè´¨é‡ä¸é€Ÿåº¦å…¼é¡¾ï¼‰
3. âœ… æŒç»­è¿­ä»£ï¼ˆæ”¯æŒé•¿æœŸæ¼”åŒ–ï¼‰
4. âœ… ç‰ˆæœ¬ç®¡ç†ï¼ˆGit-likeä½“éªŒï¼‰
5. âœ… ä¸“ä¸šæ¨¡æ¿ï¼ˆå­¦æœ¯/æŠ€æœ¯è§„èŒƒï¼‰
6. âœ… ç”¨æˆ·æ§åˆ¶ï¼ˆæ¨èä¸å¼ºåˆ¶ï¼Œé€æ˜å¯éªŒè¯ï¼‰

æˆ‘ä»¬ç›¸ä¿¡è¿™å°†å¸®åŠ©ç ”ç©¶äººå‘˜å’Œå·¥ç¨‹å¸ˆå°†æ’°å†™æŠ¥å‘Šçš„æ—¶é—´ä»æ•°å¤©ç¼©çŸ­åˆ°æ•°å°æ—¶ï¼Œè®©ä»–ä»¬æœ‰æ›´å¤šæ—¶é—´ä¸“æ³¨äºçœŸæ­£çš„ç ”ç©¶å’Œåˆ›æ–°ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬:** 2.0
**æœ€åæ›´æ–°:** 2025-11-17
**ä¸‹ä¸€æ­¥:** å¼€å§‹Phase 1å®æ–½ âœ¨
