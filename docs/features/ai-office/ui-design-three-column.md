# AI Office UI设计方案 - 三栏布局

**版本**: v3.0 (最终版)
**日期**: 2025-11-15
**设计理念**: 左中右三栏布局，资源 + AI交互 + 文档输出

---

## 一、整体布局架构

### 1.1 三栏布局设计

```
┌────────────────────────────────────────────────────────────────────────┐
│  AI Office - YouTube视频分析报告                    ●已保存 [导出▼]   │
├────────┬───────────────────────┬───────────────────────────────────────┤
│        │                       │                                       │
│        │  📚 已选资源 (3)     │  [Heading 1▼] [PingFang▼] B I U      │
│        │  ┌─────────────────┐ │  ─────────────────────────────────── │
│        │  │ 📹 YouTube      │ │                                       │
│  全局  │  │ AI技术深度解析  │ │           文档标题                    │
│  导航  │  │ 45:23 · 12.5万  │ │                                       │
│  菜单  │  │ [详情] [移除]   │ │  ═══════════════════════════════════ │
│        │  ├─────────────────┤ │                                       │
│        │  │ 📄 Paper        │ │   第一章 核心内容                     │
│        │  │ Transformer论文 │ │                                       │
│        │  │ 95K引用         │ │   本章节主要探讨...                   │
│        │  │ [详情] [移除]   │ │                                       │
│        │  ├─────────────────┤ │   • 要点一                            │
│        │  │ 🌐 Web          │ │   • 要点二                            │
│        │  │ AI行业报告2024  │ │   • 要点三                            │
│        │  │ [详情] [移除]   │ │                                       │
│        │  └─────────────────┘ │   [AI生成的段落内容...]              │
│        │  [+ 添加资源]  [▲折叠]│                                       │
│        │  ─────────────────── │                                       │
│        │                       │                                       │
│        │  💬 AI 智能助手       │                                       │
│        │  ─────────────────── │                                       │
│        │                       │                                       │
│        │  [对话历史]           │                                       │
│        │  你: 请基于这些资源生│                                       │
│        │      成分析报告       │                                       │
│        │                       │                                       │
│        │  AI: 好的!我已经分析│                                       │
│        │      了3个数据源,开始│                                       │
│        │      生成报告... ✓   │                                       │
│        │                       │                                       │
│        │  你: 第一章太简略,请│                                       │
│        │      补充更多细节     │                                       │
│        │                       │                                       │
│        │  AI: 正在扩写第一章..│                                       │
│        │      🔄               │                                       │
│        │  ─────────────────── │                                       │
│        │                       │                                       │
│        │  [输入消息框]         │                                       │
│        │  ┌───────────────┐   │                                       │
│        │  │请优化当前章节  │   │                                       │
│        │  └───────────────┘   │                                       │
│        │  [📎附件] [🎨样式]   │                                       │
│        │         [发送 →]     │                                       │
│        │                       │                                       │
└────────┴───────────────────────┴───────────────────────────────────────┘
│        │                       │                                       │
│ 宽度:  │       中间栏          │            右侧栏                     │
│ 200-   │   350-450px           │          自适应(剩余空间)             │
│ 250px  │   (可调节)            │          (最小800px)                  │
└────────┴───────────────────────┴───────────────────────────────────────┘
```

### 1.2 布局特点

**左栏 - 全局导航菜单 (200-250px)**:

- 固定宽度
- 全局功能导航
- 始终可见

**中栏 - 资源+AI交互 (350-450px)**:

- 上半部: 资源列表(可折叠)
- 下半部: AI交互面板
- 可调节宽度

**右栏 - 文档输出 (自适应)**:

- 占据剩余空间
- 最小宽度800px
- 文档实时编辑和预览

---

## 二、左侧全局导航菜单

### 2.1 菜单结构

```
┌────────────────┐
│  AI Office     │
├────────────────┤
│                │
│ 🏠 工作台      │
│                │
│ 📊 数据源      │
│   > YouTube    │
│   > Papers     │
│   > Web        │
│   > Database   │
│   > Files      │
│                │
│ 📝 AI 文档     │
│   > 我的文档   │
│   > 草稿箱     │
│   > 新建       │
│                │
│ 📊 AI 表格     │
│   > 我的表格   │
│   > 草稿箱     │
│   > 新建       │
│                │
│ 🎭 AI 演示     │
│   > 我的PPT    │
│   > 草稿箱     │
│   > 新建       │
│                │
│ 📄 模板中心    │
│   > Word模板   │
│   > Excel模板  │
│   > PPT模板    │
│   > 我的模板   │
│                │
│ 🤖 AI 模型     │
│   > 模型管理   │
│   > 使用统计   │
│                │
│ 📚 历史记录    │
│                │
│ ⚙️ 设置        │
│                │
├────────────────┤
│ 👤 用户名      │
│    [退出]      │
└────────────────┘
```

### 2.2 菜单交互

**当前激活状态**:

```
┌────────────────┐
│ 📝 AI 文档 ◀━━ │  (高亮显示)
│   > 我的文档   │
│   > 草稿箱     │
│   > 新建       │
└────────────────┘
```

**鼠标悬停**:

```
┌────────────────┐
│ 📊 AI 表格     │  (显示快捷操作)
│   [快速新建]   │
└────────────────┘
```

---

## 三、中间栏详细设计

### 3.1 整体结构

```
┌─────────────────────────┐
│ 中间栏 (可调节宽度)     │
├─────────────────────────┤
│                         │
│ ┌─────────────────────┐ │
│ │  📚 已选资源        │ │
│ │  (可折叠区域)       │ │
│ │                     │ │
│ │  [资源卡片列表]     │ │
│ │                     │ │
│ └─────────────────────┘ │
│         ↕                │
│  [▲ 折叠] [▼ 展开]      │
│         ↕                │
│ ┌─────────────────────┐ │
│ │  💬 AI 智能助手     │ │
│ │  (固定显示)         │ │
│ │                     │ │
│ │  [对话历史]         │ │
│ │  [输入框]           │ │
│ │  [快捷操作]         │ │
│ │                     │ │
│ └─────────────────────┘ │
│                         │
└─────────────────────────┘
```

### 3.2 资源列表区域 (上半部，可折叠)

#### 3.2.1 展开状态

```
┌─────────────────────────────────┐
│ 📚 已选资源 (3)     [▲ 折叠]   │
├─────────────────────────────────┤
│                                 │
│ ┌─────────────────────────────┐│
│ │ 📹 YouTube 视频              ││
│ │ ─────────────────────────── ││
│ │ 标题: AI技术深度解析         ││
│ │ 频道: TechChannel            ││
│ │ 时长: 45:23 | 观看: 12.5万   ││
│ │                              ││
│ │ 📊 已提取:                   ││
│ │ ✓ 字幕 (中/英)               ││
│ │ ✓ 关键帧 (23个)              ││
│ │ ✓ AI摘要                     ││
│ │                              ││
│ │ [📄 查看详情] [🗑 移除]      ││
│ └─────────────────────────────┘│
│                                 │
│ ┌─────────────────────────────┐│
│ │ 📄 学术论文                  ││
│ │ ─────────────────────────── ││
│ │ 标题: Attention Is All You...││
│ │ 作者: Vaswani et al.         ││
│ │ 引用: 95,000+                ││
│ │                              ││
│ │ 📊 已提取:                   ││
│ │ ✓ 全文PDF                    ││
│ │ ✓ 摘要和关键点               ││
│ │ ✓ AI分析                     ││
│ │                              ││
│ │ [📄 查看详情] [🗑 移除]      ││
│ └─────────────────────────────┘│
│                                 │
│ ┌─────────────────────────────┐│
│ │ 🌐 网页内容                  ││
│ │ ─────────────────────────── ││
│ │ 标题: AI行业报告2024         ││
│ │ 来源: industry.ai.com        ││
│ │ 采集: 2天前                  ││
│ │                              ││
│ │ 📊 已提取:                   ││
│ │ ✓ 正文内容                   ││
│ │ ✓ 图表数据                   ││
│ │ ✓ AI提炼                     ││
│ │                              ││
│ │ [📄 查看详情] [🗑 移除]      ││
│ └─────────────────────────────┘│
│                                 │
│ [+ 添加新资源]                  │
│                                 │
└─────────────────────────────────┘
```

#### 3.2.2 折叠状态

```
┌─────────────────────────────────┐
│ 📚 已选资源 (3)     [▼ 展开]   │
├─────────────────────────────────┤
│ 📹 AI技术深度解析  [详情] [✕]  │
│ 📄 Attention Is... [详情] [✕]  │
│ 🌐 AI行业报告2024  [详情] [✕]  │
│ [+ 添加]                        │
└─────────────────────────────────┘
```

#### 3.2.3 资源快捷预览

点击 [查看详情] 后，在右侧弹出预览面板:

```
┌─────────────────────────────────────────┐
│ YouTube视频详情              [✕ 关闭]  │
├─────────────────────────────────────────┤
│                                         │
│ [视频缩略图]                            │
│                                         │
│ 标题: AI技术深度解析                    │
│ 频道: TechChannel (50万订阅)            │
│ 发布: 2天前 | 时长: 45:23               │
│ 观看: 125,000 | 点赞: 5,600             │
│                                         │
│ 描述:                                   │
│ 本视频深入探讨了当前AI技术的核心概念... │
│                                         │
│ AI摘要:                                 │
│ • 介绍了机器学习的基本原理              │
│ • 详解深度学习网络结构                  │
│ • 分析实际应用案例                      │
│ • 预测未来发展趋势                      │
│                                         │
│ 字幕预览:                               │
│ [00:00] 大家好，今天我们来聊聊AI技术... │
│ [00:15] 首先，让我们了解一下基础概念... │
│ [00:30] 机器学习的核心是...             │
│ [查看完整字幕]                          │
│                                         │
│ [🔗 打开原链接] [🔄 重新采集]          │
│                                         │
└─────────────────────────────────────────┘
```

### 3.3 AI交互面板 (下半部，固定显示)

```
┌─────────────────────────────────────────┐
│ 💬 AI 智能助手                          │
├─────────────────────────────────────────┤
│                                         │
│ 当前任务:                               │
│ ┌─────────────────────────────────────┐ │
│ │ 📝 生成Word文档                     │ │
│ │ 进度: ████████░░ 75%                │ │
│ │                                     │ │
│ │ ✓ 标题和封面                        │ │
│ │ ✓ 目录                              │ │
│ │ ✓ 第一章                            │ │
│ │ 🔄 第二章 (正在生成...)             │ │
│ │ ⏳ 第三章                            │ │
│ │                                     │ │
│ │ 预计完成: 2分钟                     │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 对话历史: [全部] [今天] [最近]         │
│ ┌─────────────────────────────────────┐ │
│ │                                     │ │
│ │ 你: 请基于这3个资源生成一份分析报告│ │
│ │     [3分钟前]                       │ │
│ │                                     │ │
│ │ AI: 好的!我已经分析了您选择的资源: │ │
│ │     • YouTube视频: AI技术深度解析  │ │
│ │     • 论文: Attention机制          │ │
│ │     • 网页: 行业报告               │ │
│ │     现在开始生成报告...  [2分钟前] │ │
│ │                                     │ │
│ │ 你: 第一章内容太简略，请补充更多   │ │
│ │     技术细节和数据支撑  [1分钟前]  │ │
│ │                                     │ │
│ │ AI: 明白!我会在第一章中添加:       │ │
│ │     • 详细的技术原理说明            │ │
│ │     • 相关数据和统计图表            │ │
│ │     • 实际案例分析                  │ │
│ │     正在优化中...  [正在输入...]   │ │
│ │                                     │ │
│ │ [滚动查看更多]                      │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 快捷指令:                               │
│ ┌────┬────┬────┬────┬────┐           │
│ │扩写││缩写││改写││总结││翻译│           │
│ └────┴────┴────┴────┴────┘           │
│ ┌────┬────┬────┬────┬────┐           │
│ │图表││数据││引用││格式││检查│           │
│ └────┴────┴────┴────┴────┘           │
│                                         │
│ 输入消息:                               │
│ ┌─────────────────────────────────────┐ │
│ │ 请在第二章中补充更多案例...         │ │
│ │                                     │ │
│ │                                     │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ [📎 附件] [🎨 样式] [@提及资源]         │
│                                         │
│                  [发送 →]               │
│                                         │
└─────────────────────────────────────────┘
```

#### 3.3.1 @提及资源功能

在输入框中输入 `@` 可以快速引用资源:

```
┌─────────────────────────────────┐
│ 输入: 请根据 @                  │
│                                 │
│ 📚 可引用资源:                  │
│ ┌─────────────────────────────┐ │
│ │ @ YouTube - AI技术深度解析  │ │
│ │ @ Paper - Attention论文     │ │
│ │ @ Web - AI行业报告          │ │
│ └─────────────────────────────┘ │
└─────────────────────────────────┘

输入: 请根据 @YouTube 的内容补充第二章
```

#### 3.3.2 AI状态指示

```
AI状态图标:
💭 思考中...      (AI正在分析)
⌨️ 输入中...      (AI正在生成文本)
🔍 搜索中...      (AI正在查找资料)
📊 分析中...      (AI正在处理数据)
✓ 完成           (任务完成)
⚠️ 需要确认      (等待用户确认)
❌ 出错           (发生错误)
```

---

## 四、右侧文档输出区域

### 4.1 AI Word 文档编辑器

```
┌────────────────────────────────────────────────────────────────┐
│  文档工具栏                                                     │
│  [Heading 1▼] [PingFang SC▼] [14▼]  B I U S  ≡ ≣ ≣           │
│  [缩进] [列表] [图片] [表格] [图表] [链接]  [👁预览] [💾保存]  │
├────────────────────────────────────────────────────────────────┤
│                                                                  │
│                                                                  │
│                      北美AI产业与生态                           │
│                                                                  │
│              ═══════════════════════════════                    │
│                                                                  │
│              算力基础设施新纪元: GW级数据中心                   │
│                                                                  │
│                                                                  │
│  一、GW级数据中心: 算力军备竞赛与电力资源锁定                  │
│                                                                  │
│  1.1 产业现状: 六大玩家的GW级军备竞赛                          │
│                                                                  │
│  前沿AI模型驱动算力爆发，六大巨头全面进入单体GW级时代。       │
│  xAI（Grok超算）以122天部署100K H100刷新极限记录，            │
│  Colossus2横跨成为全球首个GW级机群（Llama系列）既追求         │
│  规模，更追求单体规模效应...                                   │
│                                                                  │
│  ┌──────────────────────────────────────────────────────┐      │
│  │ 💡 AI正在生成此段落... (点击可编辑)                  │      │
│  │ ─────────────────────────────────────────────────── │      │
│  │                                                        │      │
│  │ 单体数据中心功率从100 MW跃升至1GW，实现10+倍规模     │      │
│  │ 跃迁。具体表现在以下几个维度:                         │      │
│  │                                                        │      │
│  │ **能源架构升级**: 从单一电网供电转向多源冗余体系，   │      │
│  │ 配备储能系统与现场发电设施，确保7×24小时不间断运行。 │      │
│  │                                                        │      │
│  │ **成本结构变化**: 部署成本从传统的$10K/kW攀升至      │      │
│  │ $40K-50K/kW，这主要由于高功率密度带来的散热、供电... │      │
│  │                                                        │      │
│  │ [✓ 接受] [✏ 编辑] [🔄 重新生成] [🗑 删除]            │      │
│  └──────────────────────────────────────────────────────┘      │
│                                                                  │
│  [光标位置]                                                     │
│                                                                  │
│  1.2 技术演进路径                                               │
│                                                                  │
│  ⏳ AI正在生成下一小节...                                       │
│                                                                  │
│                                                                  │
│                                                                  │
│                                                                  │
├────────────────────────────────────────────────────────────────┤
│  页码: 第 1 页 (共约 8 页)  |  字数: 2,345  |  AI成本: $0.12  │
└────────────────────────────────────────────────────────────────┘
```

#### 4.1.1 AI生成内容的视觉标识

**生成中的内容**:

```
┌──────────────────────────────┐
│ 💡 AI正在生成...             │
│ ──────────────────────────── │
│ [流式输出文本，逐字显示]     │
│ ████████░░ 75%               │
└──────────────────────────────┘
```

**刚生成的内容** (淡蓝色背景，1分钟内):

```
┌──────────────────────────────┐
│ [新生成的段落，高亮显示]     │
│ [✓ 接受] [✏ 编辑] [🔄 重新] │
└──────────────────────────────┘
```

**已接受的内容** (正常显示):

```
正常段落文本，已融入文档...
```

#### 4.1.2 实时协作标记

```
段落来源标记 (鼠标悬停显示):

━━━━━━━━━━━━━━━━━━━━━
这段内容由AI生成
来源: YouTube视频 @02:35-05:20
生成时间: 2分钟前
[查看原始内容]
━━━━━━━━━━━━━━━━━━━━━
```

### 4.2 AI Excel 表格编辑器

```
┌────────────────────────────────────────────────────────────────┐
│  工作表: [Sheet1▼] [Sheet2] [+ 新增]                           │
│  [公式] [数据] [插入] [格式] [图表]  [Σ求和] [📊图表向导]    │
├────────────────────────────────────────────────────────────────┤
│                                                                  │
│    A       B        C        D        E        F        G       │
│ ┌──────┬────────┬────────┬────────┬────────┬────────┬────────┐│
│ │      │ 公司   │ Q1营收 │ Q2营收 │ Q3营收 │ Q4营收 │ 同比增长││
│ ├──────┼────────┼────────┼────────┼────────┼────────┼────────┤│
│ │  1   │ 公司A  │ 125.3M │ 132.5M │ 145.8M │ 156.2M │ +15.2% ││
│ │  2   │ 公司B  │  98.7M │ 105.2M │ 112.3M │ 118.9M │ +12.1% ││
│ │  3   │ 公司C  │ 156.8M │ 162.4M │ 178.5M │ 189.3M │ +18.3% ││
│ │  4   │ 公司D  │  87.5M │  92.8M │  98.2M │ 105.6M │  +9.4% ││
│ │  5   │ 公司E  │ 134.2M │ 141.7M │ 155.3M │ 168.9M │ +14.6% ││
│ ├──────┼────────┼────────┼────────┼────────┼────────┼────────┤│
│ │  6   │ 总计   │ =SUM() │ =SUM() │ =SUM() │ =SUM() │ =AVG() ││
│ ├──────┴────────┴────────┴────────┴────────┴────────┴────────┤│
│ │                                                              ││
│ │ 💡 AI建议: 检测到季度数据，建议创建趋势图表  [应用]        ││
│ │                                                              ││
│ ├──────────────────────────────────────────────────────────────┤│
│ │  10                                                          ││
│ │  11  ┌──────────────────────────────────────────────────┐  ││
│ │  12  │  📊 营收趋势图 (AI自动生成)                      │  ││
│ │  13  │                                                    │  ││
│ │  14  │      ↑                                             │  ││
│ │  15  │ 200M │                                        ●    │  ││
│ │  16  │      │                                   ●         │  ││
│ │  17  │ 150M │              ●────●────●                    │  ││
│ │  18  │      │         ●                                   │  ││
│ │  19  │ 100M │    ●                                        │  ││
│ │  20  │      │                                             │  ││
│ │  21  │  50M └────────────────────────────────────────    │  ││
│ │  22  │         Q1    Q2    Q3    Q4                      │  ││
│ │  23  │                                                    │  ││
│ │  24  │      ● 公司A  ● 公司B  ● 公司C  ● 公司D  ● 公司E │  ││
│ │  25  │                                                    │  ││
│ │  26  │  [✓ 接受] [✏ 编辑] [🔄 重新生成]                 │  ││
│ │  27  └──────────────────────────────────────────────────┘  ││
│ │                                                              ││
│ ├──────────────────────────────────────────────────────────────┤│
│ │  30  💭 AI正在生成智能分析...                               ││
│ │                                                              ││
│ └──────────────────────────────────────────────────────────────┘│
│                                                                  │
├────────────────────────────────────────────────────────────────┤
│  公式栏: =AVERAGE(C2:C6)                                        │
│  Sheet1 | 行: 1-30 | 列: A-G | 已保存                          │
└────────────────────────────────────────────────────────────────┘
```

#### 4.2.1 AI智能分析面板 (右侧弹出)

```
┌─────────────────────────────────┐
│ 🔍 智能数据分析       [✕ 关闭] │
├─────────────────────────────────┤
│                                 │
│ 基于当前数据，AI发现:           │
│                                 │
│ 📈 趋势分析                     │
│ ┌─────────────────────────────┐ │
│ │ • Q4营收普遍高于Q1          │ │
│ │ • 平均季度增长率: 8.5%      │ │
│ │ • 全年呈稳定上升趋势        │ │
│ └─────────────────────────────┘ │
│                                 │
│ 🏆 表现对比                     │
│ ┌─────────────────────────────┐ │
│ │ 最佳: 公司C (+18.3%)        │ │
│ │ 平均: 13.9%                 │ │
│ │ 最低: 公司D (+9.4%)         │ │
│ └─────────────────────────────┘ │
│                                 │
│ ⚠️ 异常检测                     │
│ ┌─────────────────────────────┐ │
│ │ • 公司D增长显著低于平均     │ │
│ │   建议: 深入分析原因        │ │
│ └─────────────────────────────┘ │
│                                 │
│ 💡 AI建议                       │
│ ┌─────────────────────────────┐ │
│ │ ☑ 创建同比增长对比图表      │ │
│ │ ☑ 添加2025年预测数据        │ │
│ │ ☐ 计算市场份额占比          │ │
│ │ ☐ 生成财务分析报告          │ │
│ │                             │ │
│ │ [应用全部] [逐个应用]       │ │
│ └─────────────────────────────┘ │
│                                 │
│ [导出为Word报告]                │
│                                 │
└─────────────────────────────────┘
```

### 4.3 AI PPT 演示编辑器

```
┌────────────────────────────────────────────────────────────────┐
│  [主题: 专业蓝▼] [布局: 标题+内容▼] [16:9] [演示模式]         │
│  [文本] [图片] [形状] [图表] [动画] [切换效果]                │
├────────────────────────────────────────────────────────────────┤
│                                                                  │
│                                                                  │
│   ┌────────────────────────────────────────────────────┐       │
│   │                                                      │       │
│   │                                                      │       │
│   │                                                      │       │
│   │            GW级数据中心: 产业现状                   │       │
│   │                                                      │       │
│   │   ┌────────────────────────────────────────────┐   │       │
│   │   │  六大巨头GW级部署对比                      │   │       │
│   │   │                                              │   │       │
│   │   │  xAI (Grok)      ████████████  122天100K   │   │       │
│   │   │  Meta (Llama)    ██████████░░  规模优先    │   │       │
│   │   │  Oracle          ████████░░░░  云整合      │   │       │
│   │   │  Google (Gemini) ████████████  PaLM系列    │   │       │
│   │   │  Amazon          ██████████░░  多场地      │   │       │
│   │   │  Microsoft       ███████████░  合作伙伴    │   │       │
│   │   │                                              │   │       │
│   │   └────────────────────────────────────────────┘   │       │
│   │                                                      │       │
│   │   💡 AI建议: 添加数据标签? [✓应用] [✕]             │       │
│   │                                                      │       │
│   │   核心要点:                                          │       │
│   │   • 单体功率10倍增长 (100MW → 1GW)                  │       │
│   │   • xAI创造122天极限记录                            │       │
│   │   • 部署成本攀升至$40K-50K/kW                       │       │
│   │                                                      │       │
│   │                                                      │       │
│   └────────────────────────────────────────────────────┘       │
│                                                                  │
│   当前页: 3/12            [← 上一页] [下一页 →] [预览]        │
│                                                                  │
├────────────────────────────────────────────────────────────────┤
│  📝 演讲备注 (演讲者视图):                                      │
│  ┌────────────────────────────────────────────────────────┐    │
│  │ 重点强调xAI的122天记录，这是行业里程碑。              │    │
│  │ 提到10倍功率增长，说明产业进入新阶段。                │    │
│  │ 预计演讲时间: 2-3分钟                                  │    │
│  │                                                          │    │
│  │ 💡 AI建议: 可以补充成本数据的详细分析                  │    │
│  └────────────────────────────────────────────────────────┘    │
│                                                                  │
└────────────────────────────────────────────────────────────────┘
```

#### 4.3.1 幻灯片缩略图导航 (可选显示)

在右侧编辑器底部或侧边可以显示缩略图:

```
┌──────────────────────────────────┐
│ 幻灯片导航 [收起▲]              │
├──────────────────────────────────┤
│ [1][2][●3][4][5][6][7]...[12]   │
│                                  │
│ ● = 当前页                       │
│ 点击数字快速跳转                 │
└──────────────────────────────────┘
```

---

## 五、关键交互流程

### 5.1 完整的工作流程

```
步骤1: 选择文档类型
      ↓
   [左侧菜单] 点击 "📝 AI 文档" > "新建"
      ↓
步骤2: 添加数据源
      ↓
   [中间栏-资源区] 点击 [+ 添加资源]
      ↓
   选择数据源类型: YouTube / Papers / Web / 其他
      ↓
   输入URL或上传文件
      ↓
   AI自动采集和分析
      ↓
   数据源出现在资源列表
      ↓
步骤3: AI对话生成
      ↓
   [中间栏-AI交互] 输入: "请基于这些资源生成分析报告"
      ↓
   AI分析资源内容
      ↓
   AI提出结构建议: "我识别出3个核心主题..."
      ↓
   用户确认或调整
      ↓
   AI开始生成 (流式输出到右侧)
      ↓
步骤4: 实时预览和编辑
      ↓
   [右侧文档区] 实时显示生成的内容
      ↓
   用户可以:
   - 继续和AI对话优化
   - 直接手动编辑
   - 接受AI生成的段落
      ↓
步骤5: 持续迭代优化
      ↓
   [中间栏-AI交互] "第二章太简略，请扩写"
      ↓
   AI重新生成该章节
      ↓
   [右侧] 更新显示
      ↓
步骤6: 导出文档
      ↓
   [顶部工具栏] 点击 [导出▼]
      ↓
   选择格式: DOCX / PDF / Markdown
      ↓
   下载完成
```

### 5.2 资源折叠/展开交互

**折叠资源列表，扩大AI交互空间**:

```
展开状态 (初始):
┌─────────────────┐
│ 资源列表        │
│ (占60%高度)     │
│                 │
│ [▲ 折叠]        │
├─────────────────┤
│ AI交互          │
│ (占40%高度)     │
└─────────────────┘

点击 [▲ 折叠] ↓

折叠状态:
┌─────────────────┐
│ 资源 (3) [▼展开]│
├─────────────────┤
│                 │
│ AI交互          │
│ (占90%高度)     │
│                 │
│                 │
└─────────────────┘
```

### 5.3 资源引用交互

**在AI对话中引用特定资源**:

```
用户在AI交互框输入:

"请根据 @"

触发资源选择器 ↓

┌─────────────────────────┐
│ 📚 选择要引用的资源:    │
├─────────────────────────┤
│ @ YouTube - AI技术解析  │
│ @ Paper - Transformer   │
│ @ Web - 行业报告        │
└─────────────────────────┘

选择后 ↓

"请根据 @YouTube 的第2-5分钟内容，补充第三章"
              ↑
          高亮显示，可点击
```

### 5.4 AI生成内容的确认流程

```
AI生成新段落 ↓

┌──────────────────────────────┐
│ 💡 AI刚生成了此段落:         │
│ ────────────────────────────│
│ [生成的文本内容...]          │
│                              │
│ [✓ 接受] [✏ 编辑] [🔄 重新] │
└──────────────────────────────┘
        ↓         ↓        ↓
      接受      编辑    重新生成
        ↓         ↓        ↓
    融入文档  打开编辑器  AI重新生成
```

---

## 六、响应式设计

### 6.1 大屏幕 (> 1440px)

```
宽度分配:
- 左栏: 250px (固定)
- 中栏: 450px (可调节)
- 右栏: 剩余空间 (通常 > 1000px)

总宽度: 1700px+
```

### 6.2 标准桌面 (1024px - 1440px)

```
宽度分配:
- 左栏: 200px (固定)
- 中栏: 350px (可调节)
- 右栏: 剩余空间 (约 700-900px)

总宽度: 1250-1450px
```

### 6.3 平板横屏 (768px - 1024px)

```
折叠左侧菜单为图标栏:

┌──┬────────────┬──────────────┐
│☰ │  中间栏    │   右侧栏     │
│  │            │              │
│图│  资源+AI   │   文档编辑   │
│标│            │              │
│栏│            │              │
└──┴────────────┴──────────────┘

宽度:
- 左栏: 60px (图标)
- 中栏: 300px
- 右栏: 剩余 (约 500-700px)
```

### 6.4 移动端 (< 768px)

```
单栏布局，通过底部标签切换:

┌────────────────────────┐
│  AI Office             │
├────────────────────────┤
│                        │
│   [当前视图内容]       │
│   (资源 / AI / 文档)   │
│                        │
│                        │
├────────────────────────┤
│ [📚资源][💬AI][📄文档]│
└────────────────────────┘

底部Tab切换三个视图
```

---

## 七、中间栏宽度调节

### 7.1 拖拽调节

```
中间栏和右侧之间有调节栏:

┌──────┬─────────┬║┬──────────┐
│      │         │║│          │
│ 左栏 │  中间栏 │║│  右侧栏  │
│      │         │║│          │
└──────┴─────────┴║┴──────────┘
                  ↑
              拖拽手柄
            (鼠标变为↔)

拖拽效果:
- 向右拖: 中间栏变宽，右侧变窄
- 向左拖: 中间栏变窄，右侧变宽
- 最小宽度: 中间300px，右侧800px
- 最大宽度: 中间600px
```

### 7.2 快捷宽度预设

```
右键点击调节栏，显示快捷菜单:

┌──────────────────┐
│ 宽度预设:        │
├──────────────────┤
│ ○ 默认 (400px)   │
│ ○ 紧凑 (300px)   │
│ ○ 宽松 (500px)   │
│ ─────────────────│
│ ☑ 记住此设置     │
└──────────────────┘
```

---

## 八、特殊场景设计

### 8.1 无资源状态

```
┌─────────────────────────────────┐
│ 📚 已选资源 (0)                 │
├─────────────────────────────────┤
│                                 │
│       [空状态插图]              │
│                                 │
│     还没有添加数据源            │
│                                 │
│  点击下方按钮添加YouTube视频、  │
│  学术论文或网页内容              │
│                                 │
│   [+ 添加YouTube视频]           │
│   [+ 添加学术论文]              │
│   [+ 添加网页内容]              │
│   [+ 上传文件]                  │
│                                 │
│  或者从模板开始:                │
│  [📄 浏览模板库]                │
│                                 │
└─────────────────────────────────┘
```

### 8.2 AI处理错误

```
┌─────────────────────────────────┐
│ 💬 AI 智能助手                  │
├─────────────────────────────────┤
│                                 │
│ 你: 请生成报告                  │
│                                 │
│ AI: ❌ 生成失败                 │
│ ┌─────────────────────────────┐│
│ │ 错误信息:                   ││
│ │ API调用超时，请重试         ││
│ │                             ││
│ │ 可能原因:                   ││
│ │ • 网络连接不稳定            ││
│ │ • AI服务暂时不可用          ││
│ │                             ││
│ │ [🔄 重试] [💬 联系支持]     ││
│ └─────────────────────────────┘│
│                                 │
└─────────────────────────────────┘
```

### 8.3 资源采集中

```
┌─────────────────────────────────┐
│ 📚 已选资源 (1)                 │
├─────────────────────────────────┤
│ ┌─────────────────────────────┐│
│ │ 📹 YouTube 视频              ││
│ │ ─────────────────────────── ││
│ │ 标题: AI技术深度解析         ││
│ │                              ││
│ │ 🔄 正在采集...               ││
│ │ ████████░░ 75%               ││
│ │                              ││
│ │ 进度:                        ││
│ │ ✓ 视频元数据                 ││
│ │ ✓ 字幕下载                   ││
│ │ 🔄 AI分析中...               ││
│ │ ⏳ 关键帧提取                ││
│ │                              ││
│ │ 预计剩余: 30秒               ││
│ │ [暂停] [取消]                ││
│ └─────────────────────────────┘│
└─────────────────────────────────┘
```

---

## 九、技术实现要点

### 9.1 中间栏分栏实现

```typescript
// React组件示例
<div className="middle-panel">
  {/* 资源列表区域 - 可折叠 */}
  <Resizable
    direction="vertical"
    defaultSize={{ height: '40%' }}
    minHeight="80px"
    maxHeight="80%"
    className={collapsed ? 'collapsed' : 'expanded'}
  >
    <ResourceList resources={selectedResources} />
  </Resizable>

  {/* 分隔线 */}
  <div className="divider">
    <button onClick={toggleCollapse}>
      {collapsed ? '▼ 展开资源' : '▲ 折叠资源'}
    </button>
  </div>

  {/* AI交互区域 - 固定显示 */}
  <div className="ai-chat-panel" style={{ flex: 1 }}>
    <ChatHistory messages={messages} />
    <ChatInput onSend={handleSend} />
  </div>
</div>
```

### 9.2 资源引用系统

```typescript
// @提及功能实现
function useResourceMention() {
  const [showPicker, setShowPicker] = useState(false);

  function handleInputChange(text: string) {
    // 检测 @ 符号
    if (text.includes("@")) {
      setShowPicker(true);
      // 显示资源选择器
    }
  }

  function insertResourceReference(resourceId: string) {
    // 插入资源引用标记
    const mention = {
      type: "resource",
      id: resourceId,
      display: resources[resourceId].title,
    };

    insertToEditor(mention);
  }
}
```

### 9.3 中间栏宽度持久化

```typescript
// 保存用户的宽度偏好
function saveMiddlePanelWidth(width: number) {
  localStorage.setItem("middlePanelWidth", width.toString());
}

// 恢复用户偏好
function loadMiddlePanelWidth(): number {
  const saved = localStorage.getItem("middlePanelWidth");
  return saved ? parseInt(saved) : 400; // 默认400px
}
```

---

## 十、优势总结

### 10.1 vs 传统两栏设计

| 特性         | 两栏设计           | 三栏设计(新方案) |
| ------------ | ------------------ | ---------------- |
| **导航**     | 混在其他面板中     | 独立全局菜单     |
| **资源管理** | 与AI交互混合       | 独立区域，可折叠 |
| **AI交互**   | 空间受限           | 专属空间，更宽敞 |
| **文档编辑** | 与其他功能竞争空间 | 独立区域，最大化 |
| **功能切换** | 需要重新布局       | 左侧菜单快速切换 |

### 10.2 核心优势

1. **清晰的信息架构**: 导航、资源、交互、输出四个功能区域明确分离
2. **高效的空间利用**: 资源可折叠，为AI交互和文档编辑提供更多空间
3. **灵活的工作流**: 左侧菜单支持快速切换不同的文档类型和功能
4. **专注的编辑体验**: 右侧文档区域始终保持最大化，减少干扰
5. **可定制的布局**: 中间栏宽度可调节，适应不同用户习惯

---

## 十一、开发优先级

### Phase 1: 核心布局 (Week 1)

- [ ] 实现三栏基础布局
- [ ] 左侧菜单导航
- [ ] 中间栏垂直分栏(资源+AI)
- [ ] 右侧基础编辑器

### Phase 2: 资源管理 (Week 2)

- [ ] 资源列表展示
- [ ] 资源折叠/展开
- [ ] 添加资源功能
- [ ] 资源详情预览

### Phase 3: AI交互 (Week 3)

- [ ] AI对话界面
- [ ] 流式输出
- [ ] @资源引用
- [ ] 快捷指令

### Phase 4: 文档编辑 (Week 4)

- [ ] Word编辑器集成
- [ ] Excel编辑器集成
- [ ] PPT编辑器集成
- [ ] AI生成内容标记

### Phase 5: 优化完善 (Week 5-6)

- [ ] 宽度调节和持久化
- [ ] 响应式适配
- [ ] 性能优化
- [ ] 用户体验打磨

---

**总结**

这个三栏布局设计方案:

✅ **左栏**: 全局导航，清晰的功能入口
✅ **中栏**: 资源管理(可折叠) + AI交互(固定)，高效协作
✅ **右栏**: 文档输出和编辑，专注创作

相比之前的两栏设计，新方案提供了:

- 更清晰的信息架构
- 更灵活的空间分配
- 更高效的工作流程
- 更专业的用户体验

这种设计既保持了实时协作式的核心优势，又提供了传统应用的清晰导航和功能分区，是AI办公应用的理想布局方案。
