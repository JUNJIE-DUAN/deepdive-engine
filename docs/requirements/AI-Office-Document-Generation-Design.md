# AI Office 文档生成系统 - 产品设计方案

## 一、核心问题与设计目标

### 当前问题

1. **缺少文档格式选择**：用户无法明确选择要生成什么格式的文档（Word、PPT、Markdown、报告等）
2. **缺少模板系统**：没有预设模板，无法满足不同场景需求（学术报告、商业提案、技术文档等）
3. **资源利用局限**：仅基于用户选定的资源，缺少智能扩展能力（联网搜索图片、数据、报告等）

### 设计目标

参考Genspark的AI文档生成，构建一个智能、灵活、专业的文档生成系统

---

## 二、文档生成工作流设计

### 流程概览

```
选择资源 → 选择文档类型 → 选择模板 → 配置生成选项 → AI生成 → 预览编辑 → 导出
```

### 详细步骤

#### Step 1: 资源选择（已实现）

- 从资源列表勾选要使用的素材
- 支持YouTube视频、学术论文、网页等多种资源类型
- 显示资源预览和摘要

#### Step 2: 文档类型选择（新增）

提供以下文档类型：

- **研究报告** - 深度分析型文档，包含数据、图表、引用
- **学术综述** - 系统性文献综述，严谨的学术格式
- **技术文档** - 技术说明、API文档、使用手册
- **商业提案** - 商业计划、项目提案、市场分析
- **PPT演示** - 幻灯片格式，适合演讲展示
- **博客文章** - 轻松的写作风格，适合传播
- **自定义** - 用户自定义格式和结构

#### Step 3: 模板选择（新增）

每种文档类型提供多个模板：

**研究报告模板示例**：

- 标准研究报告（摘要、引言、方法、结果、讨论、结论）
- 行业分析报告（市场概况、竞争分析、趋势预测）
- 技术评估报告（技术背景、方案对比、推荐方案）

**PPT模板示例**：

- 学术演讲（标题页、目录、内容、参考文献）
- 商业路演（问题、解决方案、市场、团队、财务）
- 产品发布（产品介绍、功能亮点、演示、定价）

#### Step 4: 生成配置（新增）

允许用户精细控制生成过程：

**基础配置**：

- 文档标题
- 目标受众（专业人士、大众、学生等）
- 详细程度（简要、标准、详细）
- 语言风格（学术、商务、通俗、技术）

**高级配置**：

- ✅ **智能资源扩展**（核心创新点）
  - 自动搜索相关图片
  - 查找最新数据和统计
  - 获取权威分析报告
  - 引用相关论文和文章
- 内容长度控制
- 包含章节选择
- 引用格式（APA、MLA、IEEE等）

**资源扩展示例**：
用户选择了一个关于"AI安全"的YouTube视频：

- AI自动搜索：相关学术论文、技术白皮书
- 获取数据：AI安全事件统计、投资趋势数据
- 查找图表：AI安全架构图、威胁模型图
- 引用报告：NIST AI安全指南、行业分析报告

#### Step 5: AI生成过程

实时显示生成进度：

1. **分析资源** - AI理解选定资源的内容
2. **扩展资源** - 根据配置智能搜索补充材料
3. **构建大纲** - 生成文档结构框架
4. **生成内容** - 逐节生成文档内容
5. **优化排版** - 调整格式、插入图表
6. **质量检查** - 检查引用、数据准确性

#### Step 6: 预览与编辑

- 左侧：大纲视图，可拖拽调整章节顺序
- 中间：富文本编辑器，实时预览
- 右侧：AI助手，可针对特定章节重新生成或优化

#### Step 7: 导出选项

- Markdown格式
- Word文档（.docx）
- PDF文件
- PowerPoint（.pptx）
- HTML网页
- LaTeX（学术论文）

---

## 三、UI界面设计

### 3.1 文档生成向导界面

替换当前的简单"生成文档"按钮，改为：

```
┌─────────────────────────────────────────────────────┐
│  🎯 创建新文档                                        │
├─────────────────────────────────────────────────────┤
│                                                      │
│  基于 2 个已选资源                                    │
│  ┌────────┐ ┌────────┐                              │
│  │YouTube │ │ Paper  │                              │
│  │  视频   │ │  论文  │                              │
│  └────────┘ └────────┘                              │
│                                                      │
│  选择文档类型：                                       │
│  ┌──────────────────────────────────────────┐       │
│  │ 📊 研究报告  📄 学术综述  💼 商业提案    │       │
│  │ 📑 技术文档  🎯 PPT演示   ✍️ 博客文章    │       │
│  └──────────────────────────────────────────┘       │
│                                                      │
│  选择模板：                                          │
│  ┌──────────┬──────────┬──────────┐                │
│  │ 标准研究  │ 行业分析 │ 技术评估 │                │
│  │ 报告模板  │ 报告     │ 报告     │                │
│  └──────────┴──────────┴──────────┘                │
│                                                      │
│  生成选项：                                          │
│  □ 智能扩展资源（推荐）                              │
│    ├─ 自动搜索相关图片                               │
│    ├─ 获取最新数据统计                               │
│    ├─ 引用权威分析报告                               │
│    └─ 补充相关学术论文                               │
│                                                      │
│  详细程度： ○简要  ●标准  ○详细                     │
│  语言风格： ●学术  ○商务  ○通俗                     │
│                                                      │
│           [取消]  [开始生成文档 →]                   │
└─────────────────────────────────────────────────────┘
```

### 3.2 生成进度界面

```
┌─────────────────────────────────────────────────────┐
│  正在生成文档...                               45%    │
├─────────────────────────────────────────────────────┤
│                                                      │
│  ✅ 分析选定资源 (2个)                               │
│  ✅ 智能扩展资源                                     │
│     • 找到 15 张相关图片                             │
│     • 获取 3 份数据报告                              │
│     • 引用 8 篇相关论文                              │
│  🔄 生成文档大纲                                     │
│  ⏳ 生成内容章节 (3/8)                               │
│  ⏳ 插入图表和引用                                   │
│  ⏳ 优化格式和排版                                   │
│                                                      │
│  [████████████████░░░░░░░░░░] 45%                   │
│                                                      │
│  预计还需 2 分钟                                     │
└─────────────────────────────────────────────────────┘
```

### 3.3 文档编辑界面（三栏布局）

```
┌──────┬────────────────────────────┬──────────────┐
│      │                            │              │
│ 大纲 │    文档内容编辑区域           │  AI助手      │
│ 视图 │                            │              │
│      │  # 深度学习安全性研究        │  💡 建议     │
│ ─ 摘要│                            │              │
│ ─ 引言│  ## 1. 引言                │  • 引言过于  │
│ ─ 背景│  深度学习在近年来...        │    简短，建议│
│ ─ 方法│                            │    扩展      │
│ ─ 结果│  [AI生成的内容可编辑]       │              │
│ ─ 讨论│                            │  🔧 操作     │
│ ─ 结论│                            │  • 重新生成  │
│ ─ 参考│                            │  • 扩展内容  │
│      │                            │  • 精简内容  │
│      │                            │  • 改变语气  │
│      │                            │              │
└──────┴────────────────────────────┴──────────────┘
```

---

## 四、技术实现要点

### 4.1 智能资源扩展系统

创建新的后端服务：`ai-resource-extension-service`

**功能模块**：

1. **图片搜索模块** - 调用Google Images API / Unsplash API
2. **数据获取模块** - 从权威数据库获取统计数据
3. **文献检索模块** - 从arXiv、PubMed、Google Scholar搜索
4. **报告查找模块** - 从咨询公司、研究机构获取报告

**API设计**：

```typescript
POST /api/v1/ai-office/extend-resources
{
  "baseResources": ["resource-id-1", "resource-id-2"],
  "extensionOptions": {
    "searchImages": true,
    "fetchData": true,
    "findReports": true,
    "citePapers": true
  },
  "topic": "AI安全",
  "maxExtensionItems": 20
}

Response:
{
  "extendedResources": {
    "images": [...],
    "data": [...],
    "papers": [...],
    "reports": [...]
  },
  "relevanceScores": {...}
}
```

### 4.2 模板系统

数据库设计：

```typescript
interface DocumentTemplate {
  _id: string;
  name: string; // "标准研究报告"
  type: DocumentType; // "research_report"
  category: string; // "学术"
  structure: {
    sections: [
      {
        id: "abstract";
        title: "摘要";
        aiPrompt: "生成一个200字的研究摘要，包含背景、方法、结果、结论";
        required: true;
        order: 1;
      },
      // ... more sections
    ];
  };
  styleGuide: {
    citationFormat: "APA";
    headingStyle: "numbered";
    tone: "academic";
  };
}
```

### 4.3 文档生成Pipeline

```typescript
class DocumentGenerationPipeline {
  async generate(config: GenerationConfig): Promise<Document> {
    // 1. 分析基础资源
    const baseAnalysis = await this.analyzeResources(config.resources);

    // 2. 智能扩展资源
    const extendedResources = await this.extendResources(
      baseAnalysis,
      config.extensionOptions,
    );

    // 3. 生成大纲
    const outline = await this.generateOutline(
      config.template,
      baseAnalysis,
      extendedResources,
    );

    // 4. 逐节生成内容
    const sections = await this.generateSections(
      outline,
      baseAnalysis,
      extendedResources,
    );

    // 5. 插入图表和引用
    const enriched = await this.enrichWithMedia(sections, extendedResources);

    // 6. 格式化和优化
    return await this.formatAndOptimize(enriched, config.template);
  }
}
```

---

## 五、实施计划

### Phase 1: 基础设施（1-2周）

- [ ] 创建文档类型和模板数据模型
- [ ] 实现模板管理系统
- [ ] 构建文档生成向导UI

### Phase 2: 智能扩展（2-3周）

- [ ] 实现图片搜索模块
- [ ] 实现数据获取模块
- [ ] 实现文献检索模块
- [ ] 集成资源扩展到生成pipeline

### Phase 3: 核心生成（2-3周）

- [ ] 优化AI生成提示工程
- [ ] 实现流式生成和进度显示
- [ ] 添加图表和引用插入逻辑

### Phase 4: 编辑与导出（1-2周）

- [ ] 实现大纲编辑功能
- [ ] 构建富文本编辑器
- [ ] 支持多格式导出

### Phase 5: 优化与测试（1周）

- [ ] 性能优化
- [ ] 用户测试和反馈
- [ ] Bug修复

**总计：7-11周**

---

## 六、参考案例分析

### Genspark的优势

1. **清晰的工作流** - 步骤明确，用户不会迷失
2. **智能内容扩展** - 不局限于用户提供的资源
3. **专业的输出质量** - 生成的文档格式规范、内容充实
4. **实时预览** - 用户可以看到生成过程

### 我们的差异化

1. **多资源整合** - 深度整合YouTube、Papers、Web等多源数据
2. **中文优化** - 针对中文内容和格式进行优化
3. **学术导向** - 特别强化学术文献的引用和分析
4. **本地部署** - 可以完全私有化部署，保护数据隐私

---

## 七、核心指标

### 质量指标

- 文档生成成功率 > 95%
- 用户满意度 > 4.0/5.0
- 内容准确性评分 > 4.2/5.0

### 性能指标

- 平均生成时间 < 3分钟
- 资源扩展响应时间 < 30秒
- 并发处理能力 > 10个任务

### 业务指标

- 用户留存率 > 60%
- 功能使用率 > 40%
- 文档导出率 > 70%
